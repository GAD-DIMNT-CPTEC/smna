%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_lw/rrtmg_lw_taumol.f90
Compiled : 12/12/20  00:52:49
Compiler : Version 8.0.6
Target   : x86-64
Command  : /opt/cray/cce/8.0.6/cftn/x86-64/bin/ftn_driver.exe -hcpu=mc12
           -hnetwork=gemini -hstatic -ra -hbyteswapio
           -Onomodinline,vector0,ipa0,fusion0,unroll0,fp0 -homp -sdefault32
           -hdisplay_opt -c -I/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/include
           -I/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/include
           -I/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/include
           -I/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/include
           -I/opt/cray/gni-headers/2.1-1.0400.4351.3.1.gem/include
           -I/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/include
           -I/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/include
           -I/opt/cray-hss-devel/6.0.0/include
           -I/opt/cray/krca/1.0.0-2.0400.31554.3.55.gem/include
           -I/opt/cray/cce/8.0.6/craylibs/x86-64/include
           -I/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/include
           -L/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/lib64
           -L/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/lib64
           -L/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/lib64
           -L/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/lib64
           -L/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/lib64
           -L/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/lib64 -lrca
           -L/opt/cray/cce/8.0.6/craylibs/x86-64 -L/opt/gcc/4.4.4/snos/lib64
           -D__CRAYXE -D__CRAYXT_COMPUTE_LINUX_TARGET -D__TARGET_LINUX__
           -I/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/include
           -I/opt/xt-libsci/11.1.01/cray/74/mc12/include
           -I/opt/cray/hdf5/1.8.8/cray/74/include
           -I/opt/cray/netcdf/4.2.0/cray/74/include
           -L/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/lib
           -L/opt/xt-libsci/11.1.01/cray/74/mc12/lib
           -L/opt/cray/hdf5/1.8.8/cray/74/lib
           -L/opt/cray/netcdf/4.2.0/cray/74/lib -lnetcdff_cray -lnetcdf_cray
           -lhdf5hl_fortran_cray -lhdf5_hl_cray -lhdf5_fortran_cray -lhdf5_cray
           -lz -lscicpp_cray -lsci_cray_mp -lmpichf90_cray -lmpich_cray -lmpl
           -lxpmem -ldmapp -lpmi -lugni -lalpslli -lalpsutil -ludreg
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib/alps
           -L/usr/lib/alps rrtmg_lw_taumol.f90

ftnlx report
------------
Source   : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_lw/rrtmg_lw_taumol.f90
Date     : 12/12/2020  00:52:51


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          O p t i o n s   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Options :  -O cache2,fp0,scalar2,thread2,vector0,mpi0,nomodinline,ipa0,noaggress
           -O autoprefetch,noautothread,fusion0,nomsgs,negmsgs,nooverindex
           -O nopattern,shortcircuit2,unroll0,nozeroinc
           -h noadd_paren,align_arrays,nocaf,dwarf,fp_trap,nofunc_trace,nomessag
           e
           -h noomp_analyze,noomp_trace,nopat_trace
           -h omp,noomp_acc,noacc
           -h flex_mp=default
           -h cpu=x86-64,mc12,gemini
           -s default32
           -eh
           -d acdgjmnopvwBDEFILPQRSTZ0
           -e qsAC 
           -f free
           -m3
           -S /tmp/pe_6207/rrtmg_lw_taumol_1.s


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


     %%%    L o o p m a r k   L e g e n d    %%%

     Primary Loop Type        Modifiers
     ------- ---- ----        ---------
     A - Pattern matched      a - atomic memory operation
                              b - blocked
     C - Collapsed            c - conditional and/or computed
     D - Deleted               
     E - Cloned               f - fused
     G - Accelerated          g - partitioned
     I - Inlined              i - interchanged
     M - Multithreaded        m - partitioned
                              n - non-blocking remote transfer
                              p - partial
                              r - unrolled
                              s - shortloop
     V - Vectorized           w - unwound


    1.         !     path:      $Source: /storm/rc1/cvsroot/rc/rrtmg_lw/src/rrtmg_lw_taumol.f90,v $
    2.         !     author:    $Author: mike $
    3.         !     revision:  $Revision: 1.7 $
    4.         !     created:   $Date: 2009/10/20 15:08:37 $
    5.         !
    6.               module rrtmg_lw_taumol
    7.         
    8.         !  --------------------------------------------------------------------------
    9.         ! |                                                                          |
   10.         ! |  Copyright 2002-2009, Atmospheric & Environmental Research, Inc. (AER).  |
   11.         ! |  This software may be used, copied, or redistributed as long as it is    |
   12.         ! |  not sold and this copyright notice is reproduced on each copy made.     |
   13.         ! |  This model is provided as is without any express or implied warranties. |
   14.         ! |                       (http://www.rtweb.aer.com/)                        |
   15.         ! |                                                                          |
   16.         !  --------------------------------------------------------------------------
   17.         
   18.         ! ------- Modules -------
   19.         
   20.               use shr_kind_mod, only: r8 => shr_kind_r8
   21.         !      use parkind, only : im => kind_im, rb => kind_r8
   22.               use parrrtm, only : mg, nbndlw, maxxsec, ngptlw
   23.               use rrlw_con, only: oneminus
   24.               use rrlw_wvn, only: nspa, nspb
   25.               use rrlw_vsn, only: hvrtau, hnamtau
   26.         
   27.               implicit none
   28.         
   29.               contains
   30.         
   31.         !----------------------------------------------------------------------------
   32.               subroutine taumol( &             !     call taumol( &
   33.                                 nlayers     , &!                nlayers                              , &
   34.                                 pavel       , &!                pavel        (1:nlayers)             , &
   35.                                 wx          , &!                wx           (1:maxxsec,1:nlayers)   , &
   36.                                 coldry      , &!                coldry       (1:nlayers)             , &
   37.                                 laytrop     , &!                laytrop                              , &
   38.                                 jp          , &!                jp           (1:nlayers)             , &
   39.                                 jt          , &!                jt           (1:nlayers)             , &
   40.                                 jt1         , &!                jt1          (1:nlayers)             , &
   41.                                 planklay    , &!                planklay     (1:nlayers,1:nbndlw)    , &
   42.                                 planklev    , &!                planklev     (0:nlayers,1:nbndlw)    , &
   43.                                 plankbnd    , &!                plankbnd     (1:nbndlw)              , &
   44.                                 colh2o      , &!                colh2o       (1:nlayers)             , &
   45.                                 colco2      , &!                colco2       (1:nlayers)             , &
   46.                                 colo3       , &!                colo3        (1:nlayers)             , &
   47.                                 coln2o      , &!                coln2o       (1:nlayers)             , &
   48.                                 colco       , &!                colco        (1:nlayers)             , &
   49.                                 colch4      , &!                colch4       (1:nlayers)             , &
   50.                                 colo2       , &!                colo2        (1:nlayers)             , &
   51.                                 colbrd      , &!                colbrd       (1:nlayers)             , &
   52.                                 fac00       , &!                fac00        (1:nlayers)             , &
   53.                                 fac01       , &!                fac01        (1:nlayers)             , &
   54.                                 fac10       , &!                fac10        (1:nlayers)             , &
   55.                                 fac11       , &!                fac11        (1:nlayers)             , &
   56.                                 rat_h2oco2  , &!                rat_h2oco2   (1:nlayers)             , &
   57.                                 rat_h2oco2_1, &!                rat_h2oco2_1 (1:nlayers)             , &
   58.                                 rat_h2oo3   , &!                rat_h2oo3    (1:nlayers)             , &
   59.                                 rat_h2oo3_1 , &!                rat_h2oo3_1  (1:nlayers)             , &
   60.                                 rat_h2on2o  , &!                rat_h2on2o   (1:nlayers)             , &
   61.                                 rat_h2on2o_1, &!                rat_h2on2o_1 (1:nlayers)             , &
   62.                                 rat_h2och4  , &!                rat_h2och4   (1:nlayers)             , &
   63.                                 rat_h2och4_1, &!                rat_h2och4_1 (1:nlayers)             , &
   64.                                 rat_n2oco2  , &!                rat_n2oco2   (1:nlayers)             , &
   65.                                 rat_n2oco2_1, &!                rat_n2oco2_1 (1:nlayers)             , &
   66.                                 rat_o3co2   , &!                rat_o3co2    (1:nlayers)             , &
   67.                                 rat_o3co2_1 , &!                rat_o3co2_1  (1:nlayers)             , &
   68.                                 selffac     , &!                selffac      (1:nlayers)             , &
   69.                                 selffrac    , &!                selffrac     (1:nlayers)             , &
   70.                                 indself     , &!                indself      (1:nlayers)             , &
   71.                                 forfac      , &!                forfac       (1:nlayers)             , &
   72.                                 forfrac     , &!                forfrac      (1:nlayers)             , &
   73.                                 indfor      , &!                indfor       (1:nlayers)             , &
   74.                                 minorfrac   , &!                minorfrac    (1:nlayers)             , &
   75.                                 scaleminor  , &!                scaleminor   (1:nlayers)             , &
   76.                                 scaleminorn2, &!                scaleminorn2 (1:nlayers)             , &
   77.                                 indminor    , &!                indminor     (1:nlayers)             , &
   78.                                 fracs       , &!                fracs        (1:nlayers,1:ngptlw)    , &
   79.                                 taug          )!                taug         (1:nlayers,1:ngptlw)      )
   80.         !----------------------------------------------------------------------------
   81.         
   82.         ! *******************************************************************************
   83.         ! *                                                                             *
   84.         ! *                  Optical depths developed for the                           *
   85.         ! *                                                                             *
   86.         ! *                RAPID RADIATIVE TRANSFER MODEL (RRTM)                        *
   87.         ! *                                                                             *
   88.         ! *                                                                             *
   89.         ! *            ATMOSPHERIC AND ENVIRONMENTAL RESEARCH, INC.                     *
   90.         ! *                        131 HARTWELL AVENUE                                  *
   91.         ! *                        LEXINGTON, MA 02421                                  *
   92.         ! *                                                                             *
   93.         ! *                                                                             *
   94.         ! *                           ELI J. MLAWER                                     * 
   95.         ! *                         JENNIFER DELAMERE                                   * 
   96.         ! *                         STEVEN J. TAUBMAN                                   *
   97.         ! *                         SHEPARD A. CLOUGH                                   *
   98.         ! *                                                                             *
   99.         ! *                                                                             *
  100.         ! *                                                                             *
  101.         ! *                                                                             *
  102.         ! *                       email:  mlawer@aer.com                                *
  103.         ! *                       email:  jdelamer@aer.com                              *
  104.         ! *                                                                             *
  105.         ! *        The authors wish to acknowledge the contributions of the             *
  106.         ! *        following people:  Karen Cady-Pereira, Patrick D. Brown,             *  
  107.         ! *        Michael J. Iacono, Ronald E. Farren, Luke Chen, Robert Bergstrom.    *
  108.         ! *                                                                             *
  109.         ! *******************************************************************************
  110.         ! *                                                                             *
  111.         ! *  Revision for g-point reduction: Michael J. Iacono, AER, Inc.               *
  112.         ! *                                                                             *
  113.         ! *******************************************************************************
  114.         ! *     TAUMOL                                                                  *
  115.         ! *                                                                             *
  116.         ! *     This file contains the subroutines TAUGBn (where n goes from            *
  117.         ! *     1 to 16).  TAUGBn calculates the optical depths and Planck fractions    *
  118.         ! *     per g-value and layer for band n.                                       *
  119.         ! *                                                                             *
  120.         ! *  Output:  optical depths (unitless)                                         *
  121.         ! *           fractions needed to compute Planck functions at every layer       *
  122.         ! *               and g-value                                                   *
  123.         ! *                                                                             *
  124.         ! *     COMMON /TAUGCOM/  TAUG(MXLAY,MG)                                        *
  125.         ! *     COMMON /PLANKG/   FRACS(MXLAY,MG)                                       *
  126.         ! *                                                                             *
  127.         ! *  Input                                                                      *
  128.         ! *                                                                             *
  129.         ! *     COMMON /FEATURES/ NG(NBANDS),NSPA(NBANDS),NSPB(NBANDS)                  *
  130.         ! *     COMMON /PRECISE/  ONEMINUS                                              *
  131.         ! *     COMMON /PROFILE/  NLAYERS,PAVEL(MXLAY),TAVEL(MXLAY),                    *
  132.         ! *     &                 PZ(0:MXLAY),TZ(0:MXLAY)                               *
  133.         ! *     COMMON /PROFDATA/ LAYTROP,                                              *
  134.         ! *    &                  COLH2O(MXLAY),COLCO2(MXLAY),COLO3(MXLAY),             *
  135.         ! *    &                  COLN2O(MXLAY),COLCO(MXLAY),COLCH4(MXLAY),             *
  136.         ! *    &                  COLO2(MXLAY)
  137.         ! *     COMMON /INTFAC/   FAC00(MXLAY),FAC01(MXLAY),                            *
  138.         ! *    &                  FAC10(MXLAY),FAC11(MXLAY)                             *
  139.         ! *     COMMON /INTIND/   JP(MXLAY),JT(MXLAY),JT1(MXLAY)                        *
  140.         ! *     COMMON /SELF/     SELFFAC(MXLAY), SELFFRAC(MXLAY), INDSELF(MXLAY)       *
  141.         ! *                                                                             *
  142.         ! *     Description:                                                            *
  143.         ! *     NG(IBAND) - number of g-values in band IBAND                            *
  144.         ! *     NSPA(IBAND) - for the lower atmosphere, the number of reference         *
  145.         ! *                   atmospheres that are stored for band IBAND per            *
  146.         ! *                   pressure level and temperature.  Each of these            *
  147.         ! *                   atmospheres has different relative amounts of the         *
  148.         ! *                   key species for the band (i.e. different binary           *
  149.         ! *                   species parameters).                                      *
  150.         ! *     NSPB(IBAND) - same for upper atmosphere                                 *
  151.         ! *     ONEMINUS - since problems are caused in some cases by interpolation     *
  152.         ! *                parameters equal to or greater than 1, for these cases       *
  153.         ! *                these parameters are set to this value, slightly < 1.        *
  154.         ! *     PAVEL - layer pressures (mb)                                            *
  155.         ! *     TAVEL - layer temperatures (degrees K)                                  *
  156.         ! *     PZ - level pressures (mb)                                               *
  157.         ! *     TZ - level temperatures (degrees K)                                     *
  158.         ! *     LAYTROP - layer at which switch is made from one combination of         *
  159.         ! *               key species to another                                        *
  160.         ! *     COLH2O, COLCO2, COLO3, COLN2O, COLCH4 - column amounts of water         *
  161.         ! *               vapor,carbon dioxide, ozone, nitrous ozide, methane,          *
  162.         ! *               respectively (molecules/cm**2)                                *
  163.         ! *     FACij(LAY) - for layer LAY, these are factors that are needed to        *
  164.         ! *                  compute the interpolation factors that multiply the        *
  165.         ! *                  appropriate reference k-values.  A value of 0 (1) for      *
  166.         ! *                  i,j indicates that the corresponding factor multiplies     *
  167.         ! *                  reference k-value for the lower (higher) of the two        *
  168.         ! *                  appropriate temperatures, and altitudes, respectively.     *
  169.         ! *     JP - the index of the lower (in altitude) of the two appropriate        *
  170.         ! *          reference pressure levels needed for interpolation                 *
  171.         ! *     JT, JT1 - the indices of the lower of the two appropriate reference     *
  172.         ! *               temperatures needed for interpolation (for pressure           *
  173.         ! *               levels JP and JP+1, respectively)                             *
  174.         ! *     SELFFAC - scale factor needed for water vapor self-continuum, equals    *
  175.         ! *               (water vapor density)/(atmospheric density at 296K and        *
  176.         ! *               1013 mb)                                                      *
  177.         ! *     SELFFRAC - factor needed for temperature interpolation of reference     *
  178.         ! *                water vapor self-continuum data                              *
  179.         ! *     INDSELF - index of the lower of the two appropriate reference           *
  180.         ! *               temperatures needed for the self-continuum interpolation      *
  181.         ! *     FORFAC  - scale factor needed for water vapor foreign-continuum.        *
  182.         ! *     FORFRAC - factor needed for temperature interpolation of reference      *
  183.         ! *                water vapor foreign-continuum data                           *
  184.         ! *     INDFOR  - index of the lower of the two appropriate reference           *
  185.         ! *               temperatures needed for the foreign-continuum interpolation   *
  186.         ! *                                                                             *
  187.         ! *  Data input                                                                 *
  188.         ! *     COMMON /Kn/ KA(NSPA(n),5,13,MG), KB(NSPB(n),5,13:59,MG), SELFREF(10,MG),*
  189.         ! *                 FORREF(4,MG), KA_M'MGAS', KB_M'MGAS'                        *
  190.         ! *        (note:  n is the band number,'MGAS' is the species name of the minor *
  191.         ! *         gas)                                                                *
  192.         ! *                                                                             *
  193.         ! *     Description:                                                            *
  194.         ! *     KA - k-values for low reference atmospheres (key-species only)          *
  195.         ! *          (units: cm**2/molecule)                                            *
  196.         ! *     KB - k-values for high reference atmospheres (key-species only)         *
  197.         ! *          (units: cm**2/molecule)                                            *
  198.         ! *     KA_M'MGAS' - k-values for low reference atmosphere minor species        *
  199.         ! *          (units: cm**2/molecule)                                            *
  200.         ! *     KB_M'MGAS' - k-values for high reference atmosphere minor species       *
  201.         ! *          (units: cm**2/molecule)                                            *
  202.         ! *     SELFREF - k-values for water vapor self-continuum for reference         *
  203.         ! *               atmospheres (used below LAYTROP)                              *
  204.         ! *               (units: cm**2/molecule)                                       *
  205.         ! *     FORREF  - k-values for water vapor foreign-continuum for reference      *
  206.         ! *               atmospheres (used below/above LAYTROP)                        *
  207.         ! *               (units: cm**2/molecule)                                       *
  208.         ! *                                                                             *
  209.         ! *     DIMENSION ABSA(65*NSPA(n),MG), ABSB(235*NSPB(n),MG)                     *
  210.         ! *     EQUIVALENCE (KA,ABSA),(KB,ABSB)                                         *
  211.         ! *                                                                             *
  212.         !*******************************************************************************
  213.         
  214.         ! ------- Declarations -------
  215.         
  216.         ! ----- Input -----
  217.               integer, intent(in) :: nlayers         ! total number of layers
  218.               real(kind=r8), intent(in) :: pavel(1:nlayers)           ! layer pressures (mb) 
  219.                                                               !    Dimensions: (nlayers)
  220.               real(kind=r8), intent(in) :: wx(1:maxxsec,1:nlayers)            ! cross-section amounts (mol/cm2)
  221.                                                               !    Dimensions: (maxxsec,nlayers)
  222.               real(kind=r8), intent(in) :: coldry(1:nlayers)           ! column amount (dry air)
  223.                                                               !    Dimensions: (nlayers)
  224.         
  225.               integer, intent(in) :: laytrop         ! tropopause layer index
  226.               integer, intent(in) :: jp(1:nlayers)            ! 
  227.                                                               !    Dimensions: (nlayers)
  228.               integer, intent(in) :: jt(1:nlayers)            !
  229.                                                               !    Dimensions: (nlayers)
  230.               integer, intent(in) :: jt1(1:nlayers)          !
  231.                                                               !    Dimensions: (nlayers)
  232.               real(kind=r8), intent(in) :: planklay(1:nlayers,1:nbndlw)      ! 
  233.                                                               !    Dimensions: (nlayers,nbndlw)
  234.               real(kind=r8), intent(in) :: planklev(0:nlayers,1:nbndlw)     ! 
  235.                                                               !    Dimensions: (nlayers,nbndlw)
  236.               real(kind=r8), intent(in) :: plankbnd(1:nbndlw)        ! 
  237.                                                               !    Dimensions: (nbndlw)
  238.         
  239.               real(kind=r8), intent(in) :: colh2o(1:nlayers)          ! column amount (h2o)
  240.                                                               !    Dimensions: (nlayers)
  241.               real(kind=r8), intent(in) :: colco2(1:nlayers)          ! column amount (co2)
  242.                                                               !    Dimensions: (nlayers)
  243.               real(kind=r8), intent(in) :: colo3(1:nlayers)           ! column amount (o3)
  244.                                                               !    Dimensions: (nlayers)
  245.               real(kind=r8), intent(in) :: coln2o(1:nlayers)          ! column amount (n2o)
  246.                                                               !    Dimensions: (nlayers)
  247.               real(kind=r8), intent(in) :: colco(1:nlayers)           ! column amount (co)
  248.                                                               !    Dimensions: (nlayers)
  249.               real(kind=r8), intent(in) :: colch4(1:nlayers)          ! column amount (ch4)
  250.                                                               !    Dimensions: (nlayers)
  251.               real(kind=r8), intent(in) :: colo2(1:nlayers)           ! column amount (o2)
  252.                                                               !    Dimensions: (nlayers)
  253.               real(kind=r8), intent(in) :: colbrd(1:nlayers)          ! column amount (broadening gases)
  254.                                                               !    Dimensions: (nlayers)
  255.         
  256.               integer, intent(in) :: indself(1:nlayers)
  257.                                                               !    Dimensions: (nlayers)
  258.               integer, intent(in) :: indfor(1:nlayers)
  259.                                                               !    Dimensions: (nlayers)
  260.               real(kind=r8), intent(in) :: selffac(1:nlayers)
  261.                                                               !    Dimensions: (nlayers)
  262.               real(kind=r8), intent(in) :: selffrac(1:nlayers)
  263.                                                               !    Dimensions: (nlayers)
  264.               real(kind=r8), intent(in) :: forfac(1:nlayers)
  265.                                                               !    Dimensions: (nlayers)
  266.               real(kind=r8), intent(in) :: forfrac(1:nlayers)
  267.                                                               !    Dimensions: (nlayers)
  268.         
  269.               integer, intent(in) :: indminor(1:nlayers)
  270.                                                               !    Dimensions: (nlayers)
  271.               real(kind=r8), intent(in) :: minorfrac(1:nlayers)
  272.                                                               !    Dimensions: (nlayers)
  273.               real(kind=r8), intent(in) :: scaleminor(1:nlayers)
  274.                                                               !    Dimensions: (nlayers)
  275.               real(kind=r8), intent(in) :: scaleminorn2(1:nlayers)
  276.                                                               !    Dimensions: (nlayers)
  277.         
  278.               real(kind=r8), intent(in) :: &                  !
  279.                                fac00(1:nlayers), fac01(1:nlayers), &          !    Dimensions: (nlayers)
  280.                                fac10(1:nlayers), fac11(1:nlayers) 
  281.               real(kind=r8), intent(in) :: &                  !
  282.                                rat_h2oco2(1:nlayers),rat_h2oco2_1(1:nlayers), &
  283.                                rat_h2oo3(1:nlayers),rat_h2oo3_1(1:nlayers), & !    Dimensions: (nlayers)
  284.                                rat_h2on2o(1:nlayers),rat_h2on2o_1(1:nlayers), &
  285.                                rat_h2och4(1:nlayers),rat_h2och4_1(1:nlayers), &
  286.                                rat_n2oco2(1:nlayers),rat_n2oco2_1(1:nlayers), &
  287.                                rat_o3co2(1:nlayers),rat_o3co2_1(1:nlayers)
  288.         
  289.         ! ----- Output -----
  290.               real(kind=r8), intent(out) :: fracs(1:nlayers,1:ngptlw)         ! planck fractions
  291.                                                               !    Dimensions: (nlayers,ngptlw)
  292.               real(kind=r8), intent(out) :: taug(1:nlayers,1:ngptlw)         ! gaseous optical depth 
  293.                                                               !    Dimensions: (nlayers,ngptlw)
  294.         
  295.               hvrtau = '$Revision: 1.7 $'
  296.         
  297.         ! Calculate gaseous optical depth and planck fractions for each spectral band.
  298.         
  299.               call taugb1(nlayers,ngptlw,laytrop,fracs  ,taug   )
  300.               call taugb2(nlayers,ngptlw,laytrop,fracs  ,taug   )
  301.               call taugb3(nlayers,ngptlw,laytrop,fracs  ,taug   )
  302.               call taugb4(nlayers,ngptlw,laytrop,fracs  ,taug   )
  303.               call taugb5(nlayers,ngptlw,laytrop,fracs  ,taug   )
  304.               call taugb6(nlayers,ngptlw,laytrop,fracs  ,taug   )
  305.               call taugb7(nlayers,ngptlw,laytrop,fracs  ,taug   )
  306.               call taugb8(nlayers,ngptlw,laytrop,fracs  ,taug   )
  307.               call taugb9(nlayers,ngptlw,laytrop,fracs  ,taug   )
  308.               call taugb10(nlayers,ngptlw,laytrop,fracs  ,taug   )
  309.               call taugb11(nlayers,ngptlw,laytrop,fracs  ,taug   )
  310.               call taugb12(nlayers,ngptlw,laytrop,fracs  ,taug   )
  311.               call taugb13(nlayers,ngptlw,laytrop,fracs  ,taug   )
  312.               call taugb14(nlayers,ngptlw,laytrop,fracs  ,taug   )
  313.               call taugb15(nlayers,ngptlw,laytrop,fracs  ,taug   )
  314.               call taugb16(nlayers,ngptlw,laytrop,fracs  ,taug   )
  315.         
  316.               contains
  317.         
  318.         !----------------------------------------------------------------------------
  319.               subroutine taugb1(nlayers,ngptlw,laytrop,fracs  ,taug   )
  320.         !----------------------------------------------------------------------------
  321.         
  322.         ! ------- Modifications -------
  323.         !  Written by Eli J. Mlawer, Atmospheric & Environmental Research.
  324.         !  Revised by Michael J. Iacono, Atmospheric & Environmental Research.
  325.         !
  326.         !     band 1:  10-350 cm-1 (low key - h2o; low minor - n2)
  327.         !                          (high key - h2o; high minor - n2)
  328.         !
  329.         !     note: previous versions of rrtm band 1: 
  330.         !           10-250 cm-1 (low - h2o; high - h2o)
  331.         !----------------------------------------------------------------------------
  332.         
  333.         ! ------- Modules -------
  334.         
  335.               use parrrtm, only : ng1
  336.               use rrlw_kg01, only : fracrefa, fracrefb, absa, absb, &
  337.                                     ka_mn2, kb_mn2, selfref, forref
  338.         
  339.         ! ------- Declarations -------
  340.               integer      , intent(in ) :: nlayers
  341.               integer      , intent(in ) :: ngptlw
  342.               integer      , intent(in ) :: laytrop         ! tropopause layer index
  343.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
  344.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
  345.         
  346.         ! Local 
  347.               integer :: lay, ind0, ind1, inds, indf, indm, ig
  348.               real(kind=r8) :: pp, corradj, scalen2, tauself, taufor, taun2
  349.         
  350.         
  351.         ! Minor gas mapping levels:
  352.         !     lower - n2, p = 142.5490 mbar, t = 215.70 k
  353.         !     upper - n2, p = 142.5490 mbar, t = 215.70 k
  354.         
  355.         ! Compute the optical depth by interpolating in ln(pressure) and 
  356.         ! temperature.  Below laytrop, the water vapor self-continuum and
  357.         ! foreign continuum is interpolated (in temperature) separately.
  358.         
  359.         ! Lower atmosphere loop
  360.  1----<       do lay = 1, laytrop
  361.  1      
  362.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(1) + 1
  363.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(1) + 1
  364.  1               inds = indself(lay)
  365.  1               indf = indfor(lay)
  366.  1               indm = indminor(lay)
  367.  1               pp = pavel(lay)
  368.  1               corradj =  1.
  369.  1               if (pp .lt. 250._r8) then
  370.  1                  corradj = 1._r8 - 0.15_r8 * (250._r8-pp) / 154.4_r8
  371.  1               endif
  372.  1      
  373.  1               scalen2 = colbrd(lay) * scaleminorn2(lay)
  374.  1 2--<          do ig = 1, ng1
  375.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
  376.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
  377.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
  378.  1 2                     (forref(indf+1,ig) -  forref(indf,ig))) 
  379.  1 2                taun2 = scalen2*(ka_mn2(indm,ig) + & 
  380.  1 2                     minorfrac(lay) * (ka_mn2(indm+1,ig) - ka_mn2(indm,ig)))
  381.  1 2                taug(lay,ig) = corradj * (colh2o(lay) * &
  382.  1 2                    (fac00(lay) * absa(ind0,ig) + &
  383.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
  384.  1 2                     fac01(lay) * absa(ind1,ig) + &
  385.  1 2                     fac11(lay) * absa(ind1+1,ig)) & 
  386.  1 2                     + tauself + taufor + taun2)
  387.  1 2                 fracs(lay,ig) = fracrefa(ig)
  388.  1 2-->          enddo
  389.  1---->       enddo
  390.         
  391.         ! Upper atmosphere loop
  392.  1----<       do lay = laytrop+1, nlayers
  393.  1      
  394.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(1) + 1
  395.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(1) + 1
  396.  1               indf = indfor(lay)
  397.  1               indm = indminor(lay)
  398.  1               pp = pavel(lay)
  399.  1               corradj =  1._r8 - 0.15_r8 * (pp / 95.6_r8)
  400.  1      
  401.  1               scalen2 = colbrd(lay) * scaleminorn2(lay)
  402.  1 2--<          do ig = 1, ng1
  403.  1 2                taufor = forfac(lay) * (forref(indf,ig) + &
  404.  1 2                     forfrac(lay) * (forref(indf+1,ig) - forref(indf,ig))) 
  405.  1 2                taun2 = scalen2*(kb_mn2(indm,ig) + & 
  406.  1 2                     minorfrac(lay) * (kb_mn2(indm+1,ig) - kb_mn2(indm,ig)))
  407.  1 2                taug(lay,ig) = corradj * (colh2o(lay) * &
  408.  1 2                    (fac00(lay) * absb(ind0,ig) + &
  409.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
  410.  1 2                     fac01(lay) * absb(ind1,ig) + &
  411.  1 2                     fac11(lay) * absb(ind1+1,ig)) &  
  412.  1 2                     + taufor + taun2)
  413.  1 2                fracs(lay,ig) = fracrefb(ig)
  414.  1 2-->          enddo
  415.  1---->       enddo
  416.         
  417.               end subroutine taugb1
  418.         
  419.         !----------------------------------------------------------------------------
  420.               subroutine taugb2(nlayers,ngptlw,laytrop,fracs  ,taug   )
  421.         !----------------------------------------------------------------------------
  422.         !
  423.         !     band 2:  350-500 cm-1 (low key - h2o; high key - h2o)
  424.         !
  425.         !     note: previous version of rrtm band 2: 
  426.         !           250 - 500 cm-1 (low - h2o; high - h2o)
  427.         !----------------------------------------------------------------------------
  428.         
  429.         ! ------- Modules -------
  430.         
  431.               use parrrtm, only : ng2, ngs1
  432.               use rrlw_kg02, only : fracrefa, fracrefb, absa, absb, &
  433.                                     selfref, forref
  434.         
  435.         ! ------- Declarations -------
  436.               integer      , intent(in ) :: nlayers
  437.               integer      , intent(in ) :: ngptlw
  438.               integer      , intent(in ) :: laytrop         ! tropopause layer index
  439.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
  440.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
  441.         
  442.         ! Local 
  443.               integer :: lay, ind0, ind1, inds, indf, ig
  444.               real(kind=r8) :: pp, corradj, tauself, taufor
  445.         
  446.         
  447.         ! Compute the optical depth by interpolating in ln(pressure) and 
  448.         ! temperature.  Below laytrop, the water vapor self-continuum and
  449.         ! foreign continuum is interpolated (in temperature) separately.
  450.         
  451.         ! Lower atmosphere loop
  452.  1----<       do lay = 1, laytrop
  453.  1      
  454.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(2) + 1
  455.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(2) + 1
  456.  1               inds = indself(lay)
  457.  1               indf = indfor(lay)
  458.  1               pp = pavel(lay)
  459.  1               corradj = 1._r8 - .05_r8 * (pp - 100._r8) / 900._r8
  460.  1 2--<          do ig = 1, ng2
  461.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
  462.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
  463.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
  464.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
  465.  1 2                taug(lay,ngs1+ig) = corradj * (colh2o(lay) * &
  466.  1 2                    (fac00(lay) * absa(ind0,ig) + &
  467.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
  468.  1 2                     fac01(lay) * absa(ind1,ig) + &
  469.  1 2                     fac11(lay) * absa(ind1+1,ig)) &
  470.  1 2                     + tauself + taufor)
  471.  1 2                fracs(lay,ngs1+ig) = fracrefa(ig)
  472.  1 2-->          enddo
  473.  1---->       enddo
  474.         
  475.         ! Upper atmosphere loop
  476.  1----<       do lay = laytrop+1, nlayers
  477.  1      
  478.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(2) + 1
  479.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(2) + 1
  480.  1               indf = indfor(lay)
  481.  1 2--<          do ig = 1, ng2
  482.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + &
  483.  1 2                     forfrac(lay) * (forref(indf+1,ig) - forref(indf,ig))) 
  484.  1 2                taug(lay,ngs1+ig) = colh2o(lay) * &
  485.  1 2                    (fac00(lay) * absb(ind0,ig) + &
  486.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
  487.  1 2                     fac01(lay) * absb(ind1,ig) + &
  488.  1 2                     fac11(lay) * absb(ind1+1,ig)) &
  489.  1 2                     + taufor
  490.  1 2                fracs(lay,ngs1+ig) = fracrefb(ig)
  491.  1 2-->          enddo
  492.  1---->       enddo
  493.         
  494.               end subroutine taugb2
  495.         
  496.         !----------------------------------------------------------------------------
  497.               subroutine taugb3(nlayers,ngptlw,laytrop,fracs  ,taug   )
  498.         !----------------------------------------------------------------------------
  499.         !
  500.         !     band 3:  500-630 cm-1 (low key - h2o,co2; low minor - n2o)
  501.         !                           (high key - h2o,co2; high minor - n2o)
  502.         !----------------------------------------------------------------------------
  503.         
  504.         ! ------- Modules -------
  505.         
  506.               use parrrtm, only : ng3, ngs2
  507.               use rrlw_ref, only : chi_mls
  508.               use rrlw_kg03, only : fracrefa, fracrefb, absa, absb,&
  509.                                     ka_mn2o, kb_mn2o, selfref, forref
  510.         
  511.         ! ------- Declarations -------
  512.               integer      , intent(in ) :: nlayers
  513.               integer      , intent(in ) :: ngptlw
  514.               integer      , intent(in ) :: laytrop         ! tropopause layer index
  515.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
  516.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
  517.         
  518.         ! Local 
  519.               integer :: lay, ind0, ind1, inds, indf, indm, ig
  520.               integer :: js, js1, jmn2o, jpl
  521.               real(kind=r8) :: speccomb, specparm, specmult, fs
  522.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
  523.               real(kind=r8) :: speccomb_mn2o, specparm_mn2o, specmult_mn2o, &
  524.                                fmn2o, fmn2omf, chi_n2o, ratn2o, adjfac, adjcoln2o
  525.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
  526.               real(kind=r8) :: p, p4, fk0, fk1, fk2
  527.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
  528.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
  529.               real(kind=r8) :: tauself, taufor, n2om1, n2om2, absn2o
  530.               real(kind=r8) :: refrat_planck_a, refrat_planck_b, refrat_m_a, refrat_m_b
  531.               real(kind=r8) :: tau_major, tau_major1
  532.         
  533.         
  534.         ! Minor gas mapping levels:
  535.         !     lower - n2o, p = 706.272 mbar, t = 278.94 k
  536.         !     upper - n2o, p = 95.58 mbar, t = 215.7 k
  537.         
  538.         !  P = 212.725 mb
  539.               refrat_planck_a = chi_mls(1,9)/chi_mls(2,9)
  540.         
  541.         !  P = 95.58 mb
  542.               refrat_planck_b = chi_mls(1,13)/chi_mls(2,13)
  543.         
  544.         !  P = 706.270mb
  545.               refrat_m_a = chi_mls(1,3)/chi_mls(2,3)
  546.         
  547.         !  P = 95.58 mb 
  548.               refrat_m_b = chi_mls(1,13)/chi_mls(2,13)
  549.         
  550.         ! Compute the optical depth by interpolating in ln(pressure) and 
  551.         ! temperature, and appropriate species.  Below laytrop, the water vapor 
  552.         ! self-continuum and foreign continuum is interpolated (in temperature) 
  553.         ! separately.
  554.         
  555.         ! Lower atmosphere loop
  556.  1----<       do lay = 1, laytrop
  557.  1      
  558.  1               speccomb = colh2o(lay) + rat_h2oco2(lay)*colco2(lay)
  559.  1               specparm = colh2o(lay)/speccomb
  560.  1               if (specparm .ge. oneminus) specparm = oneminus
  561.  1               specmult = 8._r8*(specparm)
  562.  1               js = 1 + int(specmult)
  563.  1               fs = mod(specmult,1.0_r8)        
  564.  1      
  565.  1               speccomb1 = colh2o(lay) + rat_h2oco2_1(lay)*colco2(lay)
  566.  1               specparm1 = colh2o(lay)/speccomb1
  567.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
  568.  1               specmult1 = 8._r8*(specparm1)
  569.  1               js1 = 1 + int(specmult1)
  570.  1               fs1 = mod(specmult1,1.0_r8)
  571.  1      
  572.  1               speccomb_mn2o = colh2o(lay) + refrat_m_a*colco2(lay)
  573.  1               specparm_mn2o = colh2o(lay)/speccomb_mn2o
  574.  1               if (specparm_mn2o .ge. oneminus) specparm_mn2o = oneminus
  575.  1               specmult_mn2o = 8._r8*specparm_mn2o
  576.  1               jmn2o = 1 + int(specmult_mn2o)
  577.  1               fmn2o = mod(specmult_mn2o,1.0_r8)
  578.  1               fmn2omf = minorfrac(lay)*fmn2o
  579.  1      !  In atmospheres where the amount of N2O is too great to be considered
  580.  1      !  a minor species, adjust the column amount of N2O by an empirical factor 
  581.  1      !  to obtain the proper contribution.
  582.  1               chi_n2o = coln2o(lay)/coldry(lay)
  583.  1               ratn2o = 1.e20_r8*chi_n2o/chi_mls(4,jp(lay)+1)
  584.  1               if (ratn2o .gt. 1.5_r8) then
  585.  1                  adjfac = 0.5_r8+(ratn2o-0.5_r8)**0.65_r8
  586.  1                  adjcoln2o = adjfac*chi_mls(4,jp(lay)+1)*coldry(lay)*1.e-20_r8
  587.  1               else
  588.  1                  adjcoln2o = coln2o(lay)
  589.  1               endif
  590.  1      
  591.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colco2(lay)
  592.  1               specparm_planck = colh2o(lay)/speccomb_planck
  593.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
  594.  1               specmult_planck = 8._r8*specparm_planck
  595.  1               jpl= 1 + int(specmult_planck)
  596.  1               fpl = mod(specmult_planck,1.0_r8)
  597.  1      
  598.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(3) + js
  599.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(3) + js1
  600.  1               inds = indself(lay)
  601.  1               indf = indfor(lay)
  602.  1               indm = indminor(lay)
  603.  1      
  604.  1               if (specparm .lt. 0.125_r8) then
  605.  1                  p = fs - 1
  606.  1                  p4 = p**4
  607.  1                  fk0 = p4
  608.  1                  fk1 = 1 - p - 2.0_r8*p4
  609.  1                  fk2 = p + p4
  610.  1                  fac000 = fk0*fac00(lay)
  611.  1                  fac100 = fk1*fac00(lay)
  612.  1                  fac200 = fk2*fac00(lay)
  613.  1                  fac010 = fk0*fac10(lay)
  614.  1                  fac110 = fk1*fac10(lay)
  615.  1                  fac210 = fk2*fac10(lay)
  616.  1               else if (specparm .gt. 0.875_r8) then
  617.  1                  p = -fs 
  618.  1                  p4 = p**4
  619.  1                  fk0 = p4
  620.  1                  fk1 = 1 - p - 2.0_r8*p4
  621.  1                  fk2 = p + p4
  622.  1                  fac000 = fk0*fac00(lay)
  623.  1                  fac100 = fk1*fac00(lay)
  624.  1                  fac200 = fk2*fac00(lay)
  625.  1                  fac010 = fk0*fac10(lay)
  626.  1                  fac110 = fk1*fac10(lay)
  627.  1                  fac210 = fk2*fac10(lay)
  628.  1               else
  629.  1                  fac000 = (1._r8 - fs) * fac00(lay)
  630.  1                  fac010 = (1._r8 - fs) * fac10(lay)
  631.  1                  fac100 = fs * fac00(lay)
  632.  1                  fac110 = fs * fac10(lay)
  633.  1               endif
  634.  1               if (specparm1 .lt. 0.125_r8) then
  635.  1                  p = fs1 - 1
  636.  1                  p4 = p**4
  637.  1                  fk0 = p4
  638.  1                  fk1 = 1 - p - 2.0_r8*p4
  639.  1                  fk2 = p + p4
  640.  1                  fac001 = fk0*fac01(lay)
  641.  1                  fac101 = fk1*fac01(lay)
  642.  1                  fac201 = fk2*fac01(lay)
  643.  1                  fac011 = fk0*fac11(lay)
  644.  1                  fac111 = fk1*fac11(lay)
  645.  1                  fac211 = fk2*fac11(lay)
  646.  1               else if (specparm1 .gt. 0.875_r8) then
  647.  1                  p = -fs1 
  648.  1                  p4 = p**4
  649.  1                  fk0 = p4
  650.  1                  fk1 = 1 - p - 2.0_r8*p4
  651.  1                  fk2 = p + p4
  652.  1                  fac001 = fk0*fac01(lay)
  653.  1                  fac101 = fk1*fac01(lay)
  654.  1                  fac201 = fk2*fac01(lay)
  655.  1                  fac011 = fk0*fac11(lay)
  656.  1                  fac111 = fk1*fac11(lay)
  657.  1                  fac211 = fk2*fac11(lay)
  658.  1               else
  659.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
  660.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
  661.  1                  fac101 = fs1 * fac01(lay)
  662.  1                  fac111 = fs1 * fac11(lay)
  663.  1               endif
  664.  1      
  665.  1 2--<          do ig = 1, ng3
  666.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
  667.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
  668.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
  669.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
  670.  1 2                n2om1 = ka_mn2o(jmn2o,indm,ig) + fmn2o * &
  671.  1 2                     (ka_mn2o(jmn2o+1,indm,ig) - ka_mn2o(jmn2o,indm,ig))
  672.  1 2                n2om2 = ka_mn2o(jmn2o,indm+1,ig) + fmn2o * &
  673.  1 2                     (ka_mn2o(jmn2o+1,indm+1,ig) - ka_mn2o(jmn2o,indm+1,ig))
  674.  1 2                absn2o = n2om1 + minorfrac(lay) * (n2om2 - n2om1)
  675.  1 2    
  676.  1 2                if (specparm .lt. 0.125_r8) then
  677.  1 2                   tau_major = speccomb * &
  678.  1 2                        (fac000 * absa(ind0,ig) + &
  679.  1 2                        fac100 * absa(ind0+1,ig) + &
  680.  1 2                        fac200 * absa(ind0+2,ig) + &
  681.  1 2                        fac010 * absa(ind0+9,ig) + &
  682.  1 2                        fac110 * absa(ind0+10,ig) + &
  683.  1 2                        fac210 * absa(ind0+11,ig))
  684.  1 2                else if (specparm .gt. 0.875_r8) then
  685.  1 2                   tau_major = speccomb * &
  686.  1 2                        (fac200 * absa(ind0-1,ig) + &
  687.  1 2                        fac100 * absa(ind0,ig) + &
  688.  1 2                        fac000 * absa(ind0+1,ig) + &
  689.  1 2                        fac210 * absa(ind0+8,ig) + &
  690.  1 2                        fac110 * absa(ind0+9,ig) + &
  691.  1 2                        fac010 * absa(ind0+10,ig))
  692.  1 2                else
  693.  1 2                   tau_major = speccomb * &
  694.  1 2                        (fac000 * absa(ind0,ig) + &
  695.  1 2                        fac100 * absa(ind0+1,ig) + &
  696.  1 2                        fac010 * absa(ind0+9,ig) + &
  697.  1 2                        fac110 * absa(ind0+10,ig))
  698.  1 2                endif
  699.  1 2    
  700.  1 2                if (specparm1 .lt. 0.125_r8) then
  701.  1 2                   tau_major1 = speccomb1 * &
  702.  1 2                        (fac001 * absa(ind1,ig) + &
  703.  1 2                        fac101 * absa(ind1+1,ig) + &
  704.  1 2                        fac201 * absa(ind1+2,ig) + &
  705.  1 2                        fac011 * absa(ind1+9,ig) + &
  706.  1 2                        fac111 * absa(ind1+10,ig) + &
  707.  1 2                        fac211 * absa(ind1+11,ig))
  708.  1 2                else if (specparm1 .gt. 0.875_r8) then
  709.  1 2                   tau_major1 = speccomb1 * &
  710.  1 2                        (fac201 * absa(ind1-1,ig) + &
  711.  1 2                        fac101 * absa(ind1,ig) + &
  712.  1 2                        fac001 * absa(ind1+1,ig) + &
  713.  1 2                        fac211 * absa(ind1+8,ig) + &
  714.  1 2                        fac111 * absa(ind1+9,ig) + &
  715.  1 2                        fac011 * absa(ind1+10,ig))
  716.  1 2                else
  717.  1 2                   tau_major1 = speccomb1 * &
  718.  1 2                        (fac001 * absa(ind1,ig) +  &
  719.  1 2                        fac101 * absa(ind1+1,ig) + &
  720.  1 2                        fac011 * absa(ind1+9,ig) + &
  721.  1 2                        fac111 * absa(ind1+10,ig))
  722.  1 2                endif
  723.  1 2    
  724.  1 2                taug(lay,ngs2+ig) = tau_major + tau_major1 &
  725.  1 2                     + tauself + taufor &
  726.  1 2                     + adjcoln2o*absn2o
  727.  1 2                fracs(lay,ngs2+ig) = fracrefa(ig,jpl) + fpl * &
  728.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
  729.  1 2-->          enddo
  730.  1---->       enddo
  731.         
  732.         ! Upper atmosphere loop
  733.  1----<       do lay = laytrop+1, nlayers
  734.  1      
  735.  1               speccomb = colh2o(lay) + rat_h2oco2(lay)*colco2(lay)
  736.  1               specparm = colh2o(lay)/speccomb
  737.  1               if (specparm .ge. oneminus) specparm = oneminus
  738.  1               specmult = 4._r8*(specparm)
  739.  1               js = 1 + int(specmult)
  740.  1               fs = mod(specmult,1.0_r8)
  741.  1      
  742.  1               speccomb1 = colh2o(lay) + rat_h2oco2_1(lay)*colco2(lay)
  743.  1               specparm1 = colh2o(lay)/speccomb1
  744.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
  745.  1               specmult1 = 4._r8*(specparm1)
  746.  1               js1 = 1 + int(specmult1)
  747.  1               fs1 = mod(specmult1,1.0_r8)
  748.  1      
  749.  1               fac000 = (1._r8 - fs) * fac00(lay)
  750.  1               fac010 = (1._r8 - fs) * fac10(lay)
  751.  1               fac100 = fs * fac00(lay)
  752.  1               fac110 = fs * fac10(lay)
  753.  1               fac001 = (1._r8 - fs1) * fac01(lay)
  754.  1               fac011 = (1._r8 - fs1) * fac11(lay)
  755.  1               fac101 = fs1 * fac01(lay)
  756.  1               fac111 = fs1 * fac11(lay)
  757.  1      
  758.  1               speccomb_mn2o = colh2o(lay) + refrat_m_b*colco2(lay)
  759.  1               specparm_mn2o = colh2o(lay)/speccomb_mn2o
  760.  1               if (specparm_mn2o .ge. oneminus) specparm_mn2o = oneminus
  761.  1               specmult_mn2o = 4._r8*specparm_mn2o
  762.  1               jmn2o = 1 + int(specmult_mn2o)
  763.  1               fmn2o = mod(specmult_mn2o,1.0_r8)
  764.  1               fmn2omf = minorfrac(lay)*fmn2o
  765.  1      !  In atmospheres where the amount of N2O is too great to be considered
  766.  1      !  a minor species, adjust the column amount of N2O by an empirical factor 
  767.  1      !  to obtain the proper contribution.
  768.  1               chi_n2o = coln2o(lay)/coldry(lay)
  769.  1               ratn2o = 1.e20*chi_n2o/chi_mls(4,jp(lay)+1)
  770.  1               if (ratn2o .gt. 1.5_r8) then
  771.  1                  adjfac = 0.5_r8+(ratn2o-0.5_r8)**0.65_r8
  772.  1                  adjcoln2o = adjfac*chi_mls(4,jp(lay)+1)*coldry(lay)*1.e-20_r8
  773.  1               else
  774.  1                  adjcoln2o = coln2o(lay)
  775.  1               endif
  776.  1      
  777.  1               speccomb_planck = colh2o(lay)+refrat_planck_b*colco2(lay)
  778.  1               specparm_planck = colh2o(lay)/speccomb_planck
  779.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
  780.  1               specmult_planck = 4._r8*specparm_planck
  781.  1               jpl= 1 + int(specmult_planck)
  782.  1               fpl = mod(specmult_planck,1.0_r8)
  783.  1      
  784.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(3) + js
  785.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(3) + js1
  786.  1               indf = indfor(lay)
  787.  1               indm = indminor(lay)
  788.  1      
  789.  1 2--<          do ig = 1, ng3
  790.  1 2                taufor = forfac(lay) * (forref(indf,ig) + &
  791.  1 2                     forfrac(lay) * (forref(indf+1,ig) - forref(indf,ig))) 
  792.  1 2                n2om1 = kb_mn2o(jmn2o,indm,ig) + fmn2o * &
  793.  1 2                     (kb_mn2o(jmn2o+1,indm,ig)-kb_mn2o(jmn2o,indm,ig))
  794.  1 2                n2om2 = kb_mn2o(jmn2o,indm+1,ig) + fmn2o * &
  795.  1 2                     (kb_mn2o(jmn2o+1,indm+1,ig)-kb_mn2o(jmn2o,indm+1,ig))
  796.  1 2                absn2o = n2om1 + minorfrac(lay) * (n2om2 - n2om1)
  797.  1 2                taug(lay,ngs2+ig) = speccomb * &
  798.  1 2                    (fac000 * absb(ind0,ig) + &
  799.  1 2                    fac100 * absb(ind0+1,ig) + &
  800.  1 2                    fac010 * absb(ind0+5,ig) + &
  801.  1 2                    fac110 * absb(ind0+6,ig)) &
  802.  1 2                    + speccomb1 * &
  803.  1 2                    (fac001 * absb(ind1,ig) +  &
  804.  1 2                    fac101 * absb(ind1+1,ig) + &
  805.  1 2                    fac011 * absb(ind1+5,ig) + &
  806.  1 2                    fac111 * absb(ind1+6,ig))  &
  807.  1 2                    + taufor &
  808.  1 2                    + adjcoln2o*absn2o
  809.  1 2                fracs(lay,ngs2+ig) = fracrefb(ig,jpl) + fpl * &
  810.  1 2                    (fracrefb(ig,jpl+1)-fracrefb(ig,jpl))
  811.  1 2-->          enddo
  812.  1---->       enddo
  813.         
  814.               end subroutine taugb3
ftn-5001 ftn: NOTE File = rrtmg_lw_taumol.f90, Line = 814 
  Local variable "FMN2OMF" is assigned a value but never used.

  815.         
  816.         !----------------------------------------------------------------------------
  817.               subroutine taugb4(nlayers,ngptlw,laytrop,fracs  ,taug   )
  818.         !----------------------------------------------------------------------------
  819.         !
  820.         !     band 4:  630-700 cm-1 (low key - h2o,co2; high key - o3,co2)
  821.         !----------------------------------------------------------------------------
  822.         
  823.         ! ------- Modules -------
  824.         
  825.               use parrrtm, only : ng4, ngs3
  826.               use rrlw_ref, only : chi_mls
  827.               use rrlw_kg04, only : fracrefa, fracrefb, absa, absb, &
  828.                                     selfref, forref
  829.         
  830.         ! ------- Declarations -------
  831.               integer      , intent(in ) :: nlayers
  832.               integer      , intent(in ) :: ngptlw
  833.               integer      , intent(in ) :: laytrop         ! tropopause layer index
  834.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
  835.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
  836.         
  837.         ! Local 
  838.               integer :: lay, ind0, ind1, inds, indf, ig
  839.               integer :: js, js1, jpl
  840.               real(kind=r8) :: speccomb, specparm, specmult, fs
  841.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
  842.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
  843.               real(kind=r8) :: p, p4, fk0, fk1, fk2
  844.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
  845.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
  846.               real(kind=r8) :: tauself, taufor
  847.               real(kind=r8) :: refrat_planck_a, refrat_planck_b
  848.               real(kind=r8) :: tau_major, tau_major1
  849.         
  850.         
  851.         ! P =   142.5940 mb
  852.               refrat_planck_a = chi_mls(1,11)/chi_mls(2,11)
  853.         
  854.         ! P = 95.58350 mb
  855.               refrat_planck_b = chi_mls(3,13)/chi_mls(2,13)
  856.         
  857.         ! Compute the optical depth by interpolating in ln(pressure) and 
  858.         ! temperature, and appropriate species.  Below laytrop, the water 
  859.         ! vapor self-continuum and foreign continuum is interpolated (in temperature) 
  860.         ! separately.
  861.         
  862.         ! Lower atmosphere loop
  863.  1----<       do lay = 1, laytrop
  864.  1      
  865.  1               speccomb = colh2o(lay) + rat_h2oco2(lay)*colco2(lay)
  866.  1               specparm = colh2o(lay)/speccomb
  867.  1               if (specparm .ge. oneminus) specparm = oneminus
  868.  1               specmult = 8._r8*(specparm)
  869.  1               js = 1 + int(specmult)
  870.  1               fs = mod(specmult,1.0_r8)
  871.  1      
  872.  1               speccomb1 = colh2o(lay) + rat_h2oco2_1(lay)*colco2(lay)
  873.  1               specparm1 = colh2o(lay)/speccomb1
  874.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
  875.  1               specmult1 = 8._r8*(specparm1)
  876.  1               js1 = 1 + int(specmult1)
  877.  1               fs1 = mod(specmult1,1.0_r8)
  878.  1      
  879.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colco2(lay)
  880.  1               specparm_planck = colh2o(lay)/speccomb_planck
  881.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
  882.  1               specmult_planck = 8._r8*specparm_planck
  883.  1               jpl= 1 + int(specmult_planck)
  884.  1               fpl = mod(specmult_planck,1.0_r8)
  885.  1      
  886.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(4) + js
  887.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(4) + js1
  888.  1               inds = indself(lay)
  889.  1               indf = indfor(lay)
  890.  1      
  891.  1               if (specparm .lt. 0.125_r8) then
  892.  1                  p = fs - 1
  893.  1                  p4 = p**4
  894.  1                  fk0 = p4
  895.  1                  fk1 = 1 - p - 2.0_r8*p4
  896.  1                  fk2 = p + p4
  897.  1                  fac000 = fk0*fac00(lay)
  898.  1                  fac100 = fk1*fac00(lay)
  899.  1                  fac200 = fk2*fac00(lay)
  900.  1                  fac010 = fk0*fac10(lay)
  901.  1                  fac110 = fk1*fac10(lay)
  902.  1                  fac210 = fk2*fac10(lay)
  903.  1               else if (specparm .gt. 0.875_r8) then
  904.  1                  p = -fs 
  905.  1                  p4 = p**4
  906.  1                  fk0 = p4
  907.  1                  fk1 = 1 - p - 2.0_r8*p4
  908.  1                  fk2 = p + p4
  909.  1                  fac000 = fk0*fac00(lay)
  910.  1                  fac100 = fk1*fac00(lay)
  911.  1                  fac200 = fk2*fac00(lay)
  912.  1                  fac010 = fk0*fac10(lay)
  913.  1                  fac110 = fk1*fac10(lay)
  914.  1                  fac210 = fk2*fac10(lay)
  915.  1               else
  916.  1                  fac000 = (1._r8 - fs) * fac00(lay)
  917.  1                  fac010 = (1._r8 - fs) * fac10(lay)
  918.  1                  fac100 = fs * fac00(lay)
  919.  1                  fac110 = fs * fac10(lay)
  920.  1               endif
  921.  1      
  922.  1               if (specparm1 .lt. 0.125_r8) then
  923.  1                  p = fs1 - 1
  924.  1                  p4 = p**4
  925.  1                  fk0 = p4
  926.  1                  fk1 = 1 - p - 2.0_r8*p4
  927.  1                  fk2 = p + p4
  928.  1                  fac001 = fk0*fac01(lay)
  929.  1                  fac101 = fk1*fac01(lay)
  930.  1                  fac201 = fk2*fac01(lay)
  931.  1                  fac011 = fk0*fac11(lay)
  932.  1                  fac111 = fk1*fac11(lay)
  933.  1                  fac211 = fk2*fac11(lay)
  934.  1               else if (specparm1 .gt. 0.875_r8) then
  935.  1                  p = -fs1 
  936.  1                  p4 = p**4
  937.  1                  fk0 = p4
  938.  1                  fk1 = 1 - p - 2.0_r8*p4
  939.  1                  fk2 = p + p4
  940.  1                  fac001 = fk0*fac01(lay)
  941.  1                  fac101 = fk1*fac01(lay)
  942.  1                  fac201 = fk2*fac01(lay)
  943.  1                  fac011 = fk0*fac11(lay)
  944.  1                  fac111 = fk1*fac11(lay)
  945.  1                  fac211 = fk2*fac11(lay)
  946.  1               else
  947.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
  948.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
  949.  1                  fac101 = fs1 * fac01(lay)
  950.  1                  fac111 = fs1 * fac11(lay)
  951.  1               endif
  952.  1      
  953.  1 2--<          do ig = 1, ng4
  954.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
  955.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
  956.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
  957.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
  958.  1 2    
  959.  1 2                if (specparm .lt. 0.125_r8) then
  960.  1 2                   tau_major = speccomb * &
  961.  1 2                        (fac000 * absa(ind0,ig) + &
  962.  1 2                        fac100 * absa(ind0+1,ig) + &
  963.  1 2                        fac200 * absa(ind0+2,ig) + &
  964.  1 2                        fac010 * absa(ind0+9,ig) + &
  965.  1 2                        fac110 * absa(ind0+10,ig) + &
  966.  1 2                        fac210 * absa(ind0+11,ig))
  967.  1 2                else if (specparm .gt. 0.875_r8) then
  968.  1 2                   tau_major = speccomb * &
  969.  1 2                        (fac200 * absa(ind0-1,ig) + &
  970.  1 2                        fac100 * absa(ind0,ig) + &
  971.  1 2                        fac000 * absa(ind0+1,ig) + &
  972.  1 2                        fac210 * absa(ind0+8,ig) + &
  973.  1 2                        fac110 * absa(ind0+9,ig) + &
  974.  1 2                        fac010 * absa(ind0+10,ig))
  975.  1 2                else
  976.  1 2                   tau_major = speccomb * &
  977.  1 2                        (fac000 * absa(ind0,ig) + &
  978.  1 2                        fac100 * absa(ind0+1,ig) + &
  979.  1 2                        fac010 * absa(ind0+9,ig) + &
  980.  1 2                        fac110 * absa(ind0+10,ig))
  981.  1 2                endif
  982.  1 2    
  983.  1 2                if (specparm1 .lt. 0.125_r8) then
  984.  1 2                   tau_major1 = speccomb1 * &
  985.  1 2                        (fac001 * absa(ind1,ig) +  &
  986.  1 2                        fac101 * absa(ind1+1,ig) + &
  987.  1 2                        fac201 * absa(ind1+2,ig) + &
  988.  1 2                        fac011 * absa(ind1+9,ig) + &
  989.  1 2                        fac111 * absa(ind1+10,ig) + &
  990.  1 2                        fac211 * absa(ind1+11,ig))
  991.  1 2                else if (specparm1 .gt. 0.875_r8) then
  992.  1 2                   tau_major1 = speccomb1 * &
  993.  1 2                        (fac201 * absa(ind1-1,ig) + &
  994.  1 2                        fac101 * absa(ind1,ig) + &
  995.  1 2                        fac001 * absa(ind1+1,ig) + &
  996.  1 2                        fac211 * absa(ind1+8,ig) + &
  997.  1 2                        fac111 * absa(ind1+9,ig) + &
  998.  1 2                        fac011 * absa(ind1+10,ig))
  999.  1 2                else
 1000.  1 2                   tau_major1 = speccomb1 * &
 1001.  1 2                        (fac001 * absa(ind1,ig) + &
 1002.  1 2                        fac101 * absa(ind1+1,ig) + &
 1003.  1 2                        fac011 * absa(ind1+9,ig) + &
 1004.  1 2                        fac111 * absa(ind1+10,ig))
 1005.  1 2                endif
 1006.  1 2    
 1007.  1 2                taug(lay,ngs3+ig) = tau_major + tau_major1 &
 1008.  1 2                     + tauself + taufor
 1009.  1 2                fracs(lay,ngs3+ig) = fracrefa(ig,jpl) + fpl * &
 1010.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 1011.  1 2-->          enddo
 1012.  1---->       enddo
 1013.         
 1014.         ! Upper atmosphere loop
 1015.  1----<       do lay = laytrop+1, nlayers
 1016.  1      
 1017.  1               speccomb = colo3(lay) + rat_o3co2(lay)*colco2(lay)
 1018.  1               specparm = colo3(lay)/speccomb
 1019.  1               if (specparm .ge. oneminus) specparm = oneminus
 1020.  1               specmult = 4._r8*(specparm)
 1021.  1               js = 1 + int(specmult)
 1022.  1               fs = mod(specmult,1.0_r8)
 1023.  1      
 1024.  1               speccomb1 = colo3(lay) + rat_o3co2_1(lay)*colco2(lay)
 1025.  1               specparm1 = colo3(lay)/speccomb1
 1026.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 1027.  1               specmult1 = 4._r8*(specparm1)
 1028.  1               js1 = 1 + int(specmult1)
 1029.  1               fs1 = mod(specmult1,1.0_r8)
 1030.  1      
 1031.  1               fac000 = (1._r8 - fs) * fac00(lay)
 1032.  1               fac010 = (1._r8 - fs) * fac10(lay)
 1033.  1               fac100 = fs * fac00(lay)
 1034.  1               fac110 = fs * fac10(lay)
 1035.  1               fac001 = (1._r8 - fs1) * fac01(lay)
 1036.  1               fac011 = (1._r8 - fs1) * fac11(lay)
 1037.  1               fac101 = fs1 * fac01(lay)
 1038.  1               fac111 = fs1 * fac11(lay)
 1039.  1      
 1040.  1               speccomb_planck = colo3(lay)+refrat_planck_b*colco2(lay)
 1041.  1               specparm_planck = colo3(lay)/speccomb_planck
 1042.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 1043.  1               specmult_planck = 4._r8*specparm_planck
 1044.  1               jpl= 1 + int(specmult_planck)
 1045.  1               fpl = mod(specmult_planck,1.0_r8)
 1046.  1      
 1047.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(4) + js
 1048.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(4) + js1
 1049.  1      
 1050.  1 2--<          do ig = 1, ng4
 1051.  1 2                taug(lay,ngs3+ig) =  speccomb * &
 1052.  1 2                    (fac000 * absb(ind0,ig) + &
 1053.  1 2                    fac100 * absb(ind0+1,ig) + &
 1054.  1 2                    fac010 * absb(ind0+5,ig) + &
 1055.  1 2                    fac110 * absb(ind0+6,ig)) &
 1056.  1 2                    + speccomb1 * &
 1057.  1 2                    (fac001 * absb(ind1,ig) +  &
 1058.  1 2                    fac101 * absb(ind1+1,ig) + &
 1059.  1 2                    fac011 * absb(ind1+5,ig) + &
 1060.  1 2                    fac111 * absb(ind1+6,ig))
 1061.  1 2                fracs(lay,ngs3+ig) = fracrefb(ig,jpl) + fpl * &
 1062.  1 2                    (fracrefb(ig,jpl+1)-fracrefb(ig,jpl))
 1063.  1 2-->          enddo
 1064.  1      
 1065.  1      ! Empirical modification to code to improve stratospheric cooling rates
 1066.  1      ! for co2.  Revised to apply weighting for g-point reduction in this band.
 1067.  1      
 1068.  1               taug(lay,ngs3+8)=taug(lay,ngs3+8)*0.92
 1069.  1               taug(lay,ngs3+9)=taug(lay,ngs3+9)*0.88
 1070.  1               taug(lay,ngs3+10)=taug(lay,ngs3+10)*1.07
 1071.  1               taug(lay,ngs3+11)=taug(lay,ngs3+11)*1.1
 1072.  1               taug(lay,ngs3+12)=taug(lay,ngs3+12)*0.99
 1073.  1               taug(lay,ngs3+13)=taug(lay,ngs3+13)*0.88
 1074.  1               taug(lay,ngs3+14)=taug(lay,ngs3+14)*0.943
 1075.  1      
 1076.  1---->       enddo
 1077.         
 1078.               end subroutine taugb4
 1079.         
 1080.         !----------------------------------------------------------------------------
 1081.               subroutine taugb5(nlayers,ngptlw,laytrop,fracs  ,taug   )
 1082.         !----------------------------------------------------------------------------
 1083.         !
 1084.         !     band 5:  700-820 cm-1 (low key - h2o,co2; low minor - o3, ccl4)
 1085.         !                           (high key - o3,co2)
 1086.         !----------------------------------------------------------------------------
 1087.         
 1088.         ! ------- Modules -------
 1089.         
 1090.               use parrrtm, only : ng5, ngs4
 1091.               use rrlw_ref, only : chi_mls
 1092.               use rrlw_kg05, only : fracrefa, fracrefb, absa, absb, &
 1093.                                     ka_mo3, selfref, forref, ccl4
 1094.         
 1095.         ! ------- Declarations -------
 1096.               integer      , intent(in ) :: nlayers
 1097.               integer      , intent(in ) :: ngptlw
 1098.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 1099.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 1100.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 1101.         
 1102.         ! Local 
 1103.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 1104.               integer :: js, js1, jmo3, jpl
 1105.               real(kind=r8) :: speccomb, specparm, specmult, fs
 1106.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 1107.               real(kind=r8) :: speccomb_mo3, specparm_mo3, specmult_mo3, fmo3
 1108.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 1109.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 1110.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 1111.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 1112.               real(kind=r8) :: tauself, taufor, o3m1, o3m2, abso3
 1113.               real(kind=r8) :: refrat_planck_a, refrat_planck_b, refrat_m_a
 1114.               real(kind=r8) :: tau_major, tau_major1
 1115.         
 1116.         
 1117.         ! Minor gas mapping level :
 1118.         !     lower - o3, p = 317.34 mbar, t = 240.77 k
 1119.         !     lower - ccl4
 1120.         
 1121.         ! Calculate reference ratio to be used in calculation of Planck
 1122.         ! fraction in lower/upper atmosphere.
 1123.         
 1124.         ! P = 473.420 mb
 1125.               refrat_planck_a = chi_mls(1,5)/chi_mls(2,5)
 1126.         
 1127.         ! P = 0.2369 mb
 1128.               refrat_planck_b = chi_mls(3,43)/chi_mls(2,43)
 1129.         
 1130.         ! P = 317.3480
 1131.               refrat_m_a = chi_mls(1,7)/chi_mls(2,7)
 1132.         
 1133.         ! Compute the optical depth by interpolating in ln(pressure) and 
 1134.         ! temperature, and appropriate species.  Below laytrop, the 
 1135.         ! water vapor self-continuum and foreign continuum is 
 1136.         ! interpolated (in temperature) separately.
 1137.         
 1138.         ! Lower atmosphere loop
 1139.  1----<       do lay = 1, laytrop
 1140.  1      
 1141.  1               speccomb = colh2o(lay) + rat_h2oco2(lay)*colco2(lay)
 1142.  1               specparm = colh2o(lay)/speccomb
 1143.  1               if (specparm .ge. oneminus) specparm = oneminus
 1144.  1               specmult = 8._r8*(specparm)
 1145.  1               js = 1 + int(specmult)
 1146.  1               fs = mod(specmult,1.0_r8)
 1147.  1      
 1148.  1               speccomb1 = colh2o(lay) + rat_h2oco2_1(lay)*colco2(lay)
 1149.  1               specparm1 = colh2o(lay)/speccomb1
 1150.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 1151.  1               specmult1 = 8._r8*(specparm1)
 1152.  1               js1 = 1 + int(specmult1)
 1153.  1               fs1 = mod(specmult1,1.0_r8)
 1154.  1      
 1155.  1               speccomb_mo3 = colh2o(lay) + refrat_m_a*colco2(lay)
 1156.  1               specparm_mo3 = colh2o(lay)/speccomb_mo3
 1157.  1               if (specparm_mo3 .ge. oneminus) specparm_mo3 = oneminus
 1158.  1               specmult_mo3 = 8._r8*specparm_mo3
 1159.  1               jmo3 = 1 + int(specmult_mo3)
 1160.  1               fmo3 = mod(specmult_mo3,1.0_r8)
 1161.  1      
 1162.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colco2(lay)
 1163.  1               specparm_planck = colh2o(lay)/speccomb_planck
 1164.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 1165.  1               specmult_planck = 8._r8*specparm_planck
 1166.  1               jpl= 1 + int(specmult_planck)
 1167.  1               fpl = mod(specmult_planck,1.0_r8)
 1168.  1      
 1169.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(5) + js
 1170.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(5) + js1
 1171.  1               inds = indself(lay)
 1172.  1               indf = indfor(lay)
 1173.  1               indm = indminor(lay)
 1174.  1      
 1175.  1               if (specparm .lt. 0.125_r8) then
 1176.  1                  p = fs - 1
 1177.  1                  p4 = p**4
 1178.  1                  fk0 = p4
 1179.  1                  fk1 = 1 - p - 2.0_r8*p4
 1180.  1                  fk2 = p + p4
 1181.  1                  fac000 = fk0*fac00(lay)
 1182.  1                  fac100 = fk1*fac00(lay)
 1183.  1                  fac200 = fk2*fac00(lay)
 1184.  1                  fac010 = fk0*fac10(lay)
 1185.  1                  fac110 = fk1*fac10(lay)
 1186.  1                  fac210 = fk2*fac10(lay)
 1187.  1               else if (specparm .gt. 0.875_r8) then
 1188.  1                  p = -fs 
 1189.  1                  p4 = p**4
 1190.  1                  fk0 = p4
 1191.  1                  fk1 = 1 - p - 2.0_r8*p4
 1192.  1                  fk2 = p + p4
 1193.  1                  fac000 = fk0*fac00(lay)
 1194.  1                  fac100 = fk1*fac00(lay)
 1195.  1                  fac200 = fk2*fac00(lay)
 1196.  1                  fac010 = fk0*fac10(lay)
 1197.  1                  fac110 = fk1*fac10(lay)
 1198.  1                  fac210 = fk2*fac10(lay)
 1199.  1               else
 1200.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 1201.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 1202.  1                  fac100 = fs * fac00(lay)
 1203.  1                  fac110 = fs * fac10(lay)
 1204.  1               endif
 1205.  1      
 1206.  1               if (specparm1 .lt. 0.125_r8) then
 1207.  1                  p = fs1 - 1
 1208.  1                  p4 = p**4
 1209.  1                  fk0 = p4
 1210.  1                  fk1 = 1 - p - 2.0_r8*p4
 1211.  1                  fk2 = p + p4
 1212.  1                  fac001 = fk0*fac01(lay)
 1213.  1                  fac101 = fk1*fac01(lay)
 1214.  1                  fac201 = fk2*fac01(lay)
 1215.  1                  fac011 = fk0*fac11(lay)
 1216.  1                  fac111 = fk1*fac11(lay)
 1217.  1                  fac211 = fk2*fac11(lay)
 1218.  1               else if (specparm1 .gt. 0.875_r8) then
 1219.  1                  p = -fs1 
 1220.  1                  p4 = p**4
 1221.  1                  fk0 = p4
 1222.  1                  fk1 = 1 - p - 2.0_r8*p4
 1223.  1                  fk2 = p + p4
 1224.  1                  fac001 = fk0*fac01(lay)
 1225.  1                  fac101 = fk1*fac01(lay)
 1226.  1                  fac201 = fk2*fac01(lay)
 1227.  1                  fac011 = fk0*fac11(lay)
 1228.  1                  fac111 = fk1*fac11(lay)
 1229.  1                  fac211 = fk2*fac11(lay)
 1230.  1               else
 1231.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 1232.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 1233.  1                  fac101 = fs1 * fac01(lay)
 1234.  1                  fac111 = fs1 * fac11(lay)
 1235.  1               endif
 1236.  1      
 1237.  1 2--<          do ig = 1, ng5
 1238.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 1239.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 1240.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 1241.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 1242.  1 2                o3m1 = ka_mo3(jmo3,indm,ig) + fmo3 * &
 1243.  1 2                     (ka_mo3(jmo3+1,indm,ig)-ka_mo3(jmo3,indm,ig))
 1244.  1 2                o3m2 = ka_mo3(jmo3,indm+1,ig) + fmo3 * &
 1245.  1 2                     (ka_mo3(jmo3+1,indm+1,ig)-ka_mo3(jmo3,indm+1,ig))
 1246.  1 2                abso3 = o3m1 + minorfrac(lay)*(o3m2-o3m1)
 1247.  1 2    
 1248.  1 2                if (specparm .lt. 0.125_r8) then
 1249.  1 2                   tau_major = speccomb * &
 1250.  1 2                        (fac000 * absa(ind0,ig) + &
 1251.  1 2                        fac100 * absa(ind0+1,ig) + &
 1252.  1 2                        fac200 * absa(ind0+2,ig) + &
 1253.  1 2                        fac010 * absa(ind0+9,ig) + &
 1254.  1 2                        fac110 * absa(ind0+10,ig) + &
 1255.  1 2                        fac210 * absa(ind0+11,ig))
 1256.  1 2                else if (specparm .gt. 0.875_r8) then
 1257.  1 2                   tau_major = speccomb * &
 1258.  1 2                        (fac200 * absa(ind0-1,ig) + &
 1259.  1 2                        fac100 * absa(ind0,ig) + &
 1260.  1 2                        fac000 * absa(ind0+1,ig) + &
 1261.  1 2                        fac210 * absa(ind0+8,ig) + &
 1262.  1 2                        fac110 * absa(ind0+9,ig) + &
 1263.  1 2                        fac010 * absa(ind0+10,ig))
 1264.  1 2                else
 1265.  1 2                   tau_major = speccomb * &
 1266.  1 2                        (fac000 * absa(ind0,ig) + &
 1267.  1 2                        fac100 * absa(ind0+1,ig) + &
 1268.  1 2                        fac010 * absa(ind0+9,ig) + &
 1269.  1 2                        fac110 * absa(ind0+10,ig))
 1270.  1 2                endif
 1271.  1 2    
 1272.  1 2                if (specparm1 .lt. 0.125_r8) then
 1273.  1 2                   tau_major1 = speccomb1 * &
 1274.  1 2                        (fac001 * absa(ind1,ig) + &
 1275.  1 2                        fac101 * absa(ind1+1,ig) + &
 1276.  1 2                        fac201 * absa(ind1+2,ig) + &
 1277.  1 2                        fac011 * absa(ind1+9,ig) + &
 1278.  1 2                        fac111 * absa(ind1+10,ig) + &
 1279.  1 2                        fac211 * absa(ind1+11,ig))
 1280.  1 2                else if (specparm1 .gt. 0.875_r8) then
 1281.  1 2                   tau_major1 = speccomb1 * & 
 1282.  1 2                        (fac201 * absa(ind1-1,ig) + &
 1283.  1 2                        fac101 * absa(ind1,ig) + &
 1284.  1 2                        fac001 * absa(ind1+1,ig) + &
 1285.  1 2                        fac211 * absa(ind1+8,ig) + &
 1286.  1 2                        fac111 * absa(ind1+9,ig) + &
 1287.  1 2                        fac011 * absa(ind1+10,ig))
 1288.  1 2                else
 1289.  1 2                   tau_major1 = speccomb1 * &
 1290.  1 2                        (fac001 * absa(ind1,ig) + &
 1291.  1 2                        fac101 * absa(ind1+1,ig) + &
 1292.  1 2                        fac011 * absa(ind1+9,ig) + &
 1293.  1 2                        fac111 * absa(ind1+10,ig))
 1294.  1 2                endif
 1295.  1 2    
 1296.  1 2                taug(lay,ngs4+ig) = tau_major + tau_major1 &
 1297.  1 2                     + tauself + taufor &
 1298.  1 2                     + abso3*colo3(lay) &
 1299.  1 2                     + wx(1,lay) * ccl4(ig)
 1300.  1 2                fracs(lay,ngs4+ig) = fracrefa(ig,jpl) + fpl * &
 1301.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 1302.  1 2-->          enddo
 1303.  1---->       enddo
 1304.         
 1305.         ! Upper atmosphere loop
 1306.  1----<       do lay = laytrop+1, nlayers
 1307.  1      
 1308.  1               speccomb = colo3(lay) + rat_o3co2(lay)*colco2(lay)
 1309.  1               specparm = colo3(lay)/speccomb
 1310.  1               if (specparm .ge. oneminus) specparm = oneminus
 1311.  1               specmult = 4._r8*(specparm)
 1312.  1               js = 1 + int(specmult)
 1313.  1               fs = mod(specmult,1.0_r8)
 1314.  1      
 1315.  1               speccomb1 = colo3(lay) + rat_o3co2_1(lay)*colco2(lay)
 1316.  1               specparm1 = colo3(lay)/speccomb1
 1317.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 1318.  1               specmult1 = 4._r8*(specparm1)
 1319.  1               js1 = 1 + int(specmult1)
 1320.  1               fs1 = mod(specmult1,1.0_r8)
 1321.  1      
 1322.  1               fac000 = (1._r8 - fs) * fac00(lay)
 1323.  1               fac010 = (1._r8 - fs) * fac10(lay)
 1324.  1               fac100 = fs * fac00(lay)
 1325.  1               fac110 = fs * fac10(lay)
 1326.  1               fac001 = (1._r8 - fs1) * fac01(lay)
 1327.  1               fac011 = (1._r8 - fs1) * fac11(lay)
 1328.  1               fac101 = fs1 * fac01(lay)
 1329.  1               fac111 = fs1 * fac11(lay)
 1330.  1      
 1331.  1               speccomb_planck = colo3(lay)+refrat_planck_b*colco2(lay)
 1332.  1               specparm_planck = colo3(lay)/speccomb_planck
 1333.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 1334.  1               specmult_planck = 4._r8*specparm_planck
 1335.  1               jpl= 1 + int(specmult_planck)
 1336.  1               fpl = mod(specmult_planck,1.0_r8)
 1337.  1      
 1338.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(5) + js
 1339.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(5) + js1
 1340.  1               
 1341.  1 2--<          do ig = 1, ng5
 1342.  1 2                taug(lay,ngs4+ig) = speccomb * &
 1343.  1 2                    (fac000 * absb(ind0,ig) + &
 1344.  1 2                    fac100 * absb(ind0+1,ig) + &
 1345.  1 2                    fac010 * absb(ind0+5,ig) + &
 1346.  1 2                    fac110 * absb(ind0+6,ig)) &
 1347.  1 2                    + speccomb1 * &
 1348.  1 2                    (fac001 * absb(ind1,ig) + &
 1349.  1 2                    fac101 * absb(ind1+1,ig) + &
 1350.  1 2                    fac011 * absb(ind1+5,ig) + &
 1351.  1 2                    fac111 * absb(ind1+6,ig))  &
 1352.  1 2                    + wx(1,lay) * ccl4(ig)
 1353.  1 2                fracs(lay,ngs4+ig) = fracrefb(ig,jpl) + fpl * &
 1354.  1 2                    (fracrefb(ig,jpl+1)-fracrefb(ig,jpl))
 1355.  1 2-->          enddo
 1356.  1---->       enddo
 1357.         
 1358.               end subroutine taugb5
 1359.         
 1360.         !----------------------------------------------------------------------------
 1361.               subroutine taugb6(nlayers,ngptlw,laytrop,fracs  ,taug   )
 1362.         !----------------------------------------------------------------------------
 1363.         !
 1364.         !     band 6:  820-980 cm-1 (low key - h2o; low minor - co2)
 1365.         !                           (high key - nothing; high minor - cfc11, cfc12)
 1366.         !----------------------------------------------------------------------------
 1367.         
 1368.         ! ------- Modules -------
 1369.         
 1370.               use parrrtm, only : ng6, ngs5
 1371.               use rrlw_ref, only : chi_mls
 1372.               use rrlw_kg06, only : fracrefa, absa, ka_mco2, &
 1373.                                     selfref, forref, cfc11adj, cfc12
 1374.         
 1375.         ! ------- Declarations -------
 1376.               integer      , intent(in ) :: nlayers
 1377.               integer      , intent(in ) :: ngptlw
 1378.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 1379.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 1380.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 1381.         
 1382.         ! Local 
 1383.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 1384.               real(kind=r8) :: chi_co2, ratco2, adjfac, adjcolco2
 1385.               real(kind=r8) :: tauself, taufor, absco2
 1386.         
 1387.         
 1388.         ! Minor gas mapping level:
 1389.         !     lower - co2, p = 706.2720 mb, t = 294.2 k
 1390.         !     upper - cfc11, cfc12
 1391.         
 1392.         ! Compute the optical depth by interpolating in ln(pressure) and
 1393.         ! temperature. The water vapor self-continuum and foreign continuum
 1394.         ! is interpolated (in temperature) separately.  
 1395.         
 1396.         ! Lower atmosphere loop
 1397.  1----<       do lay = 1, laytrop
 1398.  1      
 1399.  1      ! In atmospheres where the amount of CO2 is too great to be considered
 1400.  1      ! a minor species, adjust the column amount of CO2 by an empirical factor 
 1401.  1      ! to obtain the proper contribution.
 1402.  1               chi_co2 = colco2(lay)/(coldry(lay))
 1403.  1               ratco2 = 1.e20_r8*chi_co2/chi_mls(2,jp(lay)+1)
 1404.  1               if (ratco2 .gt. 3.0_r8) then
 1405.  1                  adjfac = 2.0_r8+(ratco2-2.0_r8)**0.77_r8
 1406.  1                  adjcolco2 = adjfac*chi_mls(2,jp(lay)+1)*coldry(lay)*1.e-20_r8
 1407.  1               else
 1408.  1                  adjcolco2 = colco2(lay)
 1409.  1               endif
 1410.  1      
 1411.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(6) + 1
 1412.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(6) + 1
 1413.  1               inds = indself(lay)
 1414.  1               indf = indfor(lay)
 1415.  1               indm = indminor(lay)
 1416.  1      
 1417.  1 2--<          do ig = 1, ng6
 1418.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 1419.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 1420.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 1421.  1 2                     (forref(indf+1,ig) - forref(indf,ig)))
 1422.  1 2                absco2 =  (ka_mco2(indm,ig) + minorfrac(lay) * &
 1423.  1 2                     (ka_mco2(indm+1,ig) - ka_mco2(indm,ig)))
 1424.  1 2                taug(lay,ngs5+ig) = colh2o(lay) * &
 1425.  1 2                    (fac00(lay) * absa(ind0,ig) + &
 1426.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
 1427.  1 2                     fac01(lay) * absa(ind1,ig) +  &
 1428.  1 2                     fac11(lay) * absa(ind1+1,ig))  &
 1429.  1 2                     + tauself + taufor &
 1430.  1 2                     + adjcolco2 * absco2 &
 1431.  1 2                     + wx(2,lay) * cfc11adj(ig) &
 1432.  1 2                     + wx(3,lay) * cfc12(ig)
 1433.  1 2                fracs(lay,ngs5+ig) = fracrefa(ig)
 1434.  1 2-->          enddo
 1435.  1---->       enddo
 1436.         
 1437.         ! Upper atmosphere loop
 1438.         ! Nothing important goes on above laytrop in this band.
 1439.  i----<       do lay = laytrop+1, nlayers
 1440.  i      
 1441.  i i--<          do ig = 1, ng6
 1442.  i i                taug(lay,ngs5+ig) = 0.0_r8 &
 1443.  i i                     + wx(2,lay) * cfc11adj(ig) &
 1444.  i i                     + wx(3,lay) * cfc12(ig)
 1445.  i i                fracs(lay,ngs5+ig) = fracrefa(ig)
 1446.  i i-->          enddo
 1447.  i---->       enddo
 1448.         
 1449.               end subroutine taugb6
 1450.         
 1451.         !----------------------------------------------------------------------------
 1452.               subroutine taugb7(nlayers,ngptlw,laytrop,fracs  ,taug   )
 1453.         !----------------------------------------------------------------------------
 1454.         !
 1455.         !     band 7:  980-1080 cm-1 (low key - h2o,o3; low minor - co2)
 1456.         !                            (high key - o3; high minor - co2)
 1457.         !----------------------------------------------------------------------------
 1458.         
 1459.         ! ------- Modules -------
 1460.         
 1461.               use parrrtm, only : ng7, ngs6
 1462.               use rrlw_ref, only : chi_mls
 1463.               use rrlw_kg07, only : fracrefa, fracrefb, absa, absb, &
 1464.                                     ka_mco2, kb_mco2, selfref, forref
 1465.         
 1466.         ! ------- Declarations -------
 1467.               integer      , intent(in ) :: nlayers
 1468.               integer      , intent(in ) :: ngptlw
 1469.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 1470.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 1471.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 1472.         
 1473.         ! Local 
 1474.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 1475.               integer :: js, js1, jmco2, jpl
 1476.               real(kind=r8) :: speccomb, specparm, specmult, fs
 1477.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 1478.               real(kind=r8) :: speccomb_mco2, specparm_mco2, specmult_mco2, fmco2
 1479.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 1480.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 1481.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 1482.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 1483.               real(kind=r8) :: tauself, taufor, co2m1, co2m2, absco2
 1484.               real(kind=r8) :: chi_co2, ratco2, adjfac, adjcolco2
 1485.               real(kind=r8) :: refrat_planck_a, refrat_m_a
 1486.               real(kind=r8) :: tau_major, tau_major1
 1487.         
 1488.         
 1489.         ! Minor gas mapping level :
 1490.         !     lower - co2, p = 706.2620 mbar, t= 278.94 k
 1491.         !     upper - co2, p = 12.9350 mbar, t = 234.01 k
 1492.         
 1493.         ! Calculate reference ratio to be used in calculation of Planck
 1494.         ! fraction in lower atmosphere.
 1495.         
 1496.         ! P = 706.2620 mb
 1497.               refrat_planck_a = chi_mls(1,3)/chi_mls(3,3)
 1498.         
 1499.         ! P = 706.2720 mb
 1500.               refrat_m_a = chi_mls(1,3)/chi_mls(3,3)
 1501.         
 1502.         ! Compute the optical depth by interpolating in ln(pressure), 
 1503.         ! temperature, and appropriate species.  Below laytrop, the water
 1504.         ! vapor self-continuum and foreign continuum is interpolated 
 1505.         ! (in temperature) separately. 
 1506.         
 1507.         ! Lower atmosphere loop
 1508.  1----<       do lay = 1, laytrop
 1509.  1      
 1510.  1               speccomb = colh2o(lay) + rat_h2oo3(lay)*colo3(lay)
 1511.  1               specparm = colh2o(lay)/speccomb
 1512.  1               if (specparm .ge. oneminus) specparm = oneminus
 1513.  1               specmult = 8._r8*(specparm)
 1514.  1               js = 1 + int(specmult)
 1515.  1               fs = mod(specmult,1.0_r8)
 1516.  1      
 1517.  1               speccomb1 = colh2o(lay) + rat_h2oo3_1(lay)*colo3(lay)
 1518.  1               specparm1 = colh2o(lay)/speccomb1
 1519.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 1520.  1               specmult1 = 8._r8*(specparm1)
 1521.  1               js1 = 1 + int(specmult1)
 1522.  1               fs1 = mod(specmult1,1.0_r8)
 1523.  1      
 1524.  1               speccomb_mco2 = colh2o(lay) + refrat_m_a*colo3(lay)
 1525.  1               specparm_mco2 = colh2o(lay)/speccomb_mco2
 1526.  1               if (specparm_mco2 .ge. oneminus) specparm_mco2 = oneminus
 1527.  1               specmult_mco2 = 8._r8*specparm_mco2
 1528.  1      
 1529.  1               jmco2 = MAX(1 + int(specmult_mco2),1)
 1530.  1               fmco2 = mod(specmult_mco2,1.0_r8)
 1531.  1      
 1532.  1      !  In atmospheres where the amount of CO2 is too great to be considered
 1533.  1      !  a minor species, adjust the column amount of CO2 by an empirical factor 
 1534.  1      !  to obtain the proper contribution.
 1535.  1               chi_co2 = colco2(lay)/(coldry(lay))
 1536.  1               ratco2 = 1.e20*chi_co2/chi_mls(2,jp(lay)+1)
 1537.  1               if (ratco2 .gt. 3.0_r8) then
 1538.  1                  adjfac = 3.0_r8+(ratco2-3.0_r8)**0.79_r8
 1539.  1                  adjcolco2 = adjfac*chi_mls(2,jp(lay)+1)*coldry(lay)*1.e-20_r8
 1540.  1               else
 1541.  1                  adjcolco2 = colco2(lay)
 1542.  1               endif
 1543.  1      
 1544.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colo3(lay)
 1545.  1               specparm_planck = colh2o(lay)/speccomb_planck
 1546.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 1547.  1               specmult_planck = 8._r8*specparm_planck
 1548.  1               jpl = MAX(1 + int(specmult_planck),1)
 1549.  1               fpl = mod(specmult_planck,1.0_r8)
 1550.  1      
 1551.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(7) + js
 1552.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(7) + js1
 1553.  1               inds = indself(lay)
 1554.  1               indf = indfor(lay)
 1555.  1               indm = indminor(lay)
 1556.  1      
 1557.  1               if (specparm .lt. 0.125_r8) then
 1558.  1                  p = fs - 1
 1559.  1                  p4 = p**4
 1560.  1                  fk0 = p4
 1561.  1                  fk1 = 1 - p - 2.0_r8*p4
 1562.  1                  fk2 = p + p4
 1563.  1                  fac000 = fk0*fac00(lay)
 1564.  1                  fac100 = fk1*fac00(lay)
 1565.  1                  fac200 = fk2*fac00(lay)
 1566.  1                  fac010 = fk0*fac10(lay)
 1567.  1                  fac110 = fk1*fac10(lay)
 1568.  1                  fac210 = fk2*fac10(lay)
 1569.  1               else if (specparm .gt. 0.875_r8) then
 1570.  1                  p = -fs 
 1571.  1                  p4 = p**4
 1572.  1                  fk0 = p4
 1573.  1                  fk1 = 1 - p - 2.0_r8*p4
 1574.  1                  fk2 = p + p4
 1575.  1                  fac000 = fk0*fac00(lay)
 1576.  1                  fac100 = fk1*fac00(lay)
 1577.  1                  fac200 = fk2*fac00(lay)
 1578.  1                  fac010 = fk0*fac10(lay)
 1579.  1                  fac110 = fk1*fac10(lay)
 1580.  1                  fac210 = fk2*fac10(lay)
 1581.  1               else
 1582.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 1583.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 1584.  1                  fac100 = fs * fac00(lay)
 1585.  1                  fac110 = fs * fac10(lay)
 1586.  1               endif
 1587.  1               if (specparm .lt. 0.125_r8) then
 1588.  1                  p = fs1 - 1
 1589.  1                  p4 = p**4
 1590.  1                  fk0 = p4
 1591.  1                  fk1 = 1 - p - 2.0_r8*p4
 1592.  1                  fk2 = p + p4
 1593.  1                  fac001 = fk0*fac01(lay)
 1594.  1                  fac101 = fk1*fac01(lay)
 1595.  1                  fac201 = fk2*fac01(lay)
 1596.  1                  fac011 = fk0*fac11(lay)
 1597.  1                  fac111 = fk1*fac11(lay)
 1598.  1                  fac211 = fk2*fac11(lay)
 1599.  1               else if (specparm1 .gt. 0.875_r8) then
 1600.  1                  p = -fs1 
 1601.  1                  p4 = p**4
 1602.  1                  fk0 = p4
 1603.  1                  fk1 = 1 - p - 2.0_r8*p4
 1604.  1                  fk2 = p + p4
 1605.  1                  fac001 = fk0*fac01(lay)
 1606.  1                  fac101 = fk1*fac01(lay)
 1607.  1                  fac201 = fk2*fac01(lay)
 1608.  1                  fac011 = fk0*fac11(lay)
 1609.  1                  fac111 = fk1*fac11(lay)
 1610.  1                  fac211 = fk2*fac11(lay)
 1611.  1               else
 1612.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 1613.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 1614.  1                  fac101 = fs1 * fac01(lay)
 1615.  1                  fac111 = fs1 * fac11(lay)
 1616.  1               endif
 1617.  1      
 1618.  1 2--<          do ig = 1, ng7
 1619.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 1620.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 1621.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 1622.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 1623.  1 2                co2m1 = ka_mco2(jmco2,indm,ig) + fmco2 * &
 1624.  1 2                     (ka_mco2(jmco2+1,indm,ig) - ka_mco2(jmco2,indm,ig))
 1625.  1 2                co2m2 = ka_mco2(jmco2,indm+1,ig) + fmco2 * &
 1626.  1 2                     (ka_mco2(jmco2+1,indm+1,ig) - ka_mco2(jmco2,indm+1,ig))
 1627.  1 2                absco2 = co2m1 + minorfrac(lay) * (co2m2 - co2m1)
 1628.  1 2    
 1629.  1 2                if (specparm .lt. 0.125_r8) then
 1630.  1 2                   tau_major = speccomb * &
 1631.  1 2                        (fac000 * absa(ind0,ig) + &
 1632.  1 2                        fac100 * absa(ind0+1,ig) + &
 1633.  1 2                        fac200 * absa(ind0+2,ig) + &
 1634.  1 2                        fac010 * absa(ind0+9,ig) + &
 1635.  1 2                        fac110 * absa(ind0+10,ig) + &
 1636.  1 2                        fac210 * absa(ind0+11,ig))
 1637.  1 2                else if (specparm .gt. 0.875_r8) then
 1638.  1 2                   tau_major = speccomb * &
 1639.  1 2                        (fac200 * absa(ind0-1,ig) + &
 1640.  1 2                        fac100 * absa(ind0,ig) + &
 1641.  1 2                        fac000 * absa(ind0+1,ig) + &
 1642.  1 2                        fac210 * absa(ind0+8,ig) + &
 1643.  1 2                        fac110 * absa(ind0+9,ig) + &
 1644.  1 2                        fac010 * absa(ind0+10,ig))
 1645.  1 2                else
 1646.  1 2                   tau_major = speccomb * &
 1647.  1 2                        (fac000 * absa(ind0,ig) + &
 1648.  1 2                        fac100 * absa(ind0+1,ig) + &
 1649.  1 2                        fac010 * absa(ind0+9,ig) + &
 1650.  1 2                        fac110 * absa(ind0+10,ig))
 1651.  1 2                endif
 1652.  1 2    
 1653.  1 2                if (specparm1 .lt. 0.125_r8) then
 1654.  1 2                   tau_major1 = speccomb1 * &
 1655.  1 2                        (fac001 * absa(ind1,ig) + &
 1656.  1 2                        fac101 * absa(ind1+1,ig) + &
 1657.  1 2                        fac201 * absa(ind1+2,ig) + &
 1658.  1 2                        fac011 * absa(ind1+9,ig) + &
 1659.  1 2                        fac111 * absa(ind1+10,ig) + &
 1660.  1 2                        fac211 * absa(ind1+11,ig))
 1661.  1 2                else if (specparm1 .gt. 0.875_r8) then
 1662.  1 2                   tau_major1 = speccomb1 * &
 1663.  1 2                        (fac201 * absa(ind1-1,ig) + &
 1664.  1 2                        fac101 * absa(ind1,ig) + &
 1665.  1 2                        fac001 * absa(ind1+1,ig) + &
 1666.  1 2                        fac211 * absa(ind1+8,ig) + &
 1667.  1 2                        fac111 * absa(ind1+9,ig) + &
 1668.  1 2                        fac011 * absa(ind1+10,ig))
 1669.  1 2                else
 1670.  1 2                   tau_major1 = speccomb1 * &
 1671.  1 2                        (fac001 * absa(ind1,ig) +  &
 1672.  1 2                        fac101 * absa(ind1+1,ig) + &
 1673.  1 2                        fac011 * absa(ind1+9,ig) + &
 1674.  1 2                        fac111 * absa(ind1+10,ig))
 1675.  1 2                endif
 1676.  1 2    
 1677.  1 2                taug(lay,ngs6+ig) = tau_major + tau_major1 &
 1678.  1 2                     + tauself + taufor &
 1679.  1 2                     + adjcolco2*absco2
 1680.  1 2                fracs(lay,ngs6+ig) = fracrefa(ig,jpl) + fpl * &
 1681.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 1682.  1 2-->          enddo
 1683.  1---->       enddo
 1684.         
 1685.         ! Upper atmosphere loop
 1686.  1----<       do lay = laytrop+1, nlayers
 1687.  1      
 1688.  1      !  In atmospheres where the amount of CO2 is too great to be considered
 1689.  1      !  a minor species, adjust the column amount of CO2 by an empirical factor 
 1690.  1      !  to obtain the proper contribution.
 1691.  1               chi_co2 = colco2(lay)/(coldry(lay))
 1692.  1               ratco2 = 1.e20*chi_co2/chi_mls(2,jp(lay)+1)
 1693.  1               if (ratco2 .gt. 3.0_r8) then
 1694.  1                  adjfac = 2.0_r8+(ratco2-2.0_r8)**0.79_r8
 1695.  1                  adjcolco2 = adjfac*chi_mls(2,jp(lay)+1)*coldry(lay)*1.e-20_r8
 1696.  1               else
 1697.  1                  adjcolco2 = colco2(lay)
 1698.  1               endif
 1699.  1      
 1700.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(7) + 1
 1701.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(7) + 1
 1702.  1               indm = indminor(lay)
 1703.  1      
 1704.  1 2--<          do ig = 1, ng7
 1705.  1 2                absco2 = kb_mco2(indm,ig) + minorfrac(lay) * &
 1706.  1 2                     (kb_mco2(indm+1,ig) - kb_mco2(indm,ig))
 1707.  1 2                taug(lay,ngs6+ig) = colo3(lay) * &
 1708.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 1709.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 1710.  1 2                     fac01(lay) * absb(ind1,ig) + &
 1711.  1 2                     fac11(lay) * absb(ind1+1,ig)) &
 1712.  1 2                     + adjcolco2 * absco2
 1713.  1 2                fracs(lay,ngs6+ig) = fracrefb(ig)
 1714.  1 2-->          enddo
 1715.  1      
 1716.  1      ! Empirical modification to code to improve stratospheric cooling rates
 1717.  1      ! for o3.  Revised to apply weighting for g-point reduction in this band.
 1718.  1      
 1719.  1               taug(lay,ngs6+6)=taug(lay,ngs6+6)*0.92_r8
 1720.  1               taug(lay,ngs6+7)=taug(lay,ngs6+7)*0.88_r8
 1721.  1               taug(lay,ngs6+8)=taug(lay,ngs6+8)*1.07_r8
 1722.  1               taug(lay,ngs6+9)=taug(lay,ngs6+9)*1.1_r8
 1723.  1               taug(lay,ngs6+10)=taug(lay,ngs6+10)*0.99_r8
 1724.  1               taug(lay,ngs6+11)=taug(lay,ngs6+11)*0.855_r8
 1725.  1      
 1726.  1---->       enddo
 1727.         
 1728.               end subroutine taugb7
 1729.         
 1730.         !----------------------------------------------------------------------------
 1731.               subroutine taugb8(nlayers,ngptlw,laytrop,fracs  ,taug   )
 1732.         !----------------------------------------------------------------------------
 1733.         !
 1734.         !     band 8:  1080-1180 cm-1 (low key - h2o; low minor - co2,o3,n2o)
 1735.         !                             (high key - o3; high minor - co2, n2o)
 1736.         !----------------------------------------------------------------------------
 1737.         
 1738.         ! ------- Modules -------
 1739.         
 1740.               use parrrtm, only : ng8, ngs7
 1741.               use rrlw_ref, only : chi_mls
 1742.               use rrlw_kg08, only : fracrefa, fracrefb, absa, absb, &
 1743.                                     ka_mco2, ka_mn2o, ka_mo3, kb_mco2, kb_mn2o, &
 1744.                                     selfref, forref, cfc12, cfc22adj
 1745.         
 1746.         ! ------- Declarations -------
 1747.               integer      , intent(in ) :: nlayers
 1748.               integer      , intent(in ) :: ngptlw
 1749.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 1750.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 1751.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 1752.         
 1753.         ! Local 
 1754.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 1755.               real(kind=r8) :: tauself, taufor, absco2, abso3, absn2o
 1756.               real(kind=r8) :: chi_co2, ratco2, adjfac, adjcolco2
 1757.         
 1758.         
 1759.         ! Minor gas mapping level:
 1760.         !     lower - co2, p = 1053.63 mb, t = 294.2 k
 1761.         !     lower - o3,  p = 317.348 mb, t = 240.77 k
 1762.         !     lower - n2o, p = 706.2720 mb, t= 278.94 k
 1763.         !     lower - cfc12,cfc11
 1764.         !     upper - co2, p = 35.1632 mb, t = 223.28 k
 1765.         !     upper - n2o, p = 8.716e-2 mb, t = 226.03 k
 1766.         
 1767.         ! Compute the optical depth by interpolating in ln(pressure) and 
 1768.         ! temperature, and appropriate species.  Below laytrop, the water vapor 
 1769.         ! self-continuum and foreign continuum is interpolated (in temperature) 
 1770.         ! separately.
 1771.         
 1772.         ! Lower atmosphere loop
 1773.  1----<       do lay = 1, laytrop
 1774.  1      
 1775.  1      !  In atmospheres where the amount of CO2 is too great to be considered
 1776.  1      !  a minor species, adjust the column amount of CO2 by an empirical factor 
 1777.  1      !  to obtain the proper contribution.
 1778.  1               chi_co2 = colco2(lay)/(coldry(lay))
 1779.  1               ratco2 = 1.e20_r8*chi_co2/chi_mls(2,jp(lay)+1)
 1780.  1               if (ratco2 .gt. 3.0_r8) then
 1781.  1                  adjfac = 2.0_r8+(ratco2-2.0_r8)**0.65_r8
 1782.  1                  adjcolco2 = adjfac*chi_mls(2,jp(lay)+1)*coldry(lay)*1.e-20_r8
 1783.  1               else
 1784.  1                  adjcolco2 = colco2(lay)
 1785.  1               endif
 1786.  1      
 1787.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(8) + 1
 1788.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(8) + 1
 1789.  1               inds = indself(lay)
 1790.  1               indf = indfor(lay)
 1791.  1               indm = indminor(lay)
 1792.  1      
 1793.  1 2--<          do ig = 1, ng8
 1794.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 1795.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 1796.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 1797.  1 2                     (forref(indf+1,ig) - forref(indf,ig)))
 1798.  1 2                absco2 =  (ka_mco2(indm,ig) + minorfrac(lay) * &
 1799.  1 2                     (ka_mco2(indm+1,ig) - ka_mco2(indm,ig)))
 1800.  1 2                abso3 =  (ka_mo3(indm,ig) + minorfrac(lay) * &
 1801.  1 2                     (ka_mo3(indm+1,ig) - ka_mo3(indm,ig)))
 1802.  1 2                absn2o =  (ka_mn2o(indm,ig) + minorfrac(lay) * &
 1803.  1 2                     (ka_mn2o(indm+1,ig) - ka_mn2o(indm,ig)))
 1804.  1 2                taug(lay,ngs7+ig) = colh2o(lay) * &
 1805.  1 2                     (fac00(lay) * absa(ind0,ig) + &
 1806.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
 1807.  1 2                     fac01(lay) * absa(ind1,ig) +  &
 1808.  1 2                     fac11(lay) * absa(ind1+1,ig)) &
 1809.  1 2                     + tauself + taufor &
 1810.  1 2                     + adjcolco2*absco2 &
 1811.  1 2                     + colo3(lay) * abso3 &
 1812.  1 2                     + coln2o(lay) * absn2o &
 1813.  1 2                     + wx(3,lay) * cfc12(ig) &
 1814.  1 2                     + wx(4,lay) * cfc22adj(ig)
 1815.  1 2                fracs(lay,ngs7+ig) = fracrefa(ig)
 1816.  1 2-->          enddo
 1817.  1---->       enddo
 1818.         
 1819.         ! Upper atmosphere loop
 1820.  1----<       do lay = laytrop+1, nlayers
 1821.  1      
 1822.  1      !  In atmospheres where the amount of CO2 is too great to be considered
 1823.  1      !  a minor species, adjust the column amount of CO2 by an empirical factor 
 1824.  1      !  to obtain the proper contribution.
 1825.  1               chi_co2 = colco2(lay)/coldry(lay)
 1826.  1               ratco2 = 1.e20_r8*chi_co2/chi_mls(2,jp(lay)+1)
 1827.  1               if (ratco2 .gt. 3.0_r8) then
 1828.  1                  adjfac = 2.0_r8+(ratco2-2.0_r8)**0.65_r8
 1829.  1                  adjcolco2 = adjfac*chi_mls(2,jp(lay)+1) * coldry(lay)*1.e-20_r8
 1830.  1               else
 1831.  1                  adjcolco2 = colco2(lay)
 1832.  1               endif
 1833.  1      
 1834.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(8) + 1
 1835.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(8) + 1
 1836.  1               indm = indminor(lay)
 1837.  1      
 1838.  1 2--<          do ig = 1, ng8
 1839.  1 2                absco2 =  (kb_mco2(indm,ig) + minorfrac(lay) * &
 1840.  1 2                     (kb_mco2(indm+1,ig) - kb_mco2(indm,ig)))
 1841.  1 2                absn2o =  (kb_mn2o(indm,ig) + minorfrac(lay) * &
 1842.  1 2                     (kb_mn2o(indm+1,ig) - kb_mn2o(indm,ig)))
 1843.  1 2                taug(lay,ngs7+ig) = colo3(lay) * &
 1844.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 1845.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 1846.  1 2                     fac01(lay) * absb(ind1,ig) + &
 1847.  1 2                     fac11(lay) * absb(ind1+1,ig)) &
 1848.  1 2                     + adjcolco2*absco2 &
 1849.  1 2                     + coln2o(lay)*absn2o & 
 1850.  1 2                     + wx(3,lay) * cfc12(ig) &
 1851.  1 2                     + wx(4,lay) * cfc22adj(ig)
 1852.  1 2                fracs(lay,ngs7+ig) = fracrefb(ig)
 1853.  1 2-->          enddo
 1854.  1---->       enddo
 1855.         
 1856.               end subroutine taugb8
 1857.         
 1858.         !----------------------------------------------------------------------------
 1859.               subroutine taugb9(nlayers,ngptlw,laytrop,fracs  ,taug   )
 1860.         !----------------------------------------------------------------------------
 1861.         !
 1862.         !     band 9:  1180-1390 cm-1 (low key - h2o,ch4; low minor - n2o)
 1863.         !                             (high key - ch4; high minor - n2o)
 1864.         !----------------------------------------------------------------------------
 1865.         
 1866.         ! ------- Modules -------
 1867.         
 1868.               use parrrtm, only : ng9, ngs8
 1869.               use rrlw_ref, only : chi_mls
 1870.               use rrlw_kg09, only : fracrefa, fracrefb, absa, absb, &
 1871.                                     ka_mn2o, kb_mn2o, selfref, forref
 1872.         
 1873.         ! ------- Declarations -------
 1874.               integer      , intent(in ) :: nlayers
 1875.               integer      , intent(in ) :: ngptlw
 1876.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 1877.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 1878.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 1879.         
 1880.         ! Local 
 1881.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 1882.               integer :: js, js1, jmn2o, jpl
 1883.               real(kind=r8) :: speccomb, specparm, specmult, fs
 1884.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 1885.               real(kind=r8) :: speccomb_mn2o, specparm_mn2o, specmult_mn2o, fmn2o
 1886.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 1887.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 1888.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 1889.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 1890.               real(kind=r8) :: tauself, taufor, n2om1, n2om2, absn2o
 1891.               real(kind=r8) :: chi_n2o, ratn2o, adjfac, adjcoln2o
 1892.               real(kind=r8) :: refrat_planck_a, refrat_m_a
 1893.               real(kind=r8) :: tau_major, tau_major1
 1894.         
 1895.         
 1896.         ! Minor gas mapping level :
 1897.         !     lower - n2o, p = 706.272 mbar, t = 278.94 k
 1898.         !     upper - n2o, p = 95.58 mbar, t = 215.7 k
 1899.         
 1900.         ! Calculate reference ratio to be used in calculation of Planck
 1901.         ! fraction in lower/upper atmosphere.
 1902.         
 1903.         ! P = 212 mb
 1904.               refrat_planck_a = chi_mls(1,9)/chi_mls(6,9)
 1905.         
 1906.         ! P = 706.272 mb 
 1907.               refrat_m_a = chi_mls(1,3)/chi_mls(6,3)
 1908.         
 1909.         ! Compute the optical depth by interpolating in ln(pressure), 
 1910.         ! temperature, and appropriate species.  Below laytrop, the water
 1911.         ! vapor self-continuum and foreign continuum is interpolated 
 1912.         ! (in temperature) separately.  
 1913.         
 1914.         ! Lower atmosphere loop
 1915.  1----<       do lay = 1, laytrop
 1916.  1      
 1917.  1               speccomb = colh2o(lay) + rat_h2och4(lay)*colch4(lay)
 1918.  1               specparm = colh2o(lay)/speccomb
 1919.  1               if (specparm .ge. oneminus) specparm = oneminus
 1920.  1               specmult = 8._r8*(specparm)
 1921.  1               js = 1 + int(specmult)
 1922.  1               fs = mod(specmult,1.0_r8)
 1923.  1      
 1924.  1               speccomb1 = colh2o(lay) + rat_h2och4_1(lay)*colch4(lay)
 1925.  1               specparm1 = colh2o(lay)/speccomb1
 1926.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 1927.  1               specmult1 = 8._r8*(specparm1)
 1928.  1               js1 = 1 + int(specmult1)
 1929.  1               fs1 = mod(specmult1,1.0_r8)
 1930.  1      
 1931.  1               speccomb_mn2o = colh2o(lay) + refrat_m_a*colch4(lay)
 1932.  1               specparm_mn2o = colh2o(lay)/speccomb_mn2o
 1933.  1               if (specparm_mn2o .ge. oneminus) specparm_mn2o = oneminus
 1934.  1               specmult_mn2o = 8._r8*specparm_mn2o
 1935.  1               jmn2o = 1 + int(specmult_mn2o)
 1936.  1               fmn2o = mod(specmult_mn2o,1.0_r8)
 1937.  1      
 1938.  1      !  In atmospheres where the amount of N2O is too great to be considered
 1939.  1      !  a minor species, adjust the column amount of N2O by an empirical factor 
 1940.  1      !  to obtain the proper contribution.
 1941.  1               chi_n2o = coln2o(lay)/(coldry(lay))
 1942.  1               ratn2o = 1.e20_r8*chi_n2o/chi_mls(4,jp(lay)+1)
 1943.  1               if (ratn2o .gt. 1.5_r8) then
 1944.  1                  adjfac = 0.5_r8+(ratn2o-0.5_r8)**0.65_r8
 1945.  1                  adjcoln2o = adjfac*chi_mls(4,jp(lay)+1)*coldry(lay)*1.e-20_r8
 1946.  1               else
 1947.  1                  adjcoln2o = coln2o(lay)
 1948.  1               endif
 1949.  1      
 1950.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colch4(lay)
 1951.  1               specparm_planck = colh2o(lay)/speccomb_planck
 1952.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 1953.  1               specmult_planck = 8._r8*specparm_planck
 1954.  1               jpl= 1 + int(specmult_planck)
 1955.  1               fpl = mod(specmult_planck,1.0_r8)
 1956.  1      
 1957.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(9) + js
 1958.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(9) + js1
 1959.  1               inds = indself(lay)
 1960.  1               indf = indfor(lay)
 1961.  1               indm = indminor(lay)
 1962.  1      
 1963.  1               if (specparm .lt. 0.125_r8) then
 1964.  1                  p = fs - 1
 1965.  1                  p4 = p**4
 1966.  1                  fk0 = p4
 1967.  1                  fk1 = 1 - p - 2.0_r8*p4
 1968.  1                  fk2 = p + p4
 1969.  1                  fac000 = fk0*fac00(lay)
 1970.  1                  fac100 = fk1*fac00(lay)
 1971.  1                  fac200 = fk2*fac00(lay)
 1972.  1                  fac010 = fk0*fac10(lay)
 1973.  1                  fac110 = fk1*fac10(lay)
 1974.  1                  fac210 = fk2*fac10(lay)
 1975.  1               else if (specparm .gt. 0.875_r8) then
 1976.  1                  p = -fs 
 1977.  1                  p4 = p**4
 1978.  1                  fk0 = p4
 1979.  1                  fk1 = 1 - p - 2.0_r8*p4
 1980.  1                  fk2 = p + p4
 1981.  1                  fac000 = fk0*fac00(lay)
 1982.  1                  fac100 = fk1*fac00(lay)
 1983.  1                  fac200 = fk2*fac00(lay)
 1984.  1                  fac010 = fk0*fac10(lay)
 1985.  1                  fac110 = fk1*fac10(lay)
 1986.  1                  fac210 = fk2*fac10(lay)
 1987.  1               else
 1988.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 1989.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 1990.  1                  fac100 = fs * fac00(lay)
 1991.  1                  fac110 = fs * fac10(lay)
 1992.  1               endif
 1993.  1      
 1994.  1               if (specparm1 .lt. 0.125_r8) then
 1995.  1                  p = fs1 - 1
 1996.  1                  p4 = p**4
 1997.  1                  fk0 = p4
 1998.  1                  fk1 = 1 - p - 2.0_r8*p4
 1999.  1                  fk2 = p + p4
 2000.  1                  fac001 = fk0*fac01(lay)
 2001.  1                  fac101 = fk1*fac01(lay)
 2002.  1                  fac201 = fk2*fac01(lay)
 2003.  1                  fac011 = fk0*fac11(lay)
 2004.  1                  fac111 = fk1*fac11(lay)
 2005.  1                  fac211 = fk2*fac11(lay)
 2006.  1               else if (specparm1 .gt. 0.875_r8) then
 2007.  1                  p = -fs1 
 2008.  1                  p4 = p**4
 2009.  1                  fk0 = p4
 2010.  1                  fk1 = 1 - p - 2.0_r8*p4
 2011.  1                  fk2 = p + p4
 2012.  1                  fac001 = fk0*fac01(lay)
 2013.  1                  fac101 = fk1*fac01(lay)
 2014.  1                  fac201 = fk2*fac01(lay)
 2015.  1                  fac011 = fk0*fac11(lay)
 2016.  1                  fac111 = fk1*fac11(lay)
 2017.  1                  fac211 = fk2*fac11(lay)
 2018.  1               else
 2019.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 2020.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 2021.  1                  fac101 = fs1 * fac01(lay)
 2022.  1                  fac111 = fs1 * fac11(lay)
 2023.  1               endif
 2024.  1      
 2025.  1 2--<          do ig = 1, ng9
 2026.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 2027.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2028.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2029.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2030.  1 2                n2om1 = ka_mn2o(jmn2o,indm,ig) + fmn2o * &
 2031.  1 2                     (ka_mn2o(jmn2o+1,indm,ig) - ka_mn2o(jmn2o,indm,ig))
 2032.  1 2                n2om2 = ka_mn2o(jmn2o,indm+1,ig) + fmn2o * &
 2033.  1 2                     (ka_mn2o(jmn2o+1,indm+1,ig) - ka_mn2o(jmn2o,indm+1,ig))
 2034.  1 2                absn2o = n2om1 + minorfrac(lay) * (n2om2 - n2om1)
 2035.  1 2    
 2036.  1 2                if (specparm .lt. 0.125_r8) then
 2037.  1 2                   tau_major = speccomb * &
 2038.  1 2                        (fac000 * absa(ind0,ig) + &
 2039.  1 2                        fac100 * absa(ind0+1,ig) + &
 2040.  1 2                        fac200 * absa(ind0+2,ig) + &
 2041.  1 2                        fac010 * absa(ind0+9,ig) + &
 2042.  1 2                        fac110 * absa(ind0+10,ig) + &
 2043.  1 2                        fac210 * absa(ind0+11,ig))
 2044.  1 2                else if (specparm .gt. 0.875_r8) then
 2045.  1 2                   tau_major = speccomb * &
 2046.  1 2                        (fac200 * absa(ind0-1,ig) + &
 2047.  1 2                        fac100 * absa(ind0,ig) + &
 2048.  1 2                        fac000 * absa(ind0+1,ig) + &
 2049.  1 2                        fac210 * absa(ind0+8,ig) + &
 2050.  1 2                        fac110 * absa(ind0+9,ig) + &
 2051.  1 2                        fac010 * absa(ind0+10,ig))
 2052.  1 2                else
 2053.  1 2                   tau_major = speccomb * &
 2054.  1 2                        (fac000 * absa(ind0,ig) + &
 2055.  1 2                        fac100 * absa(ind0+1,ig) + &
 2056.  1 2                        fac010 * absa(ind0+9,ig) + &
 2057.  1 2                        fac110 * absa(ind0+10,ig))
 2058.  1 2                endif
 2059.  1 2    
 2060.  1 2                if (specparm1 .lt. 0.125_r8) then
 2061.  1 2                   tau_major1 = speccomb1 * &
 2062.  1 2                        (fac001 * absa(ind1,ig) + & 
 2063.  1 2                        fac101 * absa(ind1+1,ig) + &
 2064.  1 2                        fac201 * absa(ind1+2,ig) + &
 2065.  1 2                        fac011 * absa(ind1+9,ig) + &
 2066.  1 2                        fac111 * absa(ind1+10,ig) + &
 2067.  1 2                        fac211 * absa(ind1+11,ig))
 2068.  1 2                else if (specparm1 .gt. 0.875_r8) then
 2069.  1 2                   tau_major1 = speccomb1 * &
 2070.  1 2                        (fac201 * absa(ind1-1,ig) + &
 2071.  1 2                        fac101 * absa(ind1,ig) + &
 2072.  1 2                        fac001 * absa(ind1+1,ig) + &
 2073.  1 2                        fac211 * absa(ind1+8,ig) + &
 2074.  1 2                        fac111 * absa(ind1+9,ig) + &
 2075.  1 2                        fac011 * absa(ind1+10,ig))
 2076.  1 2                else
 2077.  1 2                   tau_major1 = speccomb1 * &
 2078.  1 2                        (fac001 * absa(ind1,ig) + &
 2079.  1 2                        fac101 * absa(ind1+1,ig) + &
 2080.  1 2                        fac011 * absa(ind1+9,ig) + &
 2081.  1 2                        fac111 * absa(ind1+10,ig))
 2082.  1 2                endif
 2083.  1 2    
 2084.  1 2                taug(lay,ngs8+ig) = tau_major + tau_major1 &
 2085.  1 2                     + tauself + taufor &
 2086.  1 2                     + adjcoln2o*absn2o
 2087.  1 2                fracs(lay,ngs8+ig) = fracrefa(ig,jpl) + fpl * &
 2088.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 2089.  1 2-->          enddo
 2090.  1---->       enddo
 2091.         
 2092.         ! Upper atmosphere loop
 2093.  1----<       do lay = laytrop+1, nlayers
 2094.  1      
 2095.  1      !  In atmospheres where the amount of N2O is too great to be considered
 2096.  1      !  a minor species, adjust the column amount of N2O by an empirical factor 
 2097.  1      !  to obtain the proper contribution.
 2098.  1               chi_n2o = coln2o(lay)/(coldry(lay))
 2099.  1               ratn2o = 1.e20_r8*chi_n2o/chi_mls(4,jp(lay)+1)
 2100.  1               if (ratn2o .gt. 1.5_r8) then
 2101.  1                  adjfac = 0.5_r8+(ratn2o-0.5_r8)**0.65_r8
 2102.  1                  adjcoln2o = adjfac*chi_mls(4,jp(lay)+1)*coldry(lay)*1.e-20_r8
 2103.  1               else
 2104.  1                  adjcoln2o = coln2o(lay)
 2105.  1               endif
 2106.  1      
 2107.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(9) + 1
 2108.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(9) + 1
 2109.  1               indm = indminor(lay)
 2110.  1      
 2111.  1 2--<          do ig = 1, ng9
 2112.  1 2                absn2o = kb_mn2o(indm,ig) + minorfrac(lay) * &
 2113.  1 2                    (kb_mn2o(indm+1,ig) - kb_mn2o(indm,ig))
 2114.  1 2                taug(lay,ngs8+ig) = colch4(lay) * &
 2115.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 2116.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 2117.  1 2                     fac01(lay) * absb(ind1,ig) +  &
 2118.  1 2                     fac11(lay) * absb(ind1+1,ig)) &
 2119.  1 2                     + adjcoln2o*absn2o
 2120.  1 2                fracs(lay,ngs8+ig) = fracrefb(ig)
 2121.  1 2-->          enddo
 2122.  1---->       enddo
 2123.         
 2124.               end subroutine taugb9
 2125.         
 2126.         !----------------------------------------------------------------------------
 2127.               subroutine taugb10(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2128.         !----------------------------------------------------------------------------
 2129.         !
 2130.         !     band 10:  1390-1480 cm-1 (low key - h2o; high key - h2o)
 2131.         !----------------------------------------------------------------------------
 2132.         
 2133.         ! ------- Modules -------
 2134.         
 2135.               use parrrtm, only : ng10, ngs9
 2136.               use rrlw_kg10, only : fracrefa, fracrefb, absa, absb, &
 2137.                                     selfref, forref
 2138.         
 2139.         ! ------- Declarations -------
 2140.               integer      , intent(in ) :: nlayers
 2141.               integer      , intent(in ) :: ngptlw
 2142.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2143.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2144.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2145.         
 2146.         ! Local 
 2147.               integer :: lay, ind0, ind1, inds, indf, ig
 2148.               real(kind=r8) :: tauself, taufor
 2149.         
 2150.         
 2151.         ! Compute the optical depth by interpolating in ln(pressure) and 
 2152.         ! temperature.  Below laytrop, the water vapor self-continuum and
 2153.         ! foreign continuum is interpolated (in temperature) separately.
 2154.         
 2155.         ! Lower atmosphere loop
 2156.  1----<       do lay = 1, laytrop
 2157.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(10) + 1
 2158.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(10) + 1
 2159.  1               inds = indself(lay)
 2160.  1               indf = indfor(lay)
 2161.  1      
 2162.  1 2--<          do ig = 1, ng10
 2163.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 2164.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2165.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2166.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2167.  1 2                taug(lay,ngs9+ig) = colh2o(lay) * &
 2168.  1 2                     (fac00(lay) * absa(ind0,ig) + &
 2169.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
 2170.  1 2                     fac01(lay) * absa(ind1,ig) + &
 2171.  1 2                     fac11(lay) * absa(ind1+1,ig))  &
 2172.  1 2                     + tauself + taufor
 2173.  1 2                fracs(lay,ngs9+ig) = fracrefa(ig)
 2174.  1 2-->          enddo
 2175.  1---->       enddo
 2176.         
 2177.         ! Upper atmosphere loop
 2178.  1----<       do lay = laytrop+1, nlayers
 2179.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(10) + 1
 2180.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(10) + 1
 2181.  1               indf = indfor(lay)
 2182.  1      
 2183.  1 2--<          do ig = 1, ng10
 2184.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2185.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2186.  1 2                taug(lay,ngs9+ig) = colh2o(lay) * &
 2187.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 2188.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 2189.  1 2                     fac01(lay) * absb(ind1,ig) +  &
 2190.  1 2                     fac11(lay) * absb(ind1+1,ig)) &
 2191.  1 2                     + taufor
 2192.  1 2                fracs(lay,ngs9+ig) = fracrefb(ig)
 2193.  1 2-->          enddo
 2194.  1---->       enddo
 2195.         
 2196.               end subroutine taugb10
 2197.         
 2198.         !----------------------------------------------------------------------------
 2199.               subroutine taugb11(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2200.         !----------------------------------------------------------------------------
 2201.         !
 2202.         !     band 11:  1480-1800 cm-1 (low - h2o; low minor - o2)
 2203.         !                              (high key - h2o; high minor - o2)
 2204.         !----------------------------------------------------------------------------
 2205.         
 2206.         ! ------- Modules -------
 2207.         
 2208.               use parrrtm, only : ng11, ngs10
 2209.               use rrlw_kg11, only : fracrefa, fracrefb, absa, absb, &
 2210.                                     ka_mo2, kb_mo2, selfref, forref
 2211.         
 2212.         ! ------- Declarations -------
 2213.               integer      , intent(in ) :: nlayers
 2214.               integer      , intent(in ) :: ngptlw
 2215.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2216.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2217.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2218.         
 2219.         ! Local 
 2220.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 2221.               real(kind=r8) :: scaleo2, tauself, taufor, tauo2
 2222.         
 2223.         
 2224.         ! Minor gas mapping level :
 2225.         !     lower - o2, p = 706.2720 mbar, t = 278.94 k
 2226.         !     upper - o2, p = 4.758820 mbarm t = 250.85 k
 2227.         
 2228.         ! Compute the optical depth by interpolating in ln(pressure) and 
 2229.         ! temperature.  Below laytrop, the water vapor self-continuum and
 2230.         ! foreign continuum is interpolated (in temperature) separately.
 2231.         
 2232.         ! Lower atmosphere loop
 2233.  1----<       do lay = 1, laytrop
 2234.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(11) + 1
 2235.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(11) + 1
 2236.  1               inds = indself(lay)
 2237.  1               indf = indfor(lay)
 2238.  1               indm = indminor(lay)
 2239.  1               scaleo2 = colo2(lay)*scaleminor(lay)
 2240.  1 2--<          do ig = 1, ng11
 2241.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 2242.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2243.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2244.  1 2                     (forref(indf+1,ig) - forref(indf,ig)))
 2245.  1 2                tauo2 =  scaleo2 * (ka_mo2(indm,ig) + minorfrac(lay) * &
 2246.  1 2                     (ka_mo2(indm+1,ig) - ka_mo2(indm,ig)))
 2247.  1 2                taug(lay,ngs10+ig) = colh2o(lay) * &
 2248.  1 2                     (fac00(lay) * absa(ind0,ig) + &
 2249.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
 2250.  1 2                     fac01(lay) * absa(ind1,ig) + &
 2251.  1 2                     fac11(lay) * absa(ind1+1,ig)) &
 2252.  1 2                     + tauself + taufor &
 2253.  1 2                     + tauo2
 2254.  1 2                fracs(lay,ngs10+ig) = fracrefa(ig)
 2255.  1 2-->          enddo
 2256.  1---->       enddo
 2257.         
 2258.         ! Upper atmosphere loop
 2259.  1----<       do lay = laytrop+1, nlayers
 2260.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(11) + 1
 2261.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(11) + 1
 2262.  1               indf = indfor(lay)
 2263.  1               indm = indminor(lay)
 2264.  1               scaleo2 = colo2(lay)*scaleminor(lay)
 2265.  1 2--<          do ig = 1, ng11
 2266.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2267.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2268.  1 2                tauo2 =  scaleo2 * (kb_mo2(indm,ig) + minorfrac(lay) * &
 2269.  1 2                     (kb_mo2(indm+1,ig) - kb_mo2(indm,ig)))
 2270.  1 2                taug(lay,ngs10+ig) = colh2o(lay) * &
 2271.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 2272.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 2273.  1 2                     fac01(lay) * absb(ind1,ig) + &
 2274.  1 2                     fac11(lay) * absb(ind1+1,ig))  &
 2275.  1 2                     + taufor &
 2276.  1 2                     + tauo2
 2277.  1 2                fracs(lay,ngs10+ig) = fracrefb(ig)
 2278.  1 2-->          enddo
 2279.  1---->       enddo
 2280.         
 2281.               end subroutine taugb11
 2282.         
 2283.         !----------------------------------------------------------------------------
 2284.               subroutine taugb12(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2285.         !----------------------------------------------------------------------------
 2286.         !
 2287.         !     band 12:  1800-2080 cm-1 (low - h2o,co2; high - nothing)
 2288.         !----------------------------------------------------------------------------
 2289.         
 2290.         ! ------- Modules -------
 2291.         
 2292.               use parrrtm, only : ng12, ngs11
 2293.               use rrlw_ref, only : chi_mls
 2294.               use rrlw_kg12, only : fracrefa, absa, &
 2295.                                     selfref, forref
 2296.         
 2297.         ! ------- Declarations -------
 2298.               integer      , intent(in ) :: nlayers
 2299.               integer      , intent(in ) :: ngptlw
 2300.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2301.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2302.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2303.         
 2304.         ! Local 
 2305.               integer :: lay, ind0, ind1, inds, indf, ig
 2306.               integer :: js, js1, jpl
 2307.               real(kind=r8) :: speccomb, specparm, specmult, fs
 2308.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 2309.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 2310.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 2311.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 2312.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 2313.               real(kind=r8) :: tauself, taufor
 2314.               real(kind=r8) :: refrat_planck_a
 2315.               real(kind=r8) :: tau_major, tau_major1
 2316.         
 2317.         
 2318.         ! Calculate reference ratio to be used in calculation of Planck
 2319.         ! fraction in lower/upper atmosphere.
 2320.         
 2321.         ! P =   174.164 mb 
 2322.               refrat_planck_a = chi_mls(1,10)/chi_mls(2,10)
 2323.         
 2324.         ! Compute the optical depth by interpolating in ln(pressure), 
 2325.         ! temperature, and appropriate species.  Below laytrop, the water
 2326.         ! vapor self-continuum adn foreign continuum is interpolated 
 2327.         ! (in temperature) separately.  
 2328.         
 2329.         ! Lower atmosphere loop
 2330.  1----<       do lay = 1, laytrop
 2331.  1      
 2332.  1               speccomb = colh2o(lay) + rat_h2oco2(lay)*colco2(lay)
 2333.  1               specparm = colh2o(lay)/speccomb
 2334.  1               if (specparm .ge. oneminus) specparm = oneminus
 2335.  1               specmult = 8._r8*(specparm)
 2336.  1               js = 1 + int(specmult)
 2337.  1               fs = mod(specmult,1.0_r8)
 2338.  1      
 2339.  1               speccomb1 = colh2o(lay) + rat_h2oco2_1(lay)*colco2(lay)
 2340.  1               specparm1 = colh2o(lay)/speccomb1
 2341.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 2342.  1               specmult1 = 8._r8*(specparm1)
 2343.  1               js1 = 1 + int(specmult1)
 2344.  1               fs1 = mod(specmult1,1.0_r8)
 2345.  1      
 2346.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colco2(lay)
 2347.  1               specparm_planck = colh2o(lay)/speccomb_planck
 2348.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 2349.  1               specmult_planck = 8._r8*specparm_planck
 2350.  1               jpl= 1 + int(specmult_planck)
 2351.  1               fpl = mod(specmult_planck,1.0_r8)
 2352.  1      
 2353.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(12) + js
 2354.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(12) + js1
 2355.  1               inds = indself(lay)
 2356.  1               indf = indfor(lay)
 2357.  1      
 2358.  1               if (specparm .lt. 0.125_r8) then
 2359.  1                  p = fs - 1
 2360.  1                  p4 = p**4
 2361.  1                  fk0 = p4
 2362.  1                  fk1 = 1 - p - 2.0_r8*p4
 2363.  1                  fk2 = p + p4
 2364.  1                  fac000 = fk0*fac00(lay)
 2365.  1                  fac100 = fk1*fac00(lay)
 2366.  1                  fac200 = fk2*fac00(lay)
 2367.  1                  fac010 = fk0*fac10(lay)
 2368.  1                  fac110 = fk1*fac10(lay)
 2369.  1                  fac210 = fk2*fac10(lay)
 2370.  1               else if (specparm .gt. 0.875_r8) then
 2371.  1                  p = -fs 
 2372.  1                  p4 = p**4
 2373.  1                  fk0 = p4
 2374.  1                  fk1 = 1 - p - 2.0_r8*p4
 2375.  1                  fk2 = p + p4
 2376.  1                  fac000 = fk0*fac00(lay)
 2377.  1                  fac100 = fk1*fac00(lay)
 2378.  1                  fac200 = fk2*fac00(lay)
 2379.  1                  fac010 = fk0*fac10(lay)
 2380.  1                  fac110 = fk1*fac10(lay)
 2381.  1                  fac210 = fk2*fac10(lay)
 2382.  1               else
 2383.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 2384.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 2385.  1                  fac100 = fs * fac00(lay)
 2386.  1                  fac110 = fs * fac10(lay)
 2387.  1               endif
 2388.  1      
 2389.  1               if (specparm1 .lt. 0.125_r8) then
 2390.  1                  p = fs1 - 1
 2391.  1                  p4 = p**4
 2392.  1                  fk0 = p4
 2393.  1                  fk1 = 1 - p - 2.0_r8*p4
 2394.  1                  fk2 = p + p4
 2395.  1                  fac001 = fk0*fac01(lay)
 2396.  1                  fac101 = fk1*fac01(lay)
 2397.  1                  fac201 = fk2*fac01(lay)
 2398.  1                  fac011 = fk0*fac11(lay)
 2399.  1                  fac111 = fk1*fac11(lay)
 2400.  1                  fac211 = fk2*fac11(lay)
 2401.  1               else if (specparm1 .gt. 0.875_r8) then
 2402.  1                  p = -fs1 
 2403.  1                  p4 = p**4
 2404.  1                  fk0 = p4
 2405.  1                  fk1 = 1 - p - 2.0_r8*p4
 2406.  1                  fk2 = p + p4
 2407.  1                  fac001 = fk0*fac01(lay)
 2408.  1                  fac101 = fk1*fac01(lay)
 2409.  1                  fac201 = fk2*fac01(lay)
 2410.  1                  fac011 = fk0*fac11(lay)
 2411.  1                  fac111 = fk1*fac11(lay)
 2412.  1                  fac211 = fk2*fac11(lay)
 2413.  1               else
 2414.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 2415.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 2416.  1                  fac101 = fs1 * fac01(lay)
 2417.  1                  fac111 = fs1 * fac11(lay)
 2418.  1               endif
 2419.  1      
 2420.  1 2--<          do ig = 1, ng12
 2421.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 2422.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2423.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2424.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2425.  1 2    
 2426.  1 2                if (specparm .lt. 0.125_r8) then
 2427.  1 2                   tau_major = speccomb * &
 2428.  1 2                        (fac000 * absa(ind0,ig) + &
 2429.  1 2                        fac100 * absa(ind0+1,ig) + &
 2430.  1 2                        fac200 * absa(ind0+2,ig) + &
 2431.  1 2                        fac010 * absa(ind0+9,ig) + &
 2432.  1 2                        fac110 * absa(ind0+10,ig) + &
 2433.  1 2                        fac210 * absa(ind0+11,ig))
 2434.  1 2                else if (specparm .gt. 0.875_r8) then
 2435.  1 2                   tau_major = speccomb * &
 2436.  1 2                        (fac200 * absa(ind0-1,ig) + &
 2437.  1 2                        fac100 * absa(ind0,ig) + &
 2438.  1 2                        fac000 * absa(ind0+1,ig) + &
 2439.  1 2                        fac210 * absa(ind0+8,ig) + &
 2440.  1 2                        fac110 * absa(ind0+9,ig) + &
 2441.  1 2                        fac010 * absa(ind0+10,ig))
 2442.  1 2                else
 2443.  1 2                   tau_major = speccomb * &
 2444.  1 2                        (fac000 * absa(ind0,ig) + &
 2445.  1 2                        fac100 * absa(ind0+1,ig) + &
 2446.  1 2                        fac010 * absa(ind0+9,ig) + &
 2447.  1 2                        fac110 * absa(ind0+10,ig))
 2448.  1 2                endif
 2449.  1 2    
 2450.  1 2                if (specparm1 .lt. 0.125_r8) then
 2451.  1 2                   tau_major1 = speccomb1 * &
 2452.  1 2                        (fac001 * absa(ind1,ig) + &
 2453.  1 2                        fac101 * absa(ind1+1,ig) + &
 2454.  1 2                        fac201 * absa(ind1+2,ig) + &
 2455.  1 2                        fac011 * absa(ind1+9,ig) + &
 2456.  1 2                        fac111 * absa(ind1+10,ig) + &
 2457.  1 2                        fac211 * absa(ind1+11,ig))
 2458.  1 2                else if (specparm1 .gt. 0.875_r8) then
 2459.  1 2                   tau_major1 = speccomb1 * &
 2460.  1 2                        (fac201 * absa(ind1-1,ig) + &
 2461.  1 2                        fac101 * absa(ind1,ig) + &
 2462.  1 2                        fac001 * absa(ind1+1,ig) + &
 2463.  1 2                        fac211 * absa(ind1+8,ig) + &
 2464.  1 2                        fac111 * absa(ind1+9,ig) + &
 2465.  1 2                        fac011 * absa(ind1+10,ig))
 2466.  1 2                else
 2467.  1 2                   tau_major1 = speccomb1 * &
 2468.  1 2                        (fac001 * absa(ind1,ig) + &
 2469.  1 2                        fac101 * absa(ind1+1,ig) + &
 2470.  1 2                        fac011 * absa(ind1+9,ig) + &
 2471.  1 2                        fac111 * absa(ind1+10,ig))
 2472.  1 2                endif
 2473.  1 2    
 2474.  1 2                taug(lay,ngs11+ig) = tau_major + tau_major1 &
 2475.  1 2                     + tauself + taufor
 2476.  1 2                fracs(lay,ngs11+ig) = fracrefa(ig,jpl) + fpl * &
 2477.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 2478.  1 2-->          enddo
 2479.  1---->       enddo
 2480.         
 2481.         ! Upper atmosphere loop
 2482.  i----<       do lay = laytrop+1, nlayers
 2483.  i i--<          do ig = 1, ng12
 2484.  i i                taug(lay,ngs11+ig) = 0.0_r8
 2485.  i i                fracs(lay,ngs11+ig) = 0.0_r8
 2486.  i i-->          enddo
 2487.  i---->       enddo
 2488.         
 2489.               end subroutine taugb12
 2490.         
 2491.         !----------------------------------------------------------------------------
 2492.               subroutine taugb13(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2493.         !----------------------------------------------------------------------------
 2494.         !
 2495.         !     band 13:  2080-2250 cm-1 (low key - h2o,n2o; high minor - o3 minor)
 2496.         !----------------------------------------------------------------------------
 2497.         
 2498.         ! ------- Modules -------
 2499.         
 2500.               use parrrtm, only : ng13, ngs12
 2501.               use rrlw_ref, only : chi_mls
 2502.               use rrlw_kg13, only : fracrefa, fracrefb, absa, &
 2503.                                     ka_mco2, ka_mco, kb_mo3, selfref, forref
 2504.         
 2505.         ! ------- Declarations -------
 2506.               integer      , intent(in ) :: nlayers
 2507.               integer      , intent(in ) :: ngptlw
 2508.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2509.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2510.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2511.         
 2512.         ! Local 
 2513.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 2514.               integer :: js, js1, jmco2, jmco, jpl
 2515.               real(kind=r8) :: speccomb, specparm, specmult, fs
 2516.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 2517.               real(kind=r8) :: speccomb_mco2, specparm_mco2, specmult_mco2, fmco2
 2518.               real(kind=r8) :: speccomb_mco, specparm_mco, specmult_mco, fmco
 2519.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 2520.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 2521.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 2522.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 2523.               real(kind=r8) :: tauself, taufor, co2m1, co2m2, absco2 
 2524.               real(kind=r8) :: com1, com2, absco, abso3
 2525.               real(kind=r8) :: chi_co2, ratco2, adjfac, adjcolco2
 2526.               real(kind=r8) :: refrat_planck_a, refrat_m_a, refrat_m_a3
 2527.               real(kind=r8) :: tau_major, tau_major1
 2528.         
 2529.         
 2530.         ! Minor gas mapping levels :
 2531.         !     lower - co2, p = 1053.63 mb, t = 294.2 k
 2532.         !     lower - co, p = 706 mb, t = 278.94 k
 2533.         !     upper - o3, p = 95.5835 mb, t = 215.7 k
 2534.         
 2535.         ! Calculate reference ratio to be used in calculation of Planck
 2536.         ! fraction in lower/upper atmosphere.
 2537.         
 2538.         ! P = 473.420 mb (Level 5)
 2539.               refrat_planck_a = chi_mls(1,5)/chi_mls(4,5)
 2540.         
 2541.         ! P = 1053. (Level 1)
 2542.               refrat_m_a = chi_mls(1,1)/chi_mls(4,1)
 2543.         
 2544.         ! P = 706. (Level 3)
 2545.               refrat_m_a3 = chi_mls(1,3)/chi_mls(4,3)
 2546.         
 2547.         ! Compute the optical depth by interpolating in ln(pressure), 
 2548.         ! temperature, and appropriate species.  Below laytrop, the water
 2549.         ! vapor self-continuum and foreign continuum is interpolated 
 2550.         ! (in temperature) separately.  
 2551.         
 2552.         ! Lower atmosphere loop
 2553.  1----<       do lay = 1, laytrop
 2554.  1      
 2555.  1               speccomb = colh2o(lay) + rat_h2on2o(lay)*coln2o(lay)
 2556.  1               specparm = colh2o(lay)/speccomb
 2557.  1               if (specparm .ge. oneminus) specparm = oneminus
 2558.  1               specmult = 8._r8*(specparm)
 2559.  1               js = 1 + int(specmult)
 2560.  1               fs = mod(specmult,1.0_r8)
 2561.  1      
 2562.  1               speccomb1 = colh2o(lay) + rat_h2on2o_1(lay)*coln2o(lay)
 2563.  1               specparm1 = colh2o(lay)/speccomb1
 2564.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 2565.  1               specmult1 = 8._r8*(specparm1)
 2566.  1               js1 = 1 + int(specmult1)
 2567.  1               fs1 = mod(specmult1,1.0_r8)
 2568.  1      
 2569.  1               speccomb_mco2 = colh2o(lay) + refrat_m_a*coln2o(lay)
 2570.  1               specparm_mco2 = colh2o(lay)/speccomb_mco2
 2571.  1               if (specparm_mco2 .ge. oneminus) specparm_mco2 = oneminus
 2572.  1               specmult_mco2 = 8._r8*specparm_mco2
 2573.  1               jmco2 = 1 + int(specmult_mco2)
 2574.  1               fmco2 = mod(specmult_mco2,1.0_r8)
 2575.  1      
 2576.  1      !  In atmospheres where the amount of CO2 is too great to be considered
 2577.  1      !  a minor species, adjust the column amount of CO2 by an empirical factor 
 2578.  1      !  to obtain the proper contribution.
 2579.  1               chi_co2 = colco2(lay)/(coldry(lay))
 2580.  1               ratco2 = 1.e20_r8*chi_co2/3.55e-4_r8
 2581.  1               if (ratco2 .gt. 3.0_r8) then
 2582.  1                  adjfac = 2.0_r8+(ratco2-2.0_r8)**0.68_r8
 2583.  1                  adjcolco2 = adjfac*3.55e-4*coldry(lay)*1.e-20_r8
 2584.  1               else
 2585.  1                  adjcolco2 = colco2(lay)
 2586.  1               endif
 2587.  1      
 2588.  1               speccomb_mco = colh2o(lay) + refrat_m_a3*coln2o(lay)
 2589.  1               specparm_mco = colh2o(lay)/speccomb_mco
 2590.  1               if (specparm_mco .ge. oneminus) specparm_mco = oneminus
 2591.  1               specmult_mco = 8._r8*specparm_mco
 2592.  1               jmco = 1 + int(specmult_mco)
 2593.  1               fmco = mod(specmult_mco,1.0_r8)
 2594.  1      
 2595.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*coln2o(lay)
 2596.  1               specparm_planck = colh2o(lay)/speccomb_planck
 2597.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 2598.  1               specmult_planck = 8._r8*specparm_planck
 2599.  1               jpl= 1 + int(specmult_planck)
 2600.  1               fpl = mod(specmult_planck,1.0_r8)
 2601.  1      
 2602.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(13) + js
 2603.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(13) + js1
 2604.  1               inds = indself(lay)
 2605.  1               indf = indfor(lay)
 2606.  1               indm = indminor(lay)
 2607.  1      
 2608.  1               if (specparm .lt. 0.125_r8) then
 2609.  1                  p = fs - 1
 2610.  1                  p4 = p**4
 2611.  1                  fk0 = p4
 2612.  1                  fk1 = 1 - p - 2.0_r8*p4
 2613.  1                  fk2 = p + p4
 2614.  1                  fac000 = fk0*fac00(lay)
 2615.  1                  fac100 = fk1*fac00(lay)
 2616.  1                  fac200 = fk2*fac00(lay)
 2617.  1                  fac010 = fk0*fac10(lay)
 2618.  1                  fac110 = fk1*fac10(lay)
 2619.  1                  fac210 = fk2*fac10(lay)
 2620.  1               else if (specparm .gt. 0.875_r8) then
 2621.  1                  p = -fs 
 2622.  1                  p4 = p**4
 2623.  1                  fk0 = p4
 2624.  1                  fk1 = 1 - p - 2.0_r8*p4
 2625.  1                  fk2 = p + p4
 2626.  1                  fac000 = fk0*fac00(lay)
 2627.  1                  fac100 = fk1*fac00(lay)
 2628.  1                  fac200 = fk2*fac00(lay)
 2629.  1                  fac010 = fk0*fac10(lay)
 2630.  1                  fac110 = fk1*fac10(lay)
 2631.  1                  fac210 = fk2*fac10(lay)
 2632.  1               else
 2633.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 2634.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 2635.  1                  fac100 = fs * fac00(lay)
 2636.  1                  fac110 = fs * fac10(lay)
 2637.  1               endif
 2638.  1      
 2639.  1               if (specparm1 .lt. 0.125_r8) then
 2640.  1                  p = fs1 - 1
 2641.  1                  p4 = p**4
 2642.  1                  fk0 = p4
 2643.  1                  fk1 = 1 - p - 2.0_r8*p4
 2644.  1                  fk2 = p + p4
 2645.  1                  fac001 = fk0*fac01(lay)
 2646.  1                  fac101 = fk1*fac01(lay)
 2647.  1                  fac201 = fk2*fac01(lay)
 2648.  1                  fac011 = fk0*fac11(lay)
 2649.  1                  fac111 = fk1*fac11(lay)
 2650.  1                  fac211 = fk2*fac11(lay)
 2651.  1               else if (specparm1 .gt. 0.875_r8) then
 2652.  1                  p = -fs1 
 2653.  1                  p4 = p**4
 2654.  1                  fk0 = p4
 2655.  1                  fk1 = 1 - p - 2.0_r8*p4
 2656.  1                  fk2 = p + p4
 2657.  1                  fac001 = fk0*fac01(lay)
 2658.  1                  fac101 = fk1*fac01(lay)
 2659.  1                  fac201 = fk2*fac01(lay)
 2660.  1                  fac011 = fk0*fac11(lay)
 2661.  1                  fac111 = fk1*fac11(lay)
 2662.  1                  fac211 = fk2*fac11(lay)
 2663.  1               else
 2664.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 2665.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 2666.  1                  fac101 = fs1 * fac01(lay)
 2667.  1                  fac111 = fs1 * fac11(lay)
 2668.  1               endif
 2669.  1      
 2670.  1 2--<          do ig = 1, ng13
 2671.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 2672.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2673.  1 2                taufor = forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2674.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2675.  1 2                co2m1 = ka_mco2(jmco2,indm,ig) + fmco2 * &
 2676.  1 2                     (ka_mco2(jmco2+1,indm,ig) - ka_mco2(jmco2,indm,ig))
 2677.  1 2                co2m2 = ka_mco2(jmco2,indm+1,ig) + fmco2 * &
 2678.  1 2                     (ka_mco2(jmco2+1,indm+1,ig) - ka_mco2(jmco2,indm+1,ig))
 2679.  1 2                absco2 = co2m1 + minorfrac(lay) * (co2m2 - co2m1)
 2680.  1 2                com1 = ka_mco(jmco,indm,ig) + fmco * &
 2681.  1 2                     (ka_mco(jmco+1,indm,ig) - ka_mco(jmco,indm,ig))
 2682.  1 2                com2 = ka_mco(jmco,indm+1,ig) + fmco * &
 2683.  1 2                     (ka_mco(jmco+1,indm+1,ig) - ka_mco(jmco,indm+1,ig))
 2684.  1 2                absco = com1 + minorfrac(lay) * (com2 - com1)
 2685.  1 2    
 2686.  1 2                if (specparm .lt. 0.125_r8) then
 2687.  1 2                   tau_major = speccomb * &
 2688.  1 2                        (fac000 * absa(ind0,ig) + &
 2689.  1 2                        fac100 * absa(ind0+1,ig) + &
 2690.  1 2                        fac200 * absa(ind0+2,ig) + &
 2691.  1 2                        fac010 * absa(ind0+9,ig) + &
 2692.  1 2                        fac110 * absa(ind0+10,ig) + &
 2693.  1 2                        fac210 * absa(ind0+11,ig))
 2694.  1 2                else if (specparm .gt. 0.875_r8) then
 2695.  1 2                   tau_major = speccomb * &
 2696.  1 2                        (fac200 * absa(ind0-1,ig) + &
 2697.  1 2                        fac100 * absa(ind0,ig) + &
 2698.  1 2                        fac000 * absa(ind0+1,ig) + &
 2699.  1 2                        fac210 * absa(ind0+8,ig) + &
 2700.  1 2                        fac110 * absa(ind0+9,ig) + &
 2701.  1 2                        fac010 * absa(ind0+10,ig))
 2702.  1 2                else
 2703.  1 2                   tau_major = speccomb * &
 2704.  1 2                        (fac000 * absa(ind0,ig) + &
 2705.  1 2                        fac100 * absa(ind0+1,ig) + &
 2706.  1 2                        fac010 * absa(ind0+9,ig) + &
 2707.  1 2                        fac110 * absa(ind0+10,ig))
 2708.  1 2                endif
 2709.  1 2    
 2710.  1 2                if (specparm1 .lt. 0.125_r8) then
 2711.  1 2                   tau_major1 = speccomb1 * &
 2712.  1 2                        (fac001 * absa(ind1,ig) + &
 2713.  1 2                        fac101 * absa(ind1+1,ig) + &
 2714.  1 2                        fac201 * absa(ind1+2,ig) + &
 2715.  1 2                        fac011 * absa(ind1+9,ig) + &
 2716.  1 2                        fac111 * absa(ind1+10,ig) + &
 2717.  1 2                        fac211 * absa(ind1+11,ig))
 2718.  1 2                else if (specparm1 .gt. 0.875_r8) then
 2719.  1 2                   tau_major1 = speccomb1 * &
 2720.  1 2                        (fac201 * absa(ind1-1,ig) + &
 2721.  1 2                        fac101 * absa(ind1,ig) + &
 2722.  1 2                        fac001 * absa(ind1+1,ig) + &
 2723.  1 2                        fac211 * absa(ind1+8,ig) + &
 2724.  1 2                        fac111 * absa(ind1+9,ig) + &
 2725.  1 2                        fac011 * absa(ind1+10,ig))
 2726.  1 2                else
 2727.  1 2                   tau_major1 = speccomb1 * &
 2728.  1 2                        (fac001 * absa(ind1,ig) + &
 2729.  1 2                        fac101 * absa(ind1+1,ig) + &
 2730.  1 2                        fac011 * absa(ind1+9,ig) + &
 2731.  1 2                        fac111 * absa(ind1+10,ig))
 2732.  1 2                endif
 2733.  1 2    
 2734.  1 2                taug(lay,ngs12+ig) = tau_major + tau_major1 &
 2735.  1 2                     + tauself + taufor &
 2736.  1 2                     + adjcolco2*absco2 &
 2737.  1 2                     + colco(lay)*absco
 2738.  1 2                fracs(lay,ngs12+ig) = fracrefa(ig,jpl) + fpl * &
 2739.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 2740.  1 2-->          enddo
 2741.  1---->       enddo
 2742.         
 2743.         ! Upper atmosphere loop
 2744.  1----<       do lay = laytrop+1, nlayers
 2745.  1               indm = indminor(lay)
 2746.  1 2--<          do ig = 1, ng13
 2747.  1 2                abso3 = kb_mo3(indm,ig) + minorfrac(lay) * &
 2748.  1 2                     (kb_mo3(indm+1,ig) - kb_mo3(indm,ig))
 2749.  1 2                taug(lay,ngs12+ig) = colo3(lay)*abso3
 2750.  1 2                fracs(lay,ngs12+ig) =  fracrefb(ig)
 2751.  1 2-->          enddo
 2752.  1---->       enddo
 2753.         
 2754.               end subroutine taugb13
 2755.         
 2756.         !----------------------------------------------------------------------------
 2757.               subroutine taugb14(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2758.         !----------------------------------------------------------------------------
 2759.         !
 2760.         !     band 14:  2250-2380 cm-1 (low - co2; high - co2)
 2761.         !----------------------------------------------------------------------------
 2762.         
 2763.         ! ------- Modules -------
 2764.         
 2765.               use parrrtm, only : ng14, ngs13
 2766.               use rrlw_kg14, only : fracrefa, fracrefb, absa, absb, &
 2767.                                     selfref, forref
 2768.         
 2769.         ! ------- Declarations -------
 2770.               integer      , intent(in ) :: nlayers
 2771.               integer      , intent(in ) :: ngptlw
 2772.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2773.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2774.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2775.         
 2776.         ! Local 
 2777.               integer :: lay, ind0, ind1, inds, indf, ig
 2778.               real(kind=r8) :: tauself, taufor
 2779.         
 2780.         
 2781.         ! Compute the optical depth by interpolating in ln(pressure) and 
 2782.         ! temperature.  Below laytrop, the water vapor self-continuum 
 2783.         ! and foreign continuum is interpolated (in temperature) separately.  
 2784.         
 2785.         ! Lower atmosphere loop
 2786.  1----<       do lay = 1, laytrop
 2787.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(14) + 1
 2788.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(14) + 1
 2789.  1               inds = indself(lay)
 2790.  1               indf = indfor(lay)
 2791.  1 2--<          do ig = 1, ng14
 2792.  1 2                tauself = selffac(lay) * (selfref(inds,ig) + selffrac(lay) * &
 2793.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2794.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2795.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2796.  1 2                taug(lay,ngs13+ig) = colco2(lay) * &
 2797.  1 2                     (fac00(lay) * absa(ind0,ig) + &
 2798.  1 2                     fac10(lay) * absa(ind0+1,ig) + &
 2799.  1 2                     fac01(lay) * absa(ind1,ig) + &
 2800.  1 2                     fac11(lay) * absa(ind1+1,ig)) &
 2801.  1 2                     + tauself + taufor
 2802.  1 2                fracs(lay,ngs13+ig) = fracrefa(ig)
 2803.  1 2-->          enddo
 2804.  1---->       enddo
 2805.         
 2806.         ! Upper atmosphere loop
 2807.  1----<       do lay = laytrop+1, nlayers
 2808.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(14) + 1
 2809.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(14) + 1
 2810.  1 2--<          do ig = 1, ng14
 2811.  1 2                taug(lay,ngs13+ig) = colco2(lay) * &
 2812.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 2813.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 2814.  1 2                     fac01(lay) * absb(ind1,ig) + &
 2815.  1 2                     fac11(lay) * absb(ind1+1,ig))
 2816.  1 2                fracs(lay,ngs13+ig) = fracrefb(ig)
 2817.  1 2-->          enddo
 2818.  1---->       enddo
 2819.         
 2820.               end subroutine taugb14
 2821.         
 2822.         !----------------------------------------------------------------------------
 2823.               subroutine taugb15(nlayers,ngptlw,laytrop,fracs  ,taug   )
 2824.         !----------------------------------------------------------------------------
 2825.         !
 2826.         !     band 15:  2380-2600 cm-1 (low - n2o,co2; low minor - n2)
 2827.         !                              (high - nothing)
 2828.         !----------------------------------------------------------------------------
 2829.         
 2830.         ! ------- Modules -------
 2831.         
 2832.               use parrrtm, only : ng15, ngs14
 2833.               use rrlw_ref, only : chi_mls
 2834.               use rrlw_kg15, only : fracrefa, absa, &
 2835.                                     ka_mn2, selfref, forref
 2836.         
 2837.         ! ------- Declarations -------
 2838.               integer      , intent(in ) :: nlayers
 2839.               integer      , intent(in ) :: ngptlw
 2840.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 2841.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 2842.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 2843.         
 2844.         ! Local 
 2845.               integer :: lay, ind0, ind1, inds, indf, indm, ig
 2846.               integer :: js, js1, jmn2, jpl
 2847.               real(kind=r8) :: speccomb, specparm, specmult, fs
 2848.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 2849.               real(kind=r8) :: speccomb_mn2, specparm_mn2, specmult_mn2, fmn2
 2850.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 2851.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 2852.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 2853.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 2854.               real(kind=r8) :: scalen2, tauself, taufor, n2m1, n2m2, taun2 
 2855.               real(kind=r8) :: refrat_planck_a, refrat_m_a
 2856.               real(kind=r8) :: tau_major, tau_major1
 2857.         
 2858.         
 2859.         ! Minor gas mapping level : 
 2860.         !     Lower - Nitrogen Continuum, P = 1053., T = 294.
 2861.         
 2862.         ! Calculate reference ratio to be used in calculation of Planck
 2863.         ! fraction in lower atmosphere.
 2864.         ! P = 1053. mb (Level 1)
 2865.               refrat_planck_a = chi_mls(4,1)/chi_mls(2,1)
 2866.         
 2867.         ! P = 1053.
 2868.               refrat_m_a = chi_mls(4,1)/chi_mls(2,1)
 2869.         
 2870.         ! Compute the optical depth by interpolating in ln(pressure), 
 2871.         ! temperature, and appropriate species.  Below laytrop, the water
 2872.         ! vapor self-continuum and foreign continuum is interpolated 
 2873.         ! (in temperature) separately.  
 2874.         
 2875.         ! Lower atmosphere loop
 2876.  1----<       do lay = 1, laytrop
 2877.  1      
 2878.  1               speccomb = coln2o(lay) + rat_n2oco2(lay)*colco2(lay)
 2879.  1               specparm = coln2o(lay)/speccomb
 2880.  1               if (specparm .ge. oneminus) specparm = oneminus
 2881.  1               specmult = 8._r8*(specparm)
 2882.  1               js = 1 + int(specmult)
 2883.  1               fs = mod(specmult,1.0_r8)
 2884.  1      
 2885.  1               speccomb1 = coln2o(lay) + rat_n2oco2_1(lay)*colco2(lay)
 2886.  1               specparm1 = coln2o(lay)/speccomb1
 2887.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 2888.  1               specmult1 = 8._r8*(specparm1)
 2889.  1               js1 = 1 + int(specmult1)
 2890.  1               fs1 = mod(specmult1,1.0_r8)
 2891.  1      
 2892.  1               speccomb_mn2 = coln2o(lay) + refrat_m_a*colco2(lay)
 2893.  1               specparm_mn2 = coln2o(lay)/speccomb_mn2
 2894.  1               if (specparm_mn2 .ge. oneminus) specparm_mn2 = oneminus
 2895.  1               specmult_mn2 = 8._r8*specparm_mn2
 2896.  1               jmn2 = 1 + int(specmult_mn2)
 2897.  1               fmn2 = mod(specmult_mn2,1.0_r8)
 2898.  1      
 2899.  1               speccomb_planck = coln2o(lay)+refrat_planck_a*colco2(lay)
 2900.  1               specparm_planck = coln2o(lay)/speccomb_planck
 2901.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 2902.  1               specmult_planck = 8._r8*specparm_planck
 2903.  1               jpl= 1 + int(specmult_planck)
 2904.  1               fpl = mod(specmult_planck,1.0_r8)
 2905.  1      
 2906.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(15) + js
 2907.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(15) + js1
 2908.  1               inds = indself(lay)
 2909.  1               indf = indfor(lay)
 2910.  1               indm = indminor(lay)
 2911.  1               
 2912.  1               scalen2 = colbrd(lay)*scaleminor(lay)
 2913.  1      
 2914.  1               if (specparm .lt. 0.125_r8) then
 2915.  1                  p = fs - 1
 2916.  1                  p4 = p**4
 2917.  1                  fk0 = p4
 2918.  1                  fk1 = 1 - p - 2.0_r8*p4
 2919.  1                  fk2 = p + p4
 2920.  1                  fac000 = fk0*fac00(lay)
 2921.  1                  fac100 = fk1*fac00(lay)
 2922.  1                  fac200 = fk2*fac00(lay)
 2923.  1                  fac010 = fk0*fac10(lay)
 2924.  1                  fac110 = fk1*fac10(lay)
 2925.  1                  fac210 = fk2*fac10(lay)
 2926.  1               else if (specparm .gt. 0.875_r8) then
 2927.  1                  p = -fs 
 2928.  1                  p4 = p**4
 2929.  1                  fk0 = p4
 2930.  1                  fk1 = 1 - p - 2.0_r8*p4
 2931.  1                  fk2 = p + p4
 2932.  1                  fac000 = fk0*fac00(lay)
 2933.  1                  fac100 = fk1*fac00(lay)
 2934.  1                  fac200 = fk2*fac00(lay)
 2935.  1                  fac010 = fk0*fac10(lay)
 2936.  1                  fac110 = fk1*fac10(lay)
 2937.  1                  fac210 = fk2*fac10(lay)
 2938.  1               else
 2939.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 2940.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 2941.  1                  fac100 = fs * fac00(lay)
 2942.  1                  fac110 = fs * fac10(lay)
 2943.  1               endif
 2944.  1               if (specparm1 .lt. 0.125_r8) then
 2945.  1                  p = fs1 - 1
 2946.  1                  p4 = p**4
 2947.  1                  fk0 = p4
 2948.  1                  fk1 = 1 - p - 2.0_r8*p4
 2949.  1                  fk2 = p + p4
 2950.  1                  fac001 = fk0*fac01(lay)
 2951.  1                  fac101 = fk1*fac01(lay)
 2952.  1                  fac201 = fk2*fac01(lay)
 2953.  1                  fac011 = fk0*fac11(lay)
 2954.  1                  fac111 = fk1*fac11(lay)
 2955.  1                  fac211 = fk2*fac11(lay)
 2956.  1               else if (specparm1 .gt. 0.875_r8) then
 2957.  1                  p = -fs1 
 2958.  1                  p4 = p**4
 2959.  1                  fk0 = p4
 2960.  1                  fk1 = 1 - p - 2.0_r8*p4
 2961.  1                  fk2 = p + p4
 2962.  1                  fac001 = fk0*fac01(lay)
 2963.  1                  fac101 = fk1*fac01(lay)
 2964.  1                  fac201 = fk2*fac01(lay)
 2965.  1                  fac011 = fk0*fac11(lay)
 2966.  1                  fac111 = fk1*fac11(lay)
 2967.  1                  fac211 = fk2*fac11(lay)
 2968.  1               else
 2969.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 2970.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 2971.  1                  fac101 = fs1 * fac01(lay)
 2972.  1                  fac111 = fs1 * fac11(lay)
 2973.  1               endif
 2974.  1      
 2975.  1 2--<          do ig = 1, ng15
 2976.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 2977.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 2978.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 2979.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 2980.  1 2                n2m1 = ka_mn2(jmn2,indm,ig) + fmn2 * &
 2981.  1 2                     (ka_mn2(jmn2+1,indm,ig) - ka_mn2(jmn2,indm,ig))
 2982.  1 2                n2m2 = ka_mn2(jmn2,indm+1,ig) + fmn2 * &
 2983.  1 2                     (ka_mn2(jmn2+1,indm+1,ig) - ka_mn2(jmn2,indm+1,ig))
 2984.  1 2                taun2 = scalen2 * (n2m1 + minorfrac(lay) * (n2m2 - n2m1))
 2985.  1 2    
 2986.  1 2                if (specparm .lt. 0.125_r8) then
 2987.  1 2                   tau_major = speccomb * &
 2988.  1 2                        (fac000 * absa(ind0,ig) + &
 2989.  1 2                        fac100 * absa(ind0+1,ig) + &
 2990.  1 2                        fac200 * absa(ind0+2,ig) + &
 2991.  1 2                        fac010 * absa(ind0+9,ig) + &
 2992.  1 2                        fac110 * absa(ind0+10,ig) + &
 2993.  1 2                        fac210 * absa(ind0+11,ig))
 2994.  1 2                else if (specparm .gt. 0.875_r8) then
 2995.  1 2                   tau_major = speccomb * &
 2996.  1 2                        (fac200 * absa(ind0-1,ig) + &
 2997.  1 2                        fac100 * absa(ind0,ig) + &
 2998.  1 2                        fac000 * absa(ind0+1,ig) + &
 2999.  1 2                        fac210 * absa(ind0+8,ig) + &
 3000.  1 2                        fac110 * absa(ind0+9,ig) + &
 3001.  1 2                        fac010 * absa(ind0+10,ig))
 3002.  1 2                else
 3003.  1 2                   tau_major = speccomb * &
 3004.  1 2                        (fac000 * absa(ind0,ig) + &
 3005.  1 2                        fac100 * absa(ind0+1,ig) + &
 3006.  1 2                        fac010 * absa(ind0+9,ig) + &
 3007.  1 2                        fac110 * absa(ind0+10,ig))
 3008.  1 2                endif 
 3009.  1 2    
 3010.  1 2                if (specparm1 .lt. 0.125_r8) then
 3011.  1 2                   tau_major1 = speccomb1 * &
 3012.  1 2                        (fac001 * absa(ind1,ig) + &
 3013.  1 2                        fac101 * absa(ind1+1,ig) + &
 3014.  1 2                        fac201 * absa(ind1+2,ig) + &
 3015.  1 2                        fac011 * absa(ind1+9,ig) + &
 3016.  1 2                        fac111 * absa(ind1+10,ig) + &
 3017.  1 2                        fac211 * absa(ind1+11,ig))
 3018.  1 2                else if (specparm1 .gt. 0.875_r8) then
 3019.  1 2                   tau_major1 = speccomb1 * &
 3020.  1 2                        (fac201 * absa(ind1-1,ig) + &
 3021.  1 2                        fac101 * absa(ind1,ig) + &
 3022.  1 2                        fac001 * absa(ind1+1,ig) + &
 3023.  1 2                        fac211 * absa(ind1+8,ig) + &
 3024.  1 2                        fac111 * absa(ind1+9,ig) + &
 3025.  1 2                        fac011 * absa(ind1+10,ig))
 3026.  1 2                else
 3027.  1 2                   tau_major1 = speccomb1 * &
 3028.  1 2                        (fac001 * absa(ind1,ig) + &
 3029.  1 2                        fac101 * absa(ind1+1,ig) + &
 3030.  1 2                        fac011 * absa(ind1+9,ig) + &
 3031.  1 2                        fac111 * absa(ind1+10,ig))
 3032.  1 2                endif
 3033.  1 2    
 3034.  1 2                taug(lay,ngs14+ig) = tau_major + tau_major1 &
 3035.  1 2                     + tauself + taufor &
 3036.  1 2                     + taun2
 3037.  1 2                fracs(lay,ngs14+ig) = fracrefa(ig,jpl) + fpl * &
 3038.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 3039.  1 2-->          enddo
 3040.  1---->       enddo
 3041.         
 3042.         ! Upper atmosphere loop
 3043.  i----<       do lay = laytrop+1, nlayers
 3044.  i i--<          do ig = 1, ng15
 3045.  i i                taug(lay,ngs14+ig) = 0.0_r8
 3046.  i i                fracs(lay,ngs14+ig) = 0.0_r8
 3047.  i i-->          enddo
 3048.  i---->       enddo
 3049.         
 3050.               end subroutine taugb15
 3051.         
 3052.         !----------------------------------------------------------------------------
 3053.               subroutine taugb16(nlayers,ngptlw,laytrop,fracs  ,taug   )
 3054.         !----------------------------------------------------------------------------
 3055.         !
 3056.         !     band 16:  2600-3250 cm-1 (low key- h2o,ch4; high key - ch4)
 3057.         !----------------------------------------------------------------------------
 3058.         
 3059.         ! ------- Modules -------
 3060.         
 3061.               use parrrtm, only : ng16, ngs15
 3062.               use rrlw_ref, only : chi_mls
 3063.               use rrlw_kg16, only : fracrefa, fracrefb, absa, absb, &
 3064.                                     selfref, forref
 3065.         
 3066.         ! ------- Declarations -------
 3067.               integer      , intent(in ) :: nlayers
 3068.               integer      , intent(in ) :: ngptlw
 3069.               integer      , intent(in ) :: laytrop         ! tropopause layer index
 3070.               real(kind=r8), intent(out) :: fracs  (1:nlayers,1:ngptlw)         ! planck fractions!    Dimensions: (nlayers,ngptlw)
 3071.               real(kind=r8), intent(out) :: taug   (1:nlayers,1:ngptlw)         ! gaseous optical depth !    Dimensions: (nlayers,ngptlw)
 3072.         
 3073.         ! Local 
 3074.               integer :: lay, ind0, ind1, inds, indf, ig
 3075.               integer :: js, js1, jpl
 3076.               real(kind=r8) :: speccomb, specparm, specmult, fs
 3077.               real(kind=r8) :: speccomb1, specparm1, specmult1, fs1
 3078.               real(kind=r8) :: speccomb_planck, specparm_planck, specmult_planck, fpl
 3079.               real(kind=r8) :: p, p4, fk0, fk1, fk2
 3080.               real(kind=r8) :: fac000, fac100, fac200, fac010, fac110, fac210
 3081.               real(kind=r8) :: fac001, fac101, fac201, fac011, fac111, fac211
 3082.               real(kind=r8) :: tauself, taufor
 3083.               real(kind=r8) :: refrat_planck_a
 3084.               real(kind=r8) :: tau_major, tau_major1
 3085.         
 3086.         
 3087.         ! Calculate reference ratio to be used in calculation of Planck
 3088.         ! fraction in lower atmosphere.
 3089.         
 3090.         ! P = 387. mb (Level 6)
 3091.               refrat_planck_a = chi_mls(1,6)/chi_mls(6,6)
 3092.         
 3093.         ! Compute the optical depth by interpolating in ln(pressure), 
 3094.         ! temperature,and appropriate species.  Below laytrop, the water
 3095.         ! vapor self-continuum and foreign continuum is interpolated 
 3096.         ! (in temperature) separately.  
 3097.         
 3098.         ! Lower atmosphere loop
 3099.  1----<       do lay = 1, laytrop
 3100.  1      
 3101.  1               speccomb = colh2o(lay) + rat_h2och4(lay)*colch4(lay)
 3102.  1               specparm = colh2o(lay)/speccomb
 3103.  1               if (specparm .ge. oneminus) specparm = oneminus
 3104.  1               specmult = 8._r8*(specparm)
 3105.  1               js = 1 + int(specmult)
 3106.  1               fs = mod(specmult,1.0_r8)
 3107.  1      
 3108.  1               speccomb1 = colh2o(lay) + rat_h2och4_1(lay)*colch4(lay)
 3109.  1               specparm1 = colh2o(lay)/speccomb1
 3110.  1               if (specparm1 .ge. oneminus) specparm1 = oneminus
 3111.  1               specmult1 = 8._r8*(specparm1)
 3112.  1               js1 = 1 + int(specmult1)
 3113.  1               fs1 = mod(specmult1,1.0_r8)
 3114.  1      
 3115.  1               speccomb_planck = colh2o(lay)+refrat_planck_a*colch4(lay)
 3116.  1               specparm_planck = colh2o(lay)/speccomb_planck
 3117.  1               if (specparm_planck .ge. oneminus) specparm_planck=oneminus
 3118.  1               specmult_planck = 8._r8*specparm_planck
 3119.  1               jpl= 1 + int(specmult_planck)
 3120.  1               fpl = mod(specmult_planck,1.0_r8)
 3121.  1      
 3122.  1               ind0 = ((jp(lay)-1)*5+(jt(lay)-1))*nspa(16) + js
 3123.  1               ind1 = (jp(lay)*5+(jt1(lay)-1))*nspa(16) + js1
 3124.  1               inds = indself(lay)
 3125.  1               indf = indfor(lay)
 3126.  1      
 3127.  1               if (specparm .lt. 0.125_r8) then
 3128.  1                  p = fs - 1
 3129.  1                  p4 = p**4
 3130.  1                  fk0 = p4
 3131.  1                  fk1 = 1 - p - 2.0_r8*p4
 3132.  1                  fk2 = p + p4
 3133.  1                  fac000 = fk0*fac00(lay)
 3134.  1                  fac100 = fk1*fac00(lay)
 3135.  1                  fac200 = fk2*fac00(lay)
 3136.  1                  fac010 = fk0*fac10(lay)
 3137.  1                  fac110 = fk1*fac10(lay)
 3138.  1                  fac210 = fk2*fac10(lay)
 3139.  1               else if (specparm .gt. 0.875_r8) then
 3140.  1                  p = -fs 
 3141.  1                  p4 = p**4
 3142.  1                  fk0 = p4
 3143.  1                  fk1 = 1 - p - 2.0_r8*p4
 3144.  1                  fk2 = p + p4
 3145.  1                  fac000 = fk0*fac00(lay)
 3146.  1                  fac100 = fk1*fac00(lay)
 3147.  1                  fac200 = fk2*fac00(lay)
 3148.  1                  fac010 = fk0*fac10(lay)
 3149.  1                  fac110 = fk1*fac10(lay)
 3150.  1                  fac210 = fk2*fac10(lay)
 3151.  1               else
 3152.  1                  fac000 = (1._r8 - fs) * fac00(lay)
 3153.  1                  fac010 = (1._r8 - fs) * fac10(lay)
 3154.  1                  fac100 = fs * fac00(lay)
 3155.  1                  fac110 = fs * fac10(lay)
 3156.  1               endif
 3157.  1      
 3158.  1               if (specparm1 .lt. 0.125_r8) then
 3159.  1                  p = fs1 - 1
 3160.  1                  p4 = p**4
 3161.  1                  fk0 = p4
 3162.  1                  fk1 = 1 - p - 2.0_r8*p4
 3163.  1                  fk2 = p + p4
 3164.  1                  fac001 = fk0*fac01(lay)
 3165.  1                  fac101 = fk1*fac01(lay)
 3166.  1                  fac201 = fk2*fac01(lay)
 3167.  1                  fac011 = fk0*fac11(lay)
 3168.  1                  fac111 = fk1*fac11(lay)
 3169.  1                  fac211 = fk2*fac11(lay)
 3170.  1               else if (specparm1 .gt. 0.875_r8) then
 3171.  1                  p = -fs1 
 3172.  1                  p4 = p**4
 3173.  1                  fk0 = p4
 3174.  1                  fk1 = 1 - p - 2.0_r8*p4
 3175.  1                  fk2 = p + p4
 3176.  1                  fac001 = fk0*fac01(lay)
 3177.  1                  fac101 = fk1*fac01(lay)
 3178.  1                  fac201 = fk2*fac01(lay)
 3179.  1                  fac011 = fk0*fac11(lay)
 3180.  1                  fac111 = fk1*fac11(lay)
 3181.  1                  fac211 = fk2*fac11(lay)
 3182.  1               else
 3183.  1                  fac001 = (1._r8 - fs1) * fac01(lay)
 3184.  1                  fac011 = (1._r8 - fs1) * fac11(lay)
 3185.  1                  fac101 = fs1 * fac01(lay)
 3186.  1                  fac111 = fs1 * fac11(lay)
 3187.  1               endif
 3188.  1      
 3189.  1 2--<          do ig = 1, ng16
 3190.  1 2                tauself = selffac(lay)* (selfref(inds,ig) + selffrac(lay) * &
 3191.  1 2                     (selfref(inds+1,ig) - selfref(inds,ig)))
 3192.  1 2                taufor =  forfac(lay) * (forref(indf,ig) + forfrac(lay) * &
 3193.  1 2                     (forref(indf+1,ig) - forref(indf,ig))) 
 3194.  1 2    
 3195.  1 2                if (specparm .lt. 0.125_r8) then
 3196.  1 2                   tau_major = speccomb * &
 3197.  1 2                        (fac000 * absa(ind0,ig) + &
 3198.  1 2                        fac100 * absa(ind0+1,ig) + &
 3199.  1 2                        fac200 * absa(ind0+2,ig) + &
 3200.  1 2                        fac010 * absa(ind0+9,ig) + &
 3201.  1 2                        fac110 * absa(ind0+10,ig) + &
 3202.  1 2                        fac210 * absa(ind0+11,ig))
 3203.  1 2                else if (specparm .gt. 0.875_r8) then
 3204.  1 2                   tau_major = speccomb * &
 3205.  1 2                        (fac200 * absa(ind0-1,ig) + &
 3206.  1 2                        fac100 * absa(ind0,ig) + &
 3207.  1 2                        fac000 * absa(ind0+1,ig) + &
 3208.  1 2                        fac210 * absa(ind0+8,ig) + &
 3209.  1 2                        fac110 * absa(ind0+9,ig) + &
 3210.  1 2                        fac010 * absa(ind0+10,ig))
 3211.  1 2                else
 3212.  1 2                   tau_major = speccomb * &
 3213.  1 2                        (fac000 * absa(ind0,ig) + &
 3214.  1 2                        fac100 * absa(ind0+1,ig) + &
 3215.  1 2                        fac010 * absa(ind0+9,ig) + &
 3216.  1 2                        fac110 * absa(ind0+10,ig))
 3217.  1 2                endif
 3218.  1 2    
 3219.  1 2                if (specparm1 .lt. 0.125_r8) then
 3220.  1 2                   tau_major1 = speccomb1 * &
 3221.  1 2                        (fac001 * absa(ind1,ig) + &
 3222.  1 2                        fac101 * absa(ind1+1,ig) + &
 3223.  1 2                        fac201 * absa(ind1+2,ig) + &
 3224.  1 2                        fac011 * absa(ind1+9,ig) + &
 3225.  1 2                        fac111 * absa(ind1+10,ig) + &
 3226.  1 2                        fac211 * absa(ind1+11,ig))
 3227.  1 2                else if (specparm1 .gt. 0.875_r8) then
 3228.  1 2                   tau_major1 = speccomb1 * &
 3229.  1 2                        (fac201 * absa(ind1-1,ig) + &
 3230.  1 2                        fac101 * absa(ind1,ig) + &
 3231.  1 2                        fac001 * absa(ind1+1,ig) + &
 3232.  1 2                        fac211 * absa(ind1+8,ig) + &
 3233.  1 2                        fac111 * absa(ind1+9,ig) + &
 3234.  1 2                        fac011 * absa(ind1+10,ig))
 3235.  1 2                else
 3236.  1 2                   tau_major1 = speccomb1 * &
 3237.  1 2                        (fac001 * absa(ind1,ig) + &
 3238.  1 2                        fac101 * absa(ind1+1,ig) + &
 3239.  1 2                        fac011 * absa(ind1+9,ig) + &
 3240.  1 2                        fac111 * absa(ind1+10,ig))
 3241.  1 2                endif
 3242.  1 2    
 3243.  1 2                taug(lay,ngs15+ig) = tau_major + tau_major1 &
 3244.  1 2                     + tauself + taufor
 3245.  1 2                fracs(lay,ngs15+ig) = fracrefa(ig,jpl) + fpl * &
 3246.  1 2                     (fracrefa(ig,jpl+1)-fracrefa(ig,jpl))
 3247.  1 2-->          enddo
 3248.  1---->       enddo
 3249.         
 3250.         ! Upper atmosphere loop
 3251.  1----<       do lay = laytrop+1, nlayers
 3252.  1               ind0 = ((jp(lay)-13)*5+(jt(lay)-1))*nspb(16) + 1
 3253.  1               ind1 = ((jp(lay)-12)*5+(jt1(lay)-1))*nspb(16) + 1
 3254.  1 2--<          do ig = 1, ng16
 3255.  1 2                taug(lay,ngs15+ig) = colch4(lay) * &
 3256.  1 2                     (fac00(lay) * absb(ind0,ig) + &
 3257.  1 2                     fac10(lay) * absb(ind0+1,ig) + &
 3258.  1 2                     fac01(lay) * absb(ind1,ig) + &
 3259.  1 2                     fac11(lay) * absb(ind1+1,ig))
 3260.  1 2                fracs(lay,ngs15+ig) = fracrefb(ig)
 3261.  1 2-->          enddo
 3262.  1---->       enddo
 3263.         
 3264.               end subroutine taugb16
 3265.         
 3266.               end subroutine taumol
ftn-5004 ftn: NOTE File = rrtmg_lw_taumol.f90, Line = 3266 
  Dummy Argument "PLANKLEV" is not referenced or defined.

ftn-5004 ftn: NOTE File = rrtmg_lw_taumol.f90, Line = 3266 
  Dummy Argument "PLANKLAY" is not referenced or defined.

ftn-5004 ftn: NOTE File = rrtmg_lw_taumol.f90, Line = 3266 
  Dummy Argument "PLANKBND" is not referenced or defined.

 3267.         
 3268.               end module rrtmg_lw_taumol

ftn-6007 ftn: SCALAR File = rrtmg_lw_taumol.f90, Line = 1439 
  A loop starting at line 1439 was interchanged with the loop starting at line 1441.

ftn-6007 ftn: SCALAR File = rrtmg_lw_taumol.f90, Line = 2482 
  A loop starting at line 2482 was interchanged with the loop starting at line 2483.

ftn-6007 ftn: SCALAR File = rrtmg_lw_taumol.f90, Line = 3043 
  A loop starting at line 3043 was interchanged with the loop starting at line 3044.

 3269.         


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
             C r o s s   R e f e r e n c e   for   RRTMG_LW_TAUMOL
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name                            Storage                           Attributes
----                            -------                           ----------

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(65, 10), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     382     383     384     385

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(65, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     466     467     468     469

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(585, 16), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     678     679     680     681     682     683     686     687     688     689     690     691     694     695     696
           697     702     703     704     705     706     707     710     711     712     713     714     715     718     719
           720     721

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(585, 14), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     961     962     963     964     965     966     969     970     971     972     973     974     977     978     979
           980     985     986     987     988     989     990     993     994     995     996     997     998    1001    1002
          1003    1004

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(585, 16), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1250    1251    1252    1253    1254    1255    1258    1259    1260    1261    1262    1263    1266    1267    1268
          1269    1274    1275    1276    1277    1278    1279    1282    1283    1284    1285    1286    1287    1290    1291
          1292    1293

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(65, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1425    1426    1427    1428

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(585, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1631    1632    1633    1634    1635    1636    1639    1640    1641    1642    1643    1644    1647    1648    1649
          1650    1655    1656    1657    1658    1659    1660    1663    1664    1665    1666    1667    1668    1671    1672
          1673    1674

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(65, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1805    1806    1807    1808

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(585, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2038    2039    2040    2041    2042    2043    2046    2047    2048    2049    2050    2051    2054    2055    2056
          2057    2062    2063    2064    2065    2066    2067    2070    2071    2072    2073    2074    2075    2078    2079
          2080    2081

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(65, 6), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2168    2169    2170    2171

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(65, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2248    2249    2250    2251

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG12, DIMENSION(585, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2428    2429    2430    2431    2432    2433    2436    2437    2438    2439    2440    2441    2444    2445    2446
          2447    2452    2453    2454    2455    2456    2457    2460    2461    2462    2463    2464    2465    2468    2469
          2470    2471

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(585, 4), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2688    2689    2690    2691    2692    2693    2696    2697    2698    2699    2700    2701    2704    2705    2706
          2707    2712    2713    2714    2715    2716    2717    2720    2721    2722    2723    2724    2725    2728    2729
          2730    2731

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(65, 2), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2797    2798    2799    2800

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG15, DIMENSION(585, 2), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2988    2989    2990    2991    2992    2993    2996    2997    2998    2999    3000    3001    3004    3005    3006
          3007    3012    3013    3014    3015    3016    3017    3020    3021    3022    3023    3024    3025    3028    3029
          3030    3031

ABSA                            Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(585, 2), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    3197    3198    3199    3200    3201    3202    3205    3206    3207    3208    3209    3210    3213    3214    3215
          3216    3221    3222    3223    3224    3225    3226    3229    3230    3231    3232    3233    3234    3237    3238
          3239    3240

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(235, 10), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     408     409     410     411

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(235, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     485     486     487     488

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(1175, 16), EQUIVALENCE, SAVE
  Decl
  Set 
  Used     798     799     800     801     803     804     805     806

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(1175, 14), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1052    1053    1054    1055    1057    1058    1059    1060

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(1175, 16), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1343    1344    1345    1346    1348    1349    1350    1351

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(235, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1708    1709    1710    1711

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(235, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    1844    1845    1846    1847

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(235, 12), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2115    2116    2117    2118

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(235, 6), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2187    2188    2189    2190

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(235, 8), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2271    2272    2273    2274

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(235, 2), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    2812    2813    2814    2815

ABSB                            Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(235, 2), EQUIVALENCE, SAVE
  Decl
  Set 
  Used    3256    3257    3258    3259

ABSCO                           Stack                             REAL(KIND=8)
  Decl    2524
  Set     2684
  Used    2737

ABSCO2                          Stack                             REAL(KIND=8)
  Decl    1385
  Set     1422
  Used    1430

ABSCO2                          Stack                             REAL(KIND=8)
  Decl    1483
  Set     1627    1705
  Used    1679    1712

ABSCO2                          Stack                             REAL(KIND=8)
  Decl    1755
  Set     1798    1839
  Used    1810    1848

ABSCO2                          Stack                             REAL(KIND=8)
  Decl    2523
  Set     2679
  Used    2736

ABSN2O                          Stack                             REAL(KIND=8)
  Decl     529
  Set      674     796
  Used     726     808

ABSN2O                          Stack                             REAL(KIND=8)
  Decl    1755
  Set     1802    1841
  Used    1812    1849

ABSN2O                          Stack                             REAL(KIND=8)
  Decl    1890
  Set     2034    2112
  Used    2086    2119

ABSO3                           Stack                             REAL(KIND=8)
  Decl    1112
  Set     1246
  Used    1298

ABSO3                           Stack                             REAL(KIND=8)
  Decl    1755
  Set     1800
  Used    1811

ABSO3                           Stack                             REAL(KIND=8)
  Decl    2524
  Set     2747
  Used    2749

ADJCOLCO2                       Stack                             REAL(KIND=8)
  Decl    1384
  Set     1406    1408
  Used    1430

ADJCOLCO2                       Stack                             REAL(KIND=8)
  Decl    1484
  Set     1539    1541    1695    1697
  Used    1679    1712

ADJCOLCO2                       Stack                             REAL(KIND=8)
  Decl    1756
  Set     1782    1784    1829    1831
  Used    1810    1848

ADJCOLCO2                       Stack                             REAL(KIND=8)
  Decl    2525
  Set     2583    2585
  Used    2736

ADJCOLN2O                       Stack                             REAL(KIND=8)
  Decl     524
  Set      586     588     772     774
  Used     726     808

ADJCOLN2O                       Stack                             REAL(KIND=8)
  Decl    1891
  Set     1945    1947    2102    2104
  Used    2086    2119

ADJFAC                          Stack                             REAL(KIND=8)
  Decl     524
  Set      585     771
  Used     586     772

ADJFAC                          Stack                             REAL(KIND=8)
  Decl    1384
  Set     1405
  Used    1406

ADJFAC                          Stack                             REAL(KIND=8)
  Decl    1484
  Set     1538    1694
  Used    1539    1695

ADJFAC                          Stack                             REAL(KIND=8)
  Decl    1756
  Set     1781    1828
  Used    1782    1829

ADJFAC                          Stack                             REAL(KIND=8)
  Decl    1891
  Set     1944    2101
  Used    1945    2102

ADJFAC                          Stack                             REAL(KIND=8)
  Decl    2525
  Set     2582
  Used    2583

CCL4                            Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(16), SAVE
  Decl
  Set 
  Used    1299    1352

CFC11ADJ                        Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1431    1443

CFC12                           Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1432    1444

CFC12                           Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1813    1850

CFC22ADJ                        Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1814    1851

CHI_CO2                         Stack                             REAL(KIND=8)
  Decl    1384
  Set     1402
  Used    1403

CHI_CO2                         Stack                             REAL(KIND=8)
  Decl    1484
  Set     1535    1691
  Used    1536    1692

CHI_CO2                         Stack                             REAL(KIND=8)
  Decl    1756
  Set     1778    1825
  Used    1779    1826

CHI_CO2                         Stack                             REAL(KIND=8)
  Decl    2525
  Set     2579
  Used    2580

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used     539     542     545     548     583     586     769     772

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used     852     855

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    1125    1128    1131

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    1403    1406

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    1497    1500    1536    1539    1692    1695

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    1779    1782    1826    1829

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    1904    1907    1942    1945    2099    2102

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    2322

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    2539    2542    2545

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    2865    2868

CHI_MLS                         Use assoc                         REAL(KIND=8), From module RRLW_REF, DIMENSION(7, 59), SAVE
  Decl
  Set 
  Used    3091

CHI_N2O                         Stack                             REAL(KIND=8)
  Decl     524
  Set      582     768
  Used     583     769

CHI_N2O                         Stack                             REAL(KIND=8)
  Decl    1891
  Set     1941    2098
  Used    1942    2099

CO2M1                           Stack                             REAL(KIND=8)
  Decl    1483
  Set     1623
  Used    1627

CO2M1                           Stack                             REAL(KIND=8)
  Decl    2523
  Set     2675
  Used    2679

CO2M2                           Stack                             REAL(KIND=8)
  Decl    1483
  Set     1625
  Used    1627

CO2M2                           Stack                             REAL(KIND=8)
  Decl    2523
  Set     2677
  Used    2679

COLBRD                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      51     253
  Set 
  Used     373     401    2912

COLCH4                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      49     249
  Set 
  Used    1917    1924    1931    1950    2114    3101    3108    3115    3255

COLCO                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      48     247
  Set 
  Used    2737

COLCO2                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      45     241
  Set 
  Used     558     565     572     591     735     742     758     777     865     872     879    1017    1024    1040    1141
          1148    1155    1162    1308    1315    1331    1402    1408    1535    1541    1691    1697    1778    1784    1825
          1831    2332    2339    2346    2579    2585    2796    2811    2878    2885    2892    2899

COLDRY                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      36     222
  Set 
  Used     582     586     768     772    1402    1406    1535    1539    1691    1695    1778    1782    1825    1829    1941
          1945    2098    2102    2579    2583

COLH2O                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      44     239
  Set 
  Used     381     407     465     484     558     559     565     566     572     573     591     592     735     736     742
           743     758     759     777     778     865     866     872     873     879     880    1141    1142    1148    1149
          1155    1156    1162    1163    1424    1510    1511    1517    1518    1524    1525    1544    1545    1804    1917
          1918    1924    1925    1931    1932    1950    1951    2167    2186    2247    2270    2332    2333    2339    2340
          2346    2347    2555    2556    2562    2563    2569    2570    2588    2589    2595    2596    3101    3102    3108
          3109    3115    3116

COLN2O                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      47     245
  Set 
  Used     582     588     768     774    1812    1849    1941    1947    2098    2104    2555    2562    2569    2588    2595
          2878    2879    2885    2886    2892    2893    2899    2900

COLO2                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      50     251
  Set 
  Used    2239    2264

COLO3                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      46     243
  Set 
  Used    1017    1018    1024    1025    1040    1041    1298    1308    1309    1315    1316    1331    1332    1510    1517
          1524    1544    1707    1811    1843    2749

COM1                            Stack                             REAL(KIND=8)
  Decl    2524
  Set     2680
  Used    2684

COM2                            Stack                             REAL(KIND=8)
  Decl    2524
  Set     2682
  Used    2684

CORRADJ                         Stack                             REAL(KIND=8)
  Decl     348
  Set      368     370     399
  Used     381     407

CORRADJ                         Stack                             REAL(KIND=8)
  Decl     444
  Set      459
  Used     465

FAC00                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      52     279
  Set 
  Used     382     408     466     485     610     611     612     622     623     624     629     631     749     751     897
           898     899     909     910     911     916     918    1031    1033    1181    1182    1183    1193    1194    1195
          1200    1202    1322    1324    1425    1563    1564    1565    1575    1576    1577    1582    1584    1708    1805
          1844    1969    1970    1971    1981    1982    1983    1988    1990    2115    2168    2187    2248    2271    2364
          2365    2366    2376    2377    2378    2383    2385    2614    2615    2616    2626    2627    2628    2633    2635
          2797    2812    2920    2921    2922    2932    2933    2934    2939    2941    3133    3134    3135    3145    3146
          3147    3152    3154    3256

FAC000                          Stack                             REAL(KIND=8)
  Decl     527
  Set      610     622     629     749
  Used     678     688     694     798

FAC000                          Stack                             REAL(KIND=8)
  Decl     844
  Set      897     909     916    1031
  Used     961     971     977    1052

FAC000                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1181    1193    1200    1322
  Used    1250    1260    1266    1343

FAC000                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1563    1575    1582
  Used    1631    1641    1647

FAC000                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1969    1981    1988
  Used    2038    2048    2054

FAC000                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2364    2376    2383
  Used    2428    2438    2444

FAC000                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2614    2626    2633
  Used    2688    2698    2704

FAC000                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2920    2932    2939
  Used    2988    2998    3004

FAC000                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3133    3145    3152
  Used    3197    3207    3213

FAC001                          Stack                             REAL(KIND=8)
  Decl     528
  Set      640     652     659     753
  Used     702     712     718     803

FAC001                          Stack                             REAL(KIND=8)
  Decl     845
  Set      928     940     947    1035
  Used     985     995    1001    1057

FAC001                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1212    1224    1231    1326
  Used    1274    1284    1290    1348

FAC001                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1593    1605    1612
  Used    1655    1665    1671

FAC001                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2000    2012    2019
  Used    2062    2072    2078

FAC001                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2395    2407    2414
  Used    2452    2462    2468

FAC001                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2645    2657    2664
  Used    2712    2722    2728

FAC001                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2950    2962    2969
  Used    3012    3022    3028

FAC001                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3164    3176    3183
  Used    3221    3231    3237

FAC01                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      53     279
  Set 
  Used     384     410     468     487     640     641     642     652     653     654     659     661     753     755     928
           929     930     940     941     942     947     949    1035    1037    1212    1213    1214    1224    1225    1226
          1231    1233    1326    1328    1427    1593    1594    1595    1605    1606    1607    1612    1614    1710    1807
          1846    2000    2001    2002    2012    2013    2014    2019    2021    2117    2170    2189    2250    2273    2395
          2396    2397    2407    2408    2409    2414    2416    2645    2646    2647    2657    2658    2659    2664    2666
          2799    2814    2950    2951    2952    2962    2963    2964    2969    2971    3164    3165    3166    3176    3177
          3178    3183    3185    3258

FAC010                          Stack                             REAL(KIND=8)
  Decl     527
  Set      613     625     630     750
  Used     681     691     696     800

FAC010                          Stack                             REAL(KIND=8)
  Decl     844
  Set      900     912     917    1032
  Used     964     974     979    1054

FAC010                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1184    1196    1201    1323
  Used    1253    1263    1268    1345

FAC010                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1566    1578    1583
  Used    1634    1644    1649

FAC010                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1972    1984    1989
  Used    2041    2051    2056

FAC010                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2367    2379    2384
  Used    2431    2441    2446

FAC010                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2617    2629    2634
  Used    2691    2701    2706

FAC010                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2923    2935    2940
  Used    2991    3001    3006

FAC010                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3136    3148    3153
  Used    3200    3210    3215

FAC011                          Stack                             REAL(KIND=8)
  Decl     528
  Set      643     655     660     754
  Used     705     715     720     805

FAC011                          Stack                             REAL(KIND=8)
  Decl     845
  Set      931     943     948    1036
  Used     988     998    1003    1059

FAC011                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1215    1227    1232    1327
  Used    1277    1287    1292    1350

FAC011                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1596    1608    1613
  Used    1658    1668    1673

FAC011                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2003    2015    2020
  Used    2065    2075    2080

FAC011                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2398    2410    2415
  Used    2455    2465    2470

FAC011                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2648    2660    2665
  Used    2715    2725    2730

FAC011                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2953    2965    2970
  Used    3015    3025    3030

FAC011                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3167    3179    3184
  Used    3224    3234    3239

FAC10                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      54     280
  Set 
  Used     383     409     467     486     613     614     615     625     626     627     630     632     750     752     900
           901     902     912     913     914     917     919    1032    1034    1184    1185    1186    1196    1197    1198
          1201    1203    1323    1325    1426    1566    1567    1568    1578    1579    1580    1583    1585    1709    1806
          1845    1972    1973    1974    1984    1985    1986    1989    1991    2116    2169    2188    2249    2272    2367
          2368    2369    2379    2380    2381    2384    2386    2617    2618    2619    2629    2630    2631    2634    2636
          2798    2813    2923    2924    2925    2935    2936    2937    2940    2942    3136    3137    3138    3148    3149
          3150    3153    3155    3257

FAC100                          Stack                             REAL(KIND=8)
  Decl     527
  Set      611     623     631     751
  Used     679     687     695     799

FAC100                          Stack                             REAL(KIND=8)
  Decl     844
  Set      898     910     918    1033
  Used     962     970     978    1053

FAC100                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1182    1194    1202    1324
  Used    1251    1259    1267    1344

FAC100                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1564    1576    1584
  Used    1632    1640    1648

FAC100                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1970    1982    1990
  Used    2039    2047    2055

FAC100                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2365    2377    2385
  Used    2429    2437    2445

FAC100                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2615    2627    2635
  Used    2689    2697    2705

FAC100                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2921    2933    2941
  Used    2989    2997    3005

FAC100                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3134    3146    3154
  Used    3198    3206    3214

FAC101                          Stack                             REAL(KIND=8)
  Decl     528
  Set      641     653     661     755
  Used     703     711     719     804

FAC101                          Stack                             REAL(KIND=8)
  Decl     845
  Set      929     941     949    1037
  Used     986     994    1002    1058

FAC101                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1213    1225    1233    1328
  Used    1275    1283    1291    1349

FAC101                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1594    1606    1614
  Used    1656    1664    1672

FAC101                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2001    2013    2021
  Used    2063    2071    2079

FAC101                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2396    2408    2416
  Used    2453    2461    2469

FAC101                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2646    2658    2666
  Used    2713    2721    2729

FAC101                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2951    2963    2971
  Used    3013    3021    3029

FAC101                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3165    3177    3185
  Used    3222    3230    3238

FAC11                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      55     280
  Set 
  Used     385     411     469     488     643     644     645     655     656     657     660     662     754     756     931
           932     933     943     944     945     948     950    1036    1038    1215    1216    1217    1227    1228    1229
          1232    1234    1327    1329    1428    1596    1597    1598    1608    1609    1610    1613    1615    1711    1808
          1847    2003    2004    2005    2015    2016    2017    2020    2022    2118    2171    2190    2251    2274    2398
          2399    2400    2410    2411    2412    2415    2417    2648    2649    2650    2660    2661    2662    2665    2667
          2800    2815    2953    2954    2955    2965    2966    2967    2970    2972    3167    3168    3169    3179    3180
          3181    3184    3186    3259

FAC110                          Stack                             REAL(KIND=8)
  Decl     527
  Set      614     626     632     752
  Used     682     690     697     801

FAC110                          Stack                             REAL(KIND=8)
  Decl     844
  Set      901     913     919    1034
  Used     965     973     980    1055

FAC110                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1185    1197    1203    1325
  Used    1254    1262    1269    1346

FAC110                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1567    1579    1585
  Used    1635    1643    1650

FAC110                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1973    1985    1991
  Used    2042    2050    2057

FAC110                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2368    2380    2386
  Used    2432    2440    2447

FAC110                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2618    2630    2636
  Used    2692    2700    2707

FAC110                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2924    2936    2942
  Used    2992    3000    3007

FAC110                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3137    3149    3155
  Used    3201    3209    3216

FAC111                          Stack                             REAL(KIND=8)
  Decl     528
  Set      644     656     662     756
  Used     706     714     721     806

FAC111                          Stack                             REAL(KIND=8)
  Decl     845
  Set      932     944     950    1038
  Used     989     997    1004    1060

FAC111                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1216    1228    1234    1329
  Used    1278    1286    1293    1351

FAC111                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1597    1609    1615
  Used    1659    1667    1674

FAC111                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2004    2016    2022
  Used    2066    2074    2081

FAC111                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2399    2411    2417
  Used    2456    2464    2471

FAC111                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2649    2661    2667
  Used    2716    2724    2731

FAC111                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2954    2966    2972
  Used    3016    3024    3031

FAC111                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3168    3180    3186
  Used    3225    3233    3240

FAC200                          Stack                             REAL(KIND=8)
  Decl     527
  Set      612     624
  Used     680     686

FAC200                          Stack                             REAL(KIND=8)
  Decl     844
  Set      899     911
  Used     963     969

FAC200                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1183    1195
  Used    1252    1258

FAC200                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1565    1577
  Used    1633    1639

FAC200                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1971    1983
  Used    2040    2046

FAC200                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2366    2378
  Used    2430    2436

FAC200                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2616    2628
  Used    2690    2696

FAC200                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2922    2934
  Used    2990    2996

FAC200                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3135    3147
  Used    3199    3205

FAC201                          Stack                             REAL(KIND=8)
  Decl     528
  Set      642     654
  Used     704     710

FAC201                          Stack                             REAL(KIND=8)
  Decl     845
  Set      930     942
  Used     987     993

FAC201                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1214    1226
  Used    1276    1282

FAC201                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1595    1607
  Used    1657    1663

FAC201                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2002    2014
  Used    2064    2070

FAC201                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2397    2409
  Used    2454    2460

FAC201                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2647    2659
  Used    2714    2720

FAC201                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2952    2964
  Used    3014    3020

FAC201                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3166    3178
  Used    3223    3229

FAC210                          Stack                             REAL(KIND=8)
  Decl     527
  Set      615     627
  Used     683     689

FAC210                          Stack                             REAL(KIND=8)
  Decl     844
  Set      902     914
  Used     966     972

FAC210                          Stack                             REAL(KIND=8)
  Decl    1110
  Set     1186    1198
  Used    1255    1261

FAC210                          Stack                             REAL(KIND=8)
  Decl    1481
  Set     1568    1580
  Used    1636    1642

FAC210                          Stack                             REAL(KIND=8)
  Decl    1888
  Set     1974    1986
  Used    2043    2049

FAC210                          Stack                             REAL(KIND=8)
  Decl    2311
  Set     2369    2381
  Used    2433    2439

FAC210                          Stack                             REAL(KIND=8)
  Decl    2521
  Set     2619    2631
  Used    2693    2699

FAC210                          Stack                             REAL(KIND=8)
  Decl    2852
  Set     2925    2937
  Used    2993    2999

FAC210                          Stack                             REAL(KIND=8)
  Decl    3080
  Set     3138    3150
  Used    3202    3208

FAC211                          Stack                             REAL(KIND=8)
  Decl     528
  Set      645     657
  Used     707     713

FAC211                          Stack                             REAL(KIND=8)
  Decl     845
  Set      933     945
  Used     990     996

FAC211                          Stack                             REAL(KIND=8)
  Decl    1111
  Set     1217    1229
  Used    1279    1285

FAC211                          Stack                             REAL(KIND=8)
  Decl    1482
  Set     1598    1610
  Used    1660    1666

FAC211                          Stack                             REAL(KIND=8)
  Decl    1889
  Set     2005    2017
  Used    2067    2073

FAC211                          Stack                             REAL(KIND=8)
  Decl    2312
  Set     2400    2412
  Used    2457    2463

FAC211                          Stack                             REAL(KIND=8)
  Decl    2522
  Set     2650    2662
  Used    2717    2723

FAC211                          Stack                             REAL(KIND=8)
  Decl    2853
  Set     2955    2967
  Used    3017    3023

FAC211                          Stack                             REAL(KIND=8)
  Decl    3081
  Set     3169    3181
  Used    3226    3232

FK0                             Stack                             REAL(KIND=8)
  Decl     526
  Set      607     619     637     649
  Used     610     613     622     625     640     643     652     655

FK0                             Stack                             REAL(KIND=8)
  Decl     843
  Set      894     906     925     937
  Used     897     900     909     912     928     931     940     943

FK0                             Stack                             REAL(KIND=8)
  Decl    1109
  Set     1178    1190    1209    1221
  Used    1181    1184    1193    1196    1212    1215    1224    1227

FK0                             Stack                             REAL(KIND=8)
  Decl    1480
  Set     1560    1572    1590    1602
  Used    1563    1566    1575    1578    1593    1596    1605    1608

FK0                             Stack                             REAL(KIND=8)
  Decl    1887
  Set     1966    1978    1997    2009
  Used    1969    1972    1981    1984    2000    2003    2012    2015

FK0                             Stack                             REAL(KIND=8)
  Decl    2310
  Set     2361    2373    2392    2404
  Used    2364    2367    2376    2379    2395    2398    2407    2410

FK0                             Stack                             REAL(KIND=8)
  Decl    2520
  Set     2611    2623    2642    2654
  Used    2614    2617    2626    2629    2645    2648    2657    2660

FK0                             Stack                             REAL(KIND=8)
  Decl    2851
  Set     2917    2929    2947    2959
  Used    2920    2923    2932    2935    2950    2953    2962    2965

FK0                             Stack                             REAL(KIND=8)
  Decl    3079
  Set     3130    3142    3161    3173
  Used    3133    3136    3145    3148    3164    3167    3176    3179

FK1                             Stack                             REAL(KIND=8)
  Decl     526
  Set      608     620     638     650
  Used     611     614     623     626     641     644     653     656

FK1                             Stack                             REAL(KIND=8)
  Decl     843
  Set      895     907     926     938
  Used     898     901     910     913     929     932     941     944

FK1                             Stack                             REAL(KIND=8)
  Decl    1109
  Set     1179    1191    1210    1222
  Used    1182    1185    1194    1197    1213    1216    1225    1228

FK1                             Stack                             REAL(KIND=8)
  Decl    1480
  Set     1561    1573    1591    1603
  Used    1564    1567    1576    1579    1594    1597    1606    1609

FK1                             Stack                             REAL(KIND=8)
  Decl    1887
  Set     1967    1979    1998    2010
  Used    1970    1973    1982    1985    2001    2004    2013    2016

FK1                             Stack                             REAL(KIND=8)
  Decl    2310
  Set     2362    2374    2393    2405
  Used    2365    2368    2377    2380    2396    2399    2408    2411

FK1                             Stack                             REAL(KIND=8)
  Decl    2520
  Set     2612    2624    2643    2655
  Used    2615    2618    2627    2630    2646    2649    2658    2661

FK1                             Stack                             REAL(KIND=8)
  Decl    2851
  Set     2918    2930    2948    2960
  Used    2921    2924    2933    2936    2951    2954    2963    2966

FK1                             Stack                             REAL(KIND=8)
  Decl    3079
  Set     3131    3143    3162    3174
  Used    3134    3137    3146    3149    3165    3168    3177    3180

FK2                             Stack                             REAL(KIND=8)
  Decl     526
  Set      609     621     639     651
  Used     612     615     624     627     642     645     654     657

FK2                             Stack                             REAL(KIND=8)
  Decl     843
  Set      896     908     927     939
  Used     899     902     911     914     930     933     942     945

FK2                             Stack                             REAL(KIND=8)
  Decl    1109
  Set     1180    1192    1211    1223
  Used    1183    1186    1195    1198    1214    1217    1226    1229

FK2                             Stack                             REAL(KIND=8)
  Decl    1480
  Set     1562    1574    1592    1604
  Used    1565    1568    1577    1580    1595    1598    1607    1610

FK2                             Stack                             REAL(KIND=8)
  Decl    1887
  Set     1968    1980    1999    2011
  Used    1971    1974    1983    1986    2002    2005    2014    2017

FK2                             Stack                             REAL(KIND=8)
  Decl    2310
  Set     2363    2375    2394    2406
  Used    2366    2369    2378    2381    2397    2400    2409    2412

FK2                             Stack                             REAL(KIND=8)
  Decl    2520
  Set     2613    2625    2644    2656
  Used    2616    2619    2628    2631    2647    2650    2659    2662

FK2                             Stack                             REAL(KIND=8)
  Decl    2851
  Set     2919    2931    2949    2961
  Used    2922    2925    2934    2937    2952    2955    2964    2967

FK2                             Stack                             REAL(KIND=8)
  Decl    3079
  Set     3132    3144    3163    3175
  Used    3135    3138    3147    3150    3166    3169    3178    3181

FMCO                            Stack                             REAL(KIND=8)
  Decl    2518
  Set     2593
  Used    2680    2682

FMCO2                           Stack                             REAL(KIND=8)
  Decl    1478
  Set     1530
  Used    1623    1625

FMCO2                           Stack                             REAL(KIND=8)
  Decl    2517
  Set     2574
  Used    2675    2677

FMN2                            Stack                             REAL(KIND=8)
  Decl    2849
  Set     2897
  Used    2980    2982

FMN2O                           Stack                             REAL(KIND=8)
  Decl     524
  Set      577     763
  Used     578     670     672     764     792     794

FMN2O                           Stack                             REAL(KIND=8)
  Decl    1885
  Set     1936
  Used    2030    2032

FMN2OMF                         Stack                             REAL(KIND=8)
  Decl     524
  Set      578     764
  Used

FMO3                            Stack                             REAL(KIND=8)
  Decl    1107
  Set     1160
  Used    1242    1244

FORFAC                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      71     264
  Set 
  Used     377     403     463     482     668     790     956    1240    1420    1621    1796    2028    2165    2184    2243
          2266    2423    2673    2794    2978    3192

FORFRAC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      72     266
  Set 
  Used     377     404     463     483     668     791     956    1240    1420    1621    1796    2028    2165    2184    2243
          2266    2423    2673    2794    2978    3192

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(4, 10), SAVE
  Decl
  Set 
  Used     377     378     403     404

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(4, 12), SAVE
  Decl
  Set 
  Used     463     464     482     483

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(4, 16), SAVE
  Decl
  Set 
  Used     668     669     790     791

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(4, 14), SAVE
  Decl
  Set 
  Used     956     957

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(4, 16), SAVE
  Decl
  Set 
  Used    1240    1241

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(4, 8), SAVE
  Decl
  Set 
  Used    1420    1421

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(4, 12), SAVE
  Decl
  Set 
  Used    1621    1622

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(4, 8), SAVE
  Decl
  Set 
  Used    1796    1797

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(4, 12), SAVE
  Decl
  Set 
  Used    2028    2029

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(4, 6), SAVE
  Decl
  Set 
  Used    2165    2166    2184    2185

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(4, 8), SAVE
  Decl
  Set 
  Used    2243    2244    2266    2267

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG12, DIMENSION(4, 8), SAVE
  Decl
  Set 
  Used    2423    2424

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(4, 4), SAVE
  Decl
  Set 
  Used    2673    2674

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(4, 2), SAVE
  Decl
  Set 
  Used    2794    2795

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG15, DIMENSION(4, 2), SAVE
  Decl
  Set 
  Used    2978    2979

FORREF                          Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(4, 2), SAVE
  Decl
  Set 
  Used    3192    3193

FPL                             Stack                             REAL(KIND=8)
  Decl     525
  Set      596     782
  Used     727     809

FPL                             Stack                             REAL(KIND=8)
  Decl     842
  Set      884    1045
  Used    1009    1061

FPL                             Stack                             REAL(KIND=8)
  Decl    1108
  Set     1167    1336
  Used    1300    1353

FPL                             Stack                             REAL(KIND=8)
  Decl    1479
  Set     1549
  Used    1680

FPL                             Stack                             REAL(KIND=8)
  Decl    1886
  Set     1955
  Used    2087

FPL                             Stack                             REAL(KIND=8)
  Decl    2309
  Set     2351
  Used    2476

FPL                             Stack                             REAL(KIND=8)
  Decl    2519
  Set     2600
  Used    2738

FPL                             Stack                             REAL(KIND=8)
  Decl    2850
  Set     2904
  Used    3037

FPL                             Stack                             REAL(KIND=8)
  Decl    3078
  Set     3120
  Used    3245

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(10), SAVE
  Decl
  Set 
  Used     387

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(12), SAVE
  Decl
  Set 
  Used     471

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(16, 10), SAVE
  Decl
  Set 
  Used     727     728

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(14, 9), SAVE
  Decl
  Set 
  Used    1009    1010

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(16, 9), SAVE
  Decl
  Set 
  Used    1300    1301

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1433    1445

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(12, 9), SAVE
  Decl
  Set 
  Used    1680    1681

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1815

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(12, 9), SAVE
  Decl
  Set 
  Used    2087    2088

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(6), SAVE
  Decl
  Set 
  Used    2173

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(8), SAVE
  Decl
  Set 
  Used    2254

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG12, DIMENSION(8, 9), SAVE
  Decl
  Set 
  Used    2476    2477

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(4, 9), SAVE
  Decl
  Set 
  Used    2738    2739

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(2), SAVE
  Decl
  Set 
  Used    2802

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG15, DIMENSION(2, 9), SAVE
  Decl
  Set 
  Used    3037    3038

FRACREFA                        Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(2, 9), SAVE
  Decl
  Set 
  Used    3245    3246

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(10), SAVE
  Decl
  Set 
  Used     413

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(12), SAVE
  Decl
  Set 
  Used     490

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(16, 5), SAVE
  Decl
  Set 
  Used     809     810

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(14, 6), SAVE
  Decl
  Set 
  Used    1061    1062

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(16, 5), SAVE
  Decl
  Set 
  Used    1353    1354

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(12), SAVE
  Decl
  Set 
  Used    1713

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(8), SAVE
  Decl
  Set 
  Used    1852

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(12), SAVE
  Decl
  Set 
  Used    2120

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(6), SAVE
  Decl
  Set 
  Used    2192

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(8), SAVE
  Decl
  Set 
  Used    2277

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(4), SAVE
  Decl
  Set 
  Used    2750

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(2), SAVE
  Decl
  Set 
  Used    2816

FRACREFB                        Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(2), SAVE
  Decl
  Set 
  Used    3260

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 140), INTENT(OUT)
  Decl      78     290
  Set 
  Used     299     300     301     302     303     304     305     306     307     308     309     310     311     312     313
           314

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     319     343
  Set      387     413
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     420     439
  Set      471     490
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     497     515
  Set      727     809
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     817     834
  Set     1009    1061
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1081    1099
  Set     1300    1353
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1361    1379
  Set     1433    1445
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1452    1470
  Set     1680    1713
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1731    1750
  Set     1815    1852
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1859    1877
  Set     2087    2120
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2127    2143
  Set     2173    2192
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2199    2216
  Set     2254    2277
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2284    2301
  Set     2476    2485
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2492    2509
  Set     2738    2750
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2757    2773
  Set     2802    2816
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2823    2841
  Set     3037    3046
  Used

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    3053    3070
  Set     3245    3260
  Used

FS                              Stack                             REAL(KIND=8)
  Decl     521
  Set      563     740
  Used     605     617     629     630     631     632     749     750     751     752

FS                              Stack                             REAL(KIND=8)
  Decl     840
  Set      870    1022
  Used     892     904     916     917     918     919    1031    1032    1033    1034

FS                              Stack                             REAL(KIND=8)
  Decl    1105
  Set     1146    1313
  Used    1176    1188    1200    1201    1202    1203    1322    1323    1324    1325

FS                              Stack                             REAL(KIND=8)
  Decl    1476
  Set     1515
  Used    1558    1570    1582    1583    1584    1585

FS                              Stack                             REAL(KIND=8)
  Decl    1883
  Set     1922
  Used    1964    1976    1988    1989    1990    1991

FS                              Stack                             REAL(KIND=8)
  Decl    2307
  Set     2337
  Used    2359    2371    2383    2384    2385    2386

FS                              Stack                             REAL(KIND=8)
  Decl    2515
  Set     2560
  Used    2609    2621    2633    2634    2635    2636

FS                              Stack                             REAL(KIND=8)
  Decl    2847
  Set     2883
  Used    2915    2927    2939    2940    2941    2942

FS                              Stack                             REAL(KIND=8)
  Decl    3076
  Set     3106
  Used    3128    3140    3152    3153    3154    3155

FS1                             Stack                             REAL(KIND=8)
  Decl     522
  Set      570     747
  Used     635     647     659     660     661     662     753     754     755     756

FS1                             Stack                             REAL(KIND=8)
  Decl     841
  Set      877    1029
  Used     923     935     947     948     949     950    1035    1036    1037    1038

FS1                             Stack                             REAL(KIND=8)
  Decl    1106
  Set     1153    1320
  Used    1207    1219    1231    1232    1233    1234    1326    1327    1328    1329

FS1                             Stack                             REAL(KIND=8)
  Decl    1477
  Set     1522
  Used    1588    1600    1612    1613    1614    1615

FS1                             Stack                             REAL(KIND=8)
  Decl    1884
  Set     1929
  Used    1995    2007    2019    2020    2021    2022

FS1                             Stack                             REAL(KIND=8)
  Decl    2308
  Set     2344
  Used    2390    2402    2414    2415    2416    2417

FS1                             Stack                             REAL(KIND=8)
  Decl    2516
  Set     2567
  Used    2640    2652    2664    2665    2666    2667

FS1                             Stack                             REAL(KIND=8)
  Decl    2848
  Set     2890
  Used    2945    2957    2969    2970    2971    2972

FS1                             Stack                             REAL(KIND=8)
  Decl    3077
  Set     3113
  Used    3159    3171    3183    3184    3185    3186

HVRTAU                          Use assoc                         CHARACTER(18), From module RRLW_VSN, SAVE
  Decl
  Set      295
  Used

IG                              Stack                             INTEGER
  Decl     347
  Set 
  Used     375     376     377     378     379     380     381     382     383     384     385     387     403     404     405
           406     407     408     409     410     411     413

IG                              Stack                             INTEGER
  Decl     443
  Set 
  Used     461     462     463     464     465     466     467     468     469     471     482     483     484     485     486
           487     488     490

IG                              Stack                             INTEGER
  Decl     519
  Set 
  Used     666     667     668     669     670     671     672     673     678     679     680     681     682     683     686
           687     688     689     690     691     694     695     696     697     702     703     704     705     706     707
           710     711     712     713     714     715     718     719     720     721     724     727     728     790     791
           792     793     794     795     797     798     799     800     801     803     804     805     806     809     810

IG                              Stack                             INTEGER
  Decl     838
  Set 
  Used     954     955     956     957     961     962     963     964     965     966     969     970     971     972     973
           974     977     978     979     980     985     986     987     988     989     990     993     994     995     996
           997     998    1001    1002    1003    1004    1007    1009    1010    1051    1052    1053    1054    1055    1057
          1058    1059    1060    1061    1062

IG                              Stack                             INTEGER
  Decl    1103
  Set 
  Used    1238    1239    1240    1241    1242    1243    1244    1245    1250    1251    1252    1253    1254    1255    1258
          1259    1260    1261    1262    1263    1266    1267    1268    1269    1274    1275    1276    1277    1278    1279
          1282    1283    1284    1285    1286    1287    1290    1291    1292    1293    1296    1299    1300    1301    1342
          1343    1344    1345    1346    1348    1349    1350    1351    1352    1353    1354

IG                              Stack                             INTEGER
  Decl    1383
  Set 
  Used    1418    1419    1420    1421    1422    1423    1424    1425    1426    1427    1428    1431    1432    1433    1442
          1443    1444    1445

IG                              Stack                             INTEGER
  Decl    1474
  Set 
  Used    1619    1620    1621    1622    1623    1624    1625    1626    1631    1632    1633    1634    1635    1636    1639
          1640    1641    1642    1643    1644    1647    1648    1649    1650    1655    1656    1657    1658    1659    1660
          1663    1664    1665    1666    1667    1668    1671    1672    1673    1674    1677    1680    1681    1705    1706
          1707    1708    1709    1710    1711    1713

IG                              Stack                             INTEGER
  Decl    1754
  Set 
  Used    1794    1795    1796    1797    1798    1799    1800    1801    1802    1803    1804    1805    1806    1807    1808
          1813    1814    1815    1839    1840    1841    1842    1843    1844    1845    1846    1847    1850    1851    1852

IG                              Stack                             INTEGER
  Decl    1881
  Set 
  Used    2026    2027    2028    2029    2030    2031    2032    2033    2038    2039    2040    2041    2042    2043    2046
          2047    2048    2049    2050    2051    2054    2055    2056    2057    2062    2063    2064    2065    2066    2067
          2070    2071    2072    2073    2074    2075    2078    2079    2080    2081    2084    2087    2088    2112    2113
          2114    2115    2116    2117    2118    2120

IG                              Stack                             INTEGER
  Decl    2147
  Set 
  Used    2163    2164    2165    2166    2167    2168    2169    2170    2171    2173    2184    2185    2186    2187    2188
          2189    2190    2192

IG                              Stack                             INTEGER
  Decl    2220
  Set 
  Used    2241    2242    2243    2244    2245    2246    2247    2248    2249    2250    2251    2254    2266    2267    2268
          2269    2270    2271    2272    2273    2274    2277

IG                              Stack                             INTEGER
  Decl    2305
  Set 
  Used    2421    2422    2423    2424    2428    2429    2430    2431    2432    2433    2436    2437    2438    2439    2440
          2441    2444    2445    2446    2447    2452    2453    2454    2455    2456    2457    2460    2461    2462    2463
          2464    2465    2468    2469    2470    2471    2474    2476    2477    2484    2485

IG                              Stack                             INTEGER
  Decl    2513
  Set 
  Used    2671    2672    2673    2674    2675    2676    2677    2678    2680    2681    2682    2683    2688    2689    2690
          2691    2692    2693    2696    2697    2698    2699    2700    2701    2704    2705    2706    2707    2712    2713
          2714    2715    2716    2717    2720    2721    2722    2723    2724    2725    2728    2729    2730    2731    2734
          2738    2739    2747    2748    2749    2750

IG                              Stack                             INTEGER
  Decl    2777
  Set 
  Used    2792    2793    2794    2795    2796    2797    2798    2799    2800    2802    2811    2812    2813    2814    2815
          2816

IG                              Stack                             INTEGER
  Decl    2845
  Set 
  Used    2976    2977    2978    2979    2980    2981    2982    2983    2988    2989    2990    2991    2992    2993    2996
          2997    2998    2999    3000    3001    3004    3005    3006    3007    3012    3013    3014    3015    3016    3017
          3020    3021    3022    3023    3024    3025    3028    3029    3030    3031    3034    3037    3038    3045    3046

IG                              Stack                             INTEGER
  Decl    3074
  Set 
  Used    3190    3191    3192    3193    3197    3198    3199    3200    3201    3202    3205    3206    3207    3208    3209
          3210    3213    3214    3215    3216    3221    3222    3223    3224    3225    3226    3229    3230    3231    3232
          3233    3234    3237    3238    3239    3240    3243    3245    3246    3255    3256    3257    3258    3259    3260

IND0                            Stack                             INTEGER
  Decl     347
  Set      362     394
  Used     382     383     408     409

IND0                            Stack                             INTEGER
  Decl     443
  Set      454     478
  Used     466     467     485     486

IND0                            Stack                             INTEGER
  Decl     519
  Set      598     784
  Used     678     679     680     681     682     683     686     687     688     689     690     691     694     695     696
           697     798     799     800     801

IND0                            Stack                             INTEGER
  Decl     838
  Set      886    1047
  Used     961     962     963     964     965     966     969     970     971     972     973     974     977     978     979
           980    1052    1053    1054    1055

IND0                            Stack                             INTEGER
  Decl    1103
  Set     1169    1338
  Used    1250    1251    1252    1253    1254    1255    1258    1259    1260    1261    1262    1263    1266    1267    1268
          1269    1343    1344    1345    1346

IND0                            Stack                             INTEGER
  Decl    1383
  Set     1411
  Used    1425    1426

IND0                            Stack                             INTEGER
  Decl    1474
  Set     1551    1700
  Used    1631    1632    1633    1634    1635    1636    1639    1640    1641    1642    1643    1644    1647    1648    1649
          1650    1708    1709

IND0                            Stack                             INTEGER
  Decl    1754
  Set     1787    1834
  Used    1805    1806    1844    1845

IND0                            Stack                             INTEGER
  Decl    1881
  Set     1957    2107
  Used    2038    2039    2040    2041    2042    2043    2046    2047    2048    2049    2050    2051    2054    2055    2056
          2057    2115    2116

IND0                            Stack                             INTEGER
  Decl    2147
  Set     2157    2179
  Used    2168    2169    2187    2188

IND0                            Stack                             INTEGER
  Decl    2220
  Set     2234    2260
  Used    2248    2249    2271    2272

IND0                            Stack                             INTEGER
  Decl    2305
  Set     2353
  Used    2428    2429    2430    2431    2432    2433    2436    2437    2438    2439    2440    2441    2444    2445    2446
          2447

IND0                            Stack                             INTEGER
  Decl    2513
  Set     2602
  Used    2688    2689    2690    2691    2692    2693    2696    2697    2698    2699    2700    2701    2704    2705    2706
          2707

IND0                            Stack                             INTEGER
  Decl    2777
  Set     2787    2808
  Used    2797    2798    2812    2813

IND0                            Stack                             INTEGER
  Decl    2845
  Set     2906
  Used    2988    2989    2990    2991    2992    2993    2996    2997    2998    2999    3000    3001    3004    3005    3006
          3007

IND0                            Stack                             INTEGER
  Decl    3074
  Set     3122    3252
  Used    3197    3198    3199    3200    3201    3202    3205    3206    3207    3208    3209    3210    3213    3214    3215
          3216    3256    3257

IND1                            Stack                             INTEGER
  Decl     347
  Set      363     395
  Used     384     385     410     411

IND1                            Stack                             INTEGER
  Decl     443
  Set      455     479
  Used     468     469     487     488

IND1                            Stack                             INTEGER
  Decl     519
  Set      599     785
  Used     702     703     704     705     706     707     710     711     712     713     714     715     718     719     720
           721     803     804     805     806

IND1                            Stack                             INTEGER
  Decl     838
  Set      887    1048
  Used     985     986     987     988     989     990     993     994     995     996     997     998    1001    1002    1003
          1004    1057    1058    1059    1060

IND1                            Stack                             INTEGER
  Decl    1103
  Set     1170    1339
  Used    1274    1275    1276    1277    1278    1279    1282    1283    1284    1285    1286    1287    1290    1291    1292
          1293    1348    1349    1350    1351

IND1                            Stack                             INTEGER
  Decl    1383
  Set     1412
  Used    1427    1428

IND1                            Stack                             INTEGER
  Decl    1474
  Set     1552    1701
  Used    1655    1656    1657    1658    1659    1660    1663    1664    1665    1666    1667    1668    1671    1672    1673
          1674    1710    1711

IND1                            Stack                             INTEGER
  Decl    1754
  Set     1788    1835
  Used    1807    1808    1846    1847

IND1                            Stack                             INTEGER
  Decl    1881
  Set     1958    2108
  Used    2062    2063    2064    2065    2066    2067    2070    2071    2072    2073    2074    2075    2078    2079    2080
          2081    2117    2118

IND1                            Stack                             INTEGER
  Decl    2147
  Set     2158    2180
  Used    2170    2171    2189    2190

IND1                            Stack                             INTEGER
  Decl    2220
  Set     2235    2261
  Used    2250    2251    2273    2274

IND1                            Stack                             INTEGER
  Decl    2305
  Set     2354
  Used    2452    2453    2454    2455    2456    2457    2460    2461    2462    2463    2464    2465    2468    2469    2470
          2471

IND1                            Stack                             INTEGER
  Decl    2513
  Set     2603
  Used    2712    2713    2714    2715    2716    2717    2720    2721    2722    2723    2724    2725    2728    2729    2730
          2731

IND1                            Stack                             INTEGER
  Decl    2777
  Set     2788    2809
  Used    2799    2800    2814    2815

IND1                            Stack                             INTEGER
  Decl    2845
  Set     2907
  Used    3012    3013    3014    3015    3016    3017    3020    3021    3022    3023    3024    3025    3028    3029    3030
          3031

IND1                            Stack                             INTEGER
  Decl    3074
  Set     3123    3253
  Used    3221    3222    3223    3224    3225    3226    3229    3230    3231    3232    3233    3234    3237    3238    3239
          3240    3258    3259

INDF                            Stack                             INTEGER
  Decl     347
  Set      365     396
  Used     377     378     403     404

INDF                            Stack                             INTEGER
  Decl     443
  Set      457     480
  Used     463     464     482     483

INDF                            Stack                             INTEGER
  Decl     519
  Set      601     786
  Used     668     669     790     791

INDF                            Stack                             INTEGER
  Decl     838
  Set      889
  Used     956     957

INDF                            Stack                             INTEGER
  Decl    1103
  Set     1172
  Used    1240    1241

INDF                            Stack                             INTEGER
  Decl    1383
  Set     1414
  Used    1420    1421

INDF                            Stack                             INTEGER
  Decl    1474
  Set     1554
  Used    1621    1622

INDF                            Stack                             INTEGER
  Decl    1754
  Set     1790
  Used    1796    1797

INDF                            Stack                             INTEGER
  Decl    1881
  Set     1960
  Used    2028    2029

INDF                            Stack                             INTEGER
  Decl    2147
  Set     2160    2181
  Used    2165    2166    2184    2185

INDF                            Stack                             INTEGER
  Decl    2220
  Set     2237    2262
  Used    2243    2244    2266    2267

INDF                            Stack                             INTEGER
  Decl    2305
  Set     2356
  Used    2423    2424

INDF                            Stack                             INTEGER
  Decl    2513
  Set     2605
  Used    2673    2674

INDF                            Stack                             INTEGER
  Decl    2777
  Set     2790
  Used    2794    2795

INDF                            Stack                             INTEGER
  Decl    2845
  Set     2909
  Used    2978    2979

INDF                            Stack                             INTEGER
  Decl    3074
  Set     3125
  Used    3192    3193

INDFOR                          Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      73     258
  Set 
  Used     365     396     457     480     601     786     889    1172    1414    1554    1790    1960    2160    2181    2237
          2262    2356    2605    2790    2909    3125

INDM                            Stack                             INTEGER
  Decl     347
  Set      366     397
  Used     379     380     405     406

INDM                            Stack                             INTEGER
  Decl     519
  Set      602     787
  Used     670     671     672     673     792     793     794     795

INDM                            Stack                             INTEGER
  Decl    1103
  Set     1173
  Used    1242    1243    1244    1245

INDM                            Stack                             INTEGER
  Decl    1383
  Set     1415
  Used    1422    1423

INDM                            Stack                             INTEGER
  Decl    1474
  Set     1555    1702
  Used    1623    1624    1625    1626    1705    1706

INDM                            Stack                             INTEGER
  Decl    1754
  Set     1791    1836
  Used    1798    1799    1800    1801    1802    1803    1839    1840    1841    1842

INDM                            Stack                             INTEGER
  Decl    1881
  Set     1961    2109
  Used    2030    2031    2032    2033    2112    2113

INDM                            Stack                             INTEGER
  Decl    2220
  Set     2238    2263
  Used    2245    2246    2268    2269

INDM                            Stack                             INTEGER
  Decl    2513
  Set     2606    2745
  Used    2675    2676    2677    2678    2680    2681    2682    2683    2747    2748

INDM                            Stack                             INTEGER
  Decl    2845
  Set     2910
  Used    2980    2981    2982    2983

INDMINOR                        Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      77     269
  Set 
  Used     366     397     602     787    1173    1415    1555    1702    1791    1836    1961    2109    2238    2263    2606
          2745    2910

INDS                            Stack                             INTEGER
  Decl     347
  Set      364
  Used     375     376

INDS                            Stack                             INTEGER
  Decl     443
  Set      456
  Used     461     462

INDS                            Stack                             INTEGER
  Decl     519
  Set      600
  Used     666     667

INDS                            Stack                             INTEGER
  Decl     838
  Set      888
  Used     954     955

INDS                            Stack                             INTEGER
  Decl    1103
  Set     1171
  Used    1238    1239

INDS                            Stack                             INTEGER
  Decl    1383
  Set     1413
  Used    1418    1419

INDS                            Stack                             INTEGER
  Decl    1474
  Set     1553
  Used    1619    1620

INDS                            Stack                             INTEGER
  Decl    1754
  Set     1789
  Used    1794    1795

INDS                            Stack                             INTEGER
  Decl    1881
  Set     1959
  Used    2026    2027

INDS                            Stack                             INTEGER
  Decl    2147
  Set     2159
  Used    2163    2164

INDS                            Stack                             INTEGER
  Decl    2220
  Set     2236
  Used    2241    2242

INDS                            Stack                             INTEGER
  Decl    2305
  Set     2355
  Used    2421    2422

INDS                            Stack                             INTEGER
  Decl    2513
  Set     2604
  Used    2671    2672

INDS                            Stack                             INTEGER
  Decl    2777
  Set     2789
  Used    2792    2793

INDS                            Stack                             INTEGER
  Decl    2845
  Set     2908
  Used    2976    2977

INDS                            Stack                             INTEGER
  Decl    3074
  Set     3124
  Used    3190    3191

INDSELF                         Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      70     256
  Set 
  Used     364     456     600     888    1171    1413    1553    1789    1959    2159    2236    2355    2604    2789    2908
          3124

INT                                                               Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used       0       0       0       0       0       0       0       0       0       0       0     562     576     739     762
           869     883    1028    1145    1159    1312    1335    1521    1529    1548    1921    1928    1935    1954    2336
          2343    2350    2559    2566    2573    2592    2599    2882    2889    2896    2903    3105    3112    3119

JMCO                            Stack                             INTEGER
  Decl    2514
  Set     2592
  Used    2680    2681    2682    2683

JMCO2                           Stack                             INTEGER
  Decl    1475
  Set     1529
  Used    1623    1624    1625    1626

JMCO2                           Stack                             INTEGER
  Decl    2514
  Set     2573
  Used    2675    2676    2677    2678

JMN2                            Stack                             INTEGER
  Decl    2846
  Set     2896
  Used    2980    2981    2982    2983

JMN2O                           Stack                             INTEGER
  Decl     520
  Set      576     762
  Used     670     671     672     673     792     793     794     795

JMN2O                           Stack                             INTEGER
  Decl    1882
  Set     1935
  Used    2030    2031    2032    2033

JMO3                            Stack                             INTEGER
  Decl    1104
  Set     1159
  Used    1242    1243    1244    1245

JP                              Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      38     226
  Set 
  Used     362     363     394     395     454     455     478     479     583     586     598     599     769     772     784
           785     886     887    1047    1048    1169    1170    1338    1339    1403    1406    1411    1412    1536    1539
          1551    1552    1692    1695    1700    1701    1779    1782    1787    1788    1826    1829    1834    1835    1942
          1945    1957    1958    2099    2102    2107    2108    2157    2158    2179    2180    2234    2235    2260    2261
          2353    2354    2602    2603    2787    2788    2808    2809    2906    2907    3122    3123    3252    3253

JPL                             Stack                             INTEGER
  Decl     520
  Set      595     781
  Used     727     728     809     810

JPL                             Stack                             INTEGER
  Decl     839
  Set      883    1044
  Used    1009    1010    1061    1062

JPL                             Stack                             INTEGER
  Decl    1104
  Set     1166    1335
  Used    1300    1301    1353    1354

JPL                             Stack                             INTEGER
  Decl    1475
  Set     1548
  Used    1680    1681

JPL                             Stack                             INTEGER
  Decl    1882
  Set     1954
  Used    2087    2088

JPL                             Stack                             INTEGER
  Decl    2306
  Set     2350
  Used    2476    2477

JPL                             Stack                             INTEGER
  Decl    2514
  Set     2599
  Used    2738    2739

JPL                             Stack                             INTEGER
  Decl    2846
  Set     2903
  Used    3037    3038

JPL                             Stack                             INTEGER
  Decl    3075
  Set     3119
  Used    3245    3246

JS                              Stack                             INTEGER
  Decl     520
  Set      562     739
  Used     598     784

JS                              Stack                             INTEGER
  Decl     839
  Set      869    1021
  Used     886    1047

JS                              Stack                             INTEGER
  Decl    1104
  Set     1145    1312
  Used    1169    1338

JS                              Stack                             INTEGER
  Decl    1475
  Set     1514
  Used    1551

JS                              Stack                             INTEGER
  Decl    1882
  Set     1921
  Used    1957

JS                              Stack                             INTEGER
  Decl    2306
  Set     2336
  Used    2353

JS                              Stack                             INTEGER
  Decl    2514
  Set     2559
  Used    2602

JS                              Stack                             INTEGER
  Decl    2846
  Set     2882
  Used    2906

JS                              Stack                             INTEGER
  Decl    3075
  Set     3105
  Used    3122

JS1                             Stack                             INTEGER
  Decl     520
  Set      569     746
  Used     599     785

JS1                             Stack                             INTEGER
  Decl     839
  Set      876    1028
  Used     887    1048

JS1                             Stack                             INTEGER
  Decl    1104
  Set     1152    1319
  Used    1170    1339

JS1                             Stack                             INTEGER
  Decl    1475
  Set     1521
  Used    1552

JS1                             Stack                             INTEGER
  Decl    1882
  Set     1928
  Used    1958

JS1                             Stack                             INTEGER
  Decl    2306
  Set     2343
  Used    2354

JS1                             Stack                             INTEGER
  Decl    2514
  Set     2566
  Used    2603

JS1                             Stack                             INTEGER
  Decl    2846
  Set     2889
  Used    2907

JS1                             Stack                             INTEGER
  Decl    3075
  Set     3112
  Used    3123

JT                              Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      39     228
  Set 
  Used     362     394     454     478     598     784     886    1047    1169    1338    1411    1551    1700    1787    1834
          1957    2107    2157    2179    2234    2260    2353    2602    2787    2808    2906    3122    3252

JT1                             Dummy Arg                         INTEGER, DIMENSION(<exp>), INTENT(IN)
  Decl      40     230
  Set 
  Used     363     395     455     479     599     785     887    1048    1170    1339    1412    1552    1701    1788    1835
          1958    2108    2158    2180    2235    2261    2354    2603    2788    2809    2907    3123    3253

KA_MCO                          Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(9, 19, 4), SAVE
  Decl
  Set 
  Used    2680    2681    2682    2683

KA_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1422    1423

KA_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(9, 19, 12), SAVE
  Decl
  Set 
  Used    1623    1624    1625    1626

KA_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1798    1799

KA_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(9, 19, 4), SAVE
  Decl
  Set 
  Used    2675    2676    2677    2678

KA_MN2                          Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(19, 10), SAVE
  Decl
  Set 
  Used     379     380

KA_MN2                          Use assoc                         REAL(KIND=8), From module RRLW_KG15, DIMENSION(9, 19, 2), SAVE
  Decl
  Set 
  Used    2980    2981    2982    2983

KA_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(9, 19, 16), SAVE
  Decl
  Set 
  Used     670     671     672     673

KA_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1802    1803

KA_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(9, 19, 12), SAVE
  Decl
  Set 
  Used    2030    2031    2032    2033

KA_MO2                          Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    2245    2246

KA_MO3                          Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(9, 19, 16), SAVE
  Decl
  Set 
  Used    1242    1243    1244    1245

KA_MO3                          Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1800    1801

KB_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(19, 12), SAVE
  Decl
  Set 
  Used    1705    1706

KB_MCO2                         Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1839    1840

KB_MN2                          Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(19, 10), SAVE
  Decl
  Set 
  Used     405     406

KB_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(5, 19, 16), SAVE
  Decl
  Set 
  Used     792     793     794     795

KB_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    1841    1842

KB_MN2O                         Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(19, 12), SAVE
  Decl
  Set 
  Used    2112    2113

KB_MO2                          Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(19, 8), SAVE
  Decl
  Set 
  Used    2268    2269

KB_MO3                          Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(19, 4), SAVE
  Decl
  Set 
  Used    2747    2748

LAY                             Stack                             INTEGER
  Decl     347
  Set 
  Used     362     363     364     365     366     367     373     375     377     380     381     382     383     384     385
           387     394     395     396     397     398     401     403     404     406     407     408     409     410     411
           413

LAY                             Stack                             INTEGER
  Decl     443
  Set 
  Used     454     455     456     457     458     461     463     465     466     467     468     469     471     478     479
           480     482     483     484     485     486     487     488     490

LAY                             Stack                             INTEGER
  Decl     519
  Set 
  Used     558     559     565     566     572     573     578     582     583     586     588     591     592     598     599
           600     601     602     610     611     612     613     614     615     622     623     624     625     626     627
           629     630     631     632     640     641     642     643     644     645     652     653     654     655     656
           657     659     660     661     662     666     668     674     724     727     735     736     742     743     749
           750     751     752     753     754     755     756     758     759     764     768     769     772     774     777
           778     784     785     786     787     790     791     796     797     809

LAY                             Stack                             INTEGER
  Decl     838
  Set 
  Used     865     866     872     873     879     880     886     887     888     889     897     898     899     900     901
           902     909     910     911     912     913     914     916     917     918     919     928     929     930     931
           932     933     940     941     942     943     944     945     947     948     949     950     954     956    1007
          1009    1017    1018    1024    1025    1031    1032    1033    1034    1035    1036    1037    1038    1040    1041
          1047    1048    1051    1061    1068    1069    1070    1071    1072    1073    1074

LAY                             Stack                             INTEGER
  Decl    1103
  Set 
  Used    1141    1142    1148    1149    1155    1156    1162    1163    1169    1170    1171    1172    1173    1181    1182
          1183    1184    1185    1186    1193    1194    1195    1196    1197    1198    1200    1201    1202    1203    1212
          1213    1214    1215    1216    1217    1224    1225    1226    1227    1228    1229    1231    1232    1233    1234
          1238    1240    1246    1296    1298    1299    1300    1308    1309    1315    1316    1322    1323    1324    1325
          1326    1327    1328    1329    1331    1332    1338    1339    1342    1352    1353

LAY                             Stack                             INTEGER
  Decl    1383
  Set 
  Used    1402    1403    1406    1408    1411    1412    1413    1414    1415    1418    1420    1422    1424    1425    1426
          1427    1428    1431    1432    1433    1442    1443    1444    1445

LAY                             Stack                             INTEGER
  Decl    1474
  Set 
  Used    1510    1511    1517    1518    1524    1525    1535    1536    1539    1541    1544    1545    1551    1552    1553
          1554    1555    1563    1564    1565    1566    1567    1568    1575    1576    1577    1578    1579    1580    1582
          1583    1584    1585    1593    1594    1595    1596    1597    1598    1605    1606    1607    1608    1609    1610
          1612    1613    1614    1615    1619    1621    1627    1677    1680    1691    1692    1695    1697    1700    1701
          1702    1705    1707    1708    1709    1710    1711    1713    1719    1720    1721    1722    1723    1724

LAY                             Stack                             INTEGER
  Decl    1754
  Set 
  Used    1778    1779    1782    1784    1787    1788    1789    1790    1791    1794    1796    1798    1800    1802    1804
          1805    1806    1807    1808    1811    1812    1813    1814    1815    1825    1826    1829    1831    1834    1835
          1836    1839    1841    1843    1844    1845    1846    1847    1849    1850    1851    1852

LAY                             Stack                             INTEGER
  Decl    1881
  Set 
  Used    1917    1918    1924    1925    1931    1932    1941    1942    1945    1947    1950    1951    1957    1958    1959
          1960    1961    1969    1970    1971    1972    1973    1974    1981    1982    1983    1984    1985    1986    1988
          1989    1990    1991    2000    2001    2002    2003    2004    2005    2012    2013    2014    2015    2016    2017
          2019    2020    2021    2022    2026    2028    2034    2084    2087    2098    2099    2102    2104    2107    2108
          2109    2112    2114    2115    2116    2117    2118    2120

LAY                             Stack                             INTEGER
  Decl    2147
  Set 
  Used    2157    2158    2159    2160    2163    2165    2167    2168    2169    2170    2171    2173    2179    2180    2181
          2184    2186    2187    2188    2189    2190    2192

LAY                             Stack                             INTEGER
  Decl    2220
  Set 
  Used    2234    2235    2236    2237    2238    2239    2241    2243    2245    2247    2248    2249    2250    2251    2254
          2260    2261    2262    2263    2264    2266    2268    2270    2271    2272    2273    2274    2277

LAY                             Stack                             INTEGER
  Decl    2305
  Set 
  Used    2332    2333    2339    2340    2346    2347    2353    2354    2355    2356    2364    2365    2366    2367    2368
          2369    2376    2377    2378    2379    2380    2381    2383    2384    2385    2386    2395    2396    2397    2398
          2399    2400    2407    2408    2409    2410    2411    2412    2414    2415    2416    2417    2421    2423    2474
          2476    2484    2485

LAY                             Stack                             INTEGER
  Decl    2513
  Set 
  Used    2555    2556    2562    2563    2569    2570    2579    2583    2585    2588    2589    2595    2596    2602    2603
          2604    2605    2606    2614    2615    2616    2617    2618    2619    2626    2627    2628    2629    2630    2631
          2633    2634    2635    2636    2645    2646    2647    2648    2649    2650    2657    2658    2659    2660    2661
          2662    2664    2665    2666    2667    2671    2673    2679    2684    2734    2737    2738    2745    2747    2749
          2750

LAY                             Stack                             INTEGER
  Decl    2777
  Set 
  Used    2787    2788    2789    2790    2792    2794    2796    2797    2798    2799    2800    2802    2808    2809    2811
          2812    2813    2814    2815    2816

LAY                             Stack                             INTEGER
  Decl    2845
  Set 
  Used    2878    2879    2885    2886    2892    2893    2899    2900    2906    2907    2908    2909    2910    2912    2920
          2921    2922    2923    2924    2925    2932    2933    2934    2935    2936    2937    2939    2940    2941    2942
          2950    2951    2952    2953    2954    2955    2962    2963    2964    2965    2966    2967    2969    2970    2971
          2972    2976    2978    2984    3034    3037    3045    3046

LAY                             Stack                             INTEGER
  Decl    3074
  Set 
  Used    3101    3102    3108    3109    3115    3116    3122    3123    3124    3125    3133    3134    3135    3136    3137
          3138    3145    3146    3147    3148    3149    3150    3152    3153    3154    3155    3164    3165    3166    3167
          3168    3169    3176    3177    3178    3179    3180    3181    3183    3184    3185    3186    3190    3192    3243
          3245    3252    3253    3255    3256    3257    3258    3259    3260

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl      37     225
  Set 
  Used     299     300     301     302     303     304     305     306     307     308     309     310     311     312     313
           314

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     319     342
  Set 
  Used     360

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     420     438
  Set 
  Used     452

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     497     514
  Set 
  Used     556

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     817     833
  Set 
  Used     863

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1081    1098
  Set 
  Used    1139

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1361    1378
  Set 
  Used    1397

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1452    1469
  Set 
  Used    1508

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1731    1749
  Set 
  Used    1773

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1859    1876
  Set 
  Used    1915

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2127    2142
  Set 
  Used    2156

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2199    2215
  Set 
  Used    2233

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2284    2300
  Set 
  Used    2330

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2492    2508
  Set 
  Used    2553

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2757    2772
  Set 
  Used    2786

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2823    2840
  Set 
  Used    2876

LAYTROP                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    3053    3069
  Set 
  Used    3099

MAX                                                               Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used       0    1548

MAXXSEC                         Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     220

MINORFRAC                       Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      74     271
  Set 
  Used     380     406     578     674     764     796    1246    1422    1627    1705    1798    1800    1802    1839    1841
          2034    2112    2245    2268    2679    2684    2747    2984

MOD                                                               Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used       0       0       0       0       0       0       0       0       0       0       0     563     577     740     763
           870     884    1029    1146    1160    1313    1336    1522    1530    1549    1922    1929    1936    1955    2337
          2344    2351    2560    2567    2574    2593    2600    2883    2890    2897    2904    3106    3113    3120

N2M1                            Stack                             REAL(KIND=8)
  Decl    2854
  Set     2980
  Used    2984

N2M2                            Stack                             REAL(KIND=8)
  Decl    2854
  Set     2982
  Used    2984

N2OM1                           Stack                             REAL(KIND=8)
  Decl     529
  Set      670     792
  Used     674     796

N2OM1                           Stack                             REAL(KIND=8)
  Decl    1890
  Set     2030
  Used    2034

N2OM2                           Stack                             REAL(KIND=8)
  Decl     529
  Set      672     794
  Used     674     796

N2OM2                           Stack                             REAL(KIND=8)
  Decl    1890
  Set     2032
  Used    2034

NBNDLW                          Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     232     234     236

NG1                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     374     402

NG10                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2162    2183

NG11                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2240    2265

NG12                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2420    2483

NG13                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2670    2746

NG14                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2791    2810

NG15                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2975    3044

NG16                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    3189    3254

NG2                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     460     481

NG3                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     665     789

NG4                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     953    1050

NG5                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1237    1341

NG6                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1417    1441

NG7                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1618    1704

NG8                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1793    1838

NG9                             Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2025    2111

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl     319     341
  Set 
  Used     343     344

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl     420     437
  Set 
  Used     439     440

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl     497     513
  Set 
  Used     515     516

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl     817     832
  Set 
  Used     834     835

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1081    1097
  Set 
  Used    1099    1100

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1361    1377
  Set 
  Used    1379    1380

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1452    1468
  Set 
  Used    1470    1471

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1731    1748
  Set 
  Used    1750    1751

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1859    1875
  Set 
  Used    1877    1878

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2127    2141
  Set 
  Used    2143    2144

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2199    2214
  Set 
  Used    2216    2217

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2284    2299
  Set 
  Used    2301    2302

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2492    2507
  Set 
  Used    2509    2510

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2757    2771
  Set 
  Used    2773    2774

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2823    2839
  Set 
  Used    2841    2842

NGPTLW                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    3053    3068
  Set 
  Used    3070    3071

NGPTLW                          Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     290     292     299     300     301     302     303     304     305     306     307     308     309     310     311
           312     313     314

NGS1                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     465     471     484     490

NGS10                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2247    2254    2270    2277

NGS11                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2474    2476    2484    2485

NGS12                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2734    2738    2749    2750

NGS13                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2796    2802    2811    2816

NGS14                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    3034    3037    3045    3046

NGS15                           Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    3243    3245    3255    3260

NGS2                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used     724     727     797     809

NGS3                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1007    1009    1051    1061    1068    1069    1070    1071    1072    1073    1074

NGS4                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1296    1300    1342    1353

NGS5                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1424    1433    1442    1445

NGS6                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1677    1680    1707    1713    1719    1720    1721    1722    1723    1724

NGS7                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    1804    1815    1843    1852

NGS8                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2084    2087    2114    2120

NGS9                            Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used    2167    2173    2186    2192

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl      33     217
  Set 
  Used     218     220     222     226     228     230     232     234     239     241     243     245     247     249     251
           253     256     258     260     262     264     266     269     271     273     275     279     280     282     283
           284     285     286     287     290     292     299     300     301     302     303     304     305     306     307
           308     309     310     311     312     313     314

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     319     340
  Set 
  Used     343     344     392

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     420     436
  Set 
  Used     439     440     476

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     497     512
  Set 
  Used     515     516     733

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     817     831
  Set 
  Used     834     835    1015

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1081    1096
  Set 
  Used    1099    1100    1306

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1361    1376
  Set 
  Used    1379    1380    1439

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1452    1467
  Set 
  Used    1470    1471    1686

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1731    1747
  Set 
  Used    1750    1751    1820

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1859    1874
  Set 
  Used    1877    1878    2093

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2127    2140
  Set 
  Used    2143    2144    2178

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2199    2213
  Set 
  Used    2216    2217    2259

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2284    2298
  Set 
  Used    2301    2302    2482

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2492    2506
  Set 
  Used    2509    2510    2744

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2757    2770
  Set 
  Used    2773    2774    2807

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    2823    2838
  Set 
  Used    2841    2842    3043

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    3053    3067
  Set 
  Used    3070    3071    3251

NSPA                            Use assoc                         INTEGER, From module RRLW_WVN, DIMENSION(16), SAVE
  Decl
  Set 
  Used     362     363     454     455     598     599     886     887    1169    1170    1411    1412    1551    1552    1787
          1788    1957    1958    2157    2158    2234    2235    2353    2354    2602    2603    2787    2788    2906    2907
          3122    3123

NSPB                            Use assoc                         INTEGER, From module RRLW_WVN, DIMENSION(16), SAVE
  Decl
  Set 
  Used     394     395     478     479     784     785    1047    1048    1338    1339    1700    1701    1834    1835    2107
          2108    2179    2180    2260    2261    2808    2809    3252    3253

O3M1                            Stack                             REAL(KIND=8)
  Decl    1112
  Set     1242
  Used    1246

O3M2                            Stack                             REAL(KIND=8)
  Decl    1112
  Set     1244
  Used    1246

ONEMINUS                        Use assoc                         REAL(KIND=8), From module RRLW_CON, SAVE
  Decl
  Set 
  Used     560     567     574     593     737     744     760     779     867     874     881    1019    1026    1042    1143
          1150    1157    1164    1310    1317    1333    1512    1519    1526    1546    1919    1926    1933    1952    2334
          2341    2348    2557    2564    2571    2590    2597    2880    2887    2894    2901    3103    3110    3117

P                               Stack                             REAL(KIND=8)
  Decl     526
  Set      605     617     635     647
  Used     606     608     609     618     620     621     636     638     639     648     650     651

P                               Stack                             REAL(KIND=8)
  Decl     843
  Set      892     904     923     935
  Used     893     895     896     905     907     908     924     926     927     936     938     939

P                               Stack                             REAL(KIND=8)
  Decl    1109
  Set     1176    1188    1207    1219
  Used    1177    1179    1180    1189    1191    1192    1208    1210    1211    1220    1222    1223

P                               Stack                             REAL(KIND=8)
  Decl    1480
  Set     1558    1570    1588    1600
  Used    1559    1561    1562    1571    1573    1574    1589    1591    1592    1601    1603    1604

P                               Stack                             REAL(KIND=8)
  Decl    1887
  Set     1964    1976    1995    2007
  Used    1965    1967    1968    1977    1979    1980    1996    1998    1999    2008    2010    2011

P                               Stack                             REAL(KIND=8)
  Decl    2310
  Set     2359    2371    2390    2402
  Used    2360    2362    2363    2372    2374    2375    2391    2393    2394    2403    2405    2406

P                               Stack                             REAL(KIND=8)
  Decl    2520
  Set     2609    2621    2640    2652
  Used    2610    2612    2613    2622    2624    2625    2641    2643    2644    2653    2655    2656

P                               Stack                             REAL(KIND=8)
  Decl    2851
  Set     2915    2927    2945    2957
  Used    2916    2918    2919    2928    2930    2931    2946    2948    2949    2958    2960    2961

P                               Stack                             REAL(KIND=8)
  Decl    3079
  Set     3128    3140    3159    3171
  Used    3129    3131    3132    3141    3143    3144    3160    3162    3163    3172    3174    3175

P4                              Stack                             REAL(KIND=8)
  Decl     526
  Set      606     618     636     648
  Used     607     608     609     619     620     621     637     638     639     649     650     651

P4                              Stack                             REAL(KIND=8)
  Decl     843
  Set      893     905     924     936
  Used     894     895     896     906     907     908     925     926     927     937     938     939

P4                              Stack                             REAL(KIND=8)
  Decl    1109
  Set     1177    1189    1208    1220
  Used    1178    1179    1180    1190    1191    1192    1209    1210    1211    1221    1222    1223

P4                              Stack                             REAL(KIND=8)
  Decl    1480
  Set     1559    1571    1589    1601
  Used    1560    1561    1562    1572    1573    1574    1590    1591    1592    1602    1603    1604

P4                              Stack                             REAL(KIND=8)
  Decl    1887
  Set     1965    1977    1996    2008
  Used    1966    1967    1968    1978    1979    1980    1997    1998    1999    2009    2010    2011

P4                              Stack                             REAL(KIND=8)
  Decl    2310
  Set     2360    2372    2391    2403
  Used    2361    2362    2363    2373    2374    2375    2392    2393    2394    2404    2405    2406

P4                              Stack                             REAL(KIND=8)
  Decl    2520
  Set     2610    2622    2641    2653
  Used    2611    2612    2613    2623    2624    2625    2642    2643    2644    2654    2655    2656

P4                              Stack                             REAL(KIND=8)
  Decl    2851
  Set     2916    2928    2946    2958
  Used    2917    2918    2919    2929    2930    2931    2947    2948    2949    2959    2960    2961

P4                              Stack                             REAL(KIND=8)
  Decl    3079
  Set     3129    3141    3160    3172
  Used    3130    3131    3132    3142    3143    3144    3161    3162    3163    3173    3174    3175

PARRRTM                                                           Module
  Decl
  Set 
  Used      22

PARRRTM                                                           Module
  Decl
  Set 
  Used     335

PARRRTM                                                           Module
  Decl
  Set 
  Used     431

PARRRTM                                                           Module
  Decl
  Set 
  Used     506

PARRRTM                                                           Module
  Decl
  Set 
  Used     825

PARRRTM                                                           Module
  Decl
  Set 
  Used    1090

PARRRTM                                                           Module
  Decl
  Set 
  Used    1370

PARRRTM                                                           Module
  Decl
  Set 
  Used    1461

PARRRTM                                                           Module
  Decl
  Set 
  Used    1740

PARRRTM                                                           Module
  Decl
  Set 
  Used    1868

PARRRTM                                                           Module
  Decl
  Set 
  Used    2135

PARRRTM                                                           Module
  Decl
  Set 
  Used    2208

PARRRTM                                                           Module
  Decl
  Set 
  Used    2292

PARRRTM                                                           Module
  Decl
  Set 
  Used    2500

PARRRTM                                                           Module
  Decl
  Set 
  Used    2765

PARRRTM                                                           Module
  Decl
  Set 
  Used    2832

PARRRTM                                                           Module
  Decl
  Set 
  Used    3061

PAVEL                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      34     218
  Set 
  Used     367     398     458

PLANKBND                        Dummy Arg                         REAL(KIND=8), DIMENSION(16), INTENT(IN)
  Decl      43     236
  Set 
  Used

PLANKLAY                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 16), INTENT(IN)
  Decl      41     232
  Set 
  Used

PLANKLEV                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>, 16), INTENT(IN)
  Decl      42     234
  Set 
  Used

PP                              Stack                             REAL(KIND=8)
  Decl     348
  Set      367     398
  Used     369     370     399

PP                              Stack                             REAL(KIND=8)
  Decl     444
  Set      458
  Used     459

R8                                                                INTEGER, PARAMETER, Renames SHR_KIND_R8 in SHR_KIND_MOD
  Decl      20
  Set 
  Used     218     220     222     232     234     236     239     241     243     245     247     249     251     253     260
           262     264     266     271     273     275     278     281     290     292     343     344     348     439     440
           444     515     516     521     522     523     525     526     527     528     529     530     531     834     835
           840     841     842     843     844     845     846     847     848    1099    1100    1105    1106    1107    1108
          1109    1110    1111    1112    1113    1114    1379    1380    1384    1385    1470    1471    1476    1477    1478
          1479    1480    1481    1482    1483    1484    1485    1486    1750    1751    1755    1756    1877    1878    1883
          1884    1885    1886    1887    1888    1889    1890    1891    1892    1893    2143    2144    2148    2216    2217
          2221    2301    2302    2307    2308    2309    2310    2311    2312    2313    2314    2315    2509    2510    2515
          2516    2517    2518    2519    2520    2521    2522    2523    2524    2525    2526    2527    2773    2774    2778
          2841    2842    2847    2848    2849    2850    2851    2852    2853    2854    2855    2856    3070    3071    3076
          3077    3078    3079    3080    3081    3082    3083    3084

RATCO2                          Stack                             REAL(KIND=8)
  Decl    1384
  Set     1403
  Used    1404    1405

RATCO2                          Stack                             REAL(KIND=8)
  Decl    1484
  Set     1536    1692
  Used    1537    1538    1693    1694

RATCO2                          Stack                             REAL(KIND=8)
  Decl    1756
  Set     1779    1826
  Used    1780    1781    1827    1828

RATCO2                          Stack                             REAL(KIND=8)
  Decl    2525
  Set     2580
  Used    2581    2582

RATN2O                          Stack                             REAL(KIND=8)
  Decl     524
  Set      583     769
  Used     584     585     770     771

RATN2O                          Stack                             REAL(KIND=8)
  Decl    1891
  Set     1942    2099
  Used    1943    1944    2100    2101

RAT_H2OCH4                      Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      62     285
  Set 
  Used    1917    3101

RAT_H2OCH4_1                    Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      63     285
  Set 
  Used    1924    3108

RAT_H2OCO2                      Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      56     282
  Set 
  Used     558     735     865    1141    2332

RAT_H2OCO2_1                    Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      57     282
  Set 
  Used     565     742     872    1148    2339

RAT_H2ON2O                      Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      60     284
  Set 
  Used    2555

RAT_H2ON2O_1                    Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      61     284
  Set 
  Used    2562

RAT_H2OO3                       Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      58     283
  Set 
  Used    1510

RAT_H2OO3_1                     Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      59     283
  Set 
  Used    1517

RAT_N2OCO2                      Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      64     286
  Set 
  Used    2878

RAT_N2OCO2_1                    Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      65     286
  Set 
  Used    2885

RAT_O3CO2                       Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      66     287
  Set 
  Used    1017    1308

RAT_O3CO2_1                     Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      67     287
  Set 
  Used    1024    1315

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl     530
  Set      545
  Used     572

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl    1113
  Set     1131
  Used    1155

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl    1485
  Set     1500
  Used    1524

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl    1892
  Set     1907
  Used    1931

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl    2526
  Set     2542
  Used    2569

REFRAT_M_A                      Stack                             REAL(KIND=8)
  Decl    2855
  Set     2868
  Used    2892

REFRAT_M_A3                     Stack                             REAL(KIND=8)
  Decl    2526
  Set     2545
  Used    2588

REFRAT_M_B                      Stack                             REAL(KIND=8)
  Decl     530
  Set      548
  Used     758

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl     530
  Set      539
  Used     591

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl     847
  Set      852
  Used     879

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    1113
  Set     1125
  Used    1162

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    1485
  Set     1497
  Used    1544

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    1892
  Set     1904
  Used    1950

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    2314
  Set     2322
  Used    2346

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    2526
  Set     2539
  Used    2595

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    2855
  Set     2865
  Used    2899

REFRAT_PLANCK_A                 Stack                             REAL(KIND=8)
  Decl    3083
  Set     3091
  Used    3115

REFRAT_PLANCK_B                 Stack                             REAL(KIND=8)
  Decl     530
  Set      542
  Used     777

REFRAT_PLANCK_B                 Stack                             REAL(KIND=8)
  Decl     847
  Set      855
  Used    1040

REFRAT_PLANCK_B                 Stack                             REAL(KIND=8)
  Decl    1113
  Set     1128
  Used    1331

RRLW_CON                                                          Module
  Decl
  Set 
  Used      23

RRLW_KG01                                                         Module
  Decl
  Set 
  Used     336

RRLW_KG02                                                         Module
  Decl
  Set 
  Used     432

RRLW_KG03                                                         Module
  Decl
  Set 
  Used     508

RRLW_KG04                                                         Module
  Decl
  Set 
  Used     827

RRLW_KG05                                                         Module
  Decl
  Set 
  Used    1092

RRLW_KG06                                                         Module
  Decl
  Set 
  Used    1372

RRLW_KG07                                                         Module
  Decl
  Set 
  Used    1463

RRLW_KG08                                                         Module
  Decl
  Set 
  Used    1742

RRLW_KG09                                                         Module
  Decl
  Set 
  Used    1870

RRLW_KG10                                                         Module
  Decl
  Set 
  Used    2136

RRLW_KG11                                                         Module
  Decl
  Set 
  Used    2209

RRLW_KG12                                                         Module
  Decl
  Set 
  Used    2294

RRLW_KG13                                                         Module
  Decl
  Set 
  Used    2502

RRLW_KG14                                                         Module
  Decl
  Set 
  Used    2766

RRLW_KG15                                                         Module
  Decl
  Set 
  Used    2834

RRLW_KG16                                                         Module
  Decl
  Set 
  Used    3063

RRLW_REF                                                          Module
  Decl
  Set 
  Used     507

RRLW_REF                                                          Module
  Decl
  Set 
  Used     826

RRLW_REF                                                          Module
  Decl
  Set 
  Used    1091

RRLW_REF                                                          Module
  Decl
  Set 
  Used    1371

RRLW_REF                                                          Module
  Decl
  Set 
  Used    1462

RRLW_REF                                                          Module
  Decl
  Set 
  Used    1741

RRLW_REF                                                          Module
  Decl
  Set 
  Used    1869

RRLW_REF                                                          Module
  Decl
  Set 
  Used    2293

RRLW_REF                                                          Module
  Decl
  Set 
  Used    2501

RRLW_REF                                                          Module
  Decl
  Set 
  Used    2833

RRLW_REF                                                          Module
  Decl
  Set 
  Used    3062

RRLW_VSN                                                          Module
  Decl
  Set 
  Used      25

RRLW_WVN                                                          Module
  Decl
  Set 
  Used      24

RRTMG_LW_TAUMOL                                                   Module
  Decl       6
  Set 
  Used

SCALEMINOR                      Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      75     273
  Set 
  Used    2239    2264    2912

SCALEMINORN2                    Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      76     275
  Set 
  Used     373     401

SCALEN2                         Stack                             REAL(KIND=8)
  Decl     348
  Set      373     401
  Used     379     405

SCALEN2                         Stack                             REAL(KIND=8)
  Decl    2854
  Set     2912
  Used    2984

SCALEO2                         Stack                             REAL(KIND=8)
  Decl    2221
  Set     2239    2264
  Used    2245    2268

SELFFAC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      68     260
  Set 
  Used     375     461     666     954    1238    1418    1619    1794    2026    2163    2241    2421    2671    2792    2976
          3190

SELFFRAC                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      69     262
  Set 
  Used     375     461     666     954    1238    1418    1619    1794    2026    2163    2241    2421    2671    2792    2976
          3190

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG01, DIMENSION(10, 10), SAVE
  Decl
  Set 
  Used     375     376

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG02, DIMENSION(10, 12), SAVE
  Decl
  Set 
  Used     461     462

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG03, DIMENSION(10, 16), SAVE
  Decl
  Set 
  Used     666     667

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG04, DIMENSION(10, 14), SAVE
  Decl
  Set 
  Used     954     955

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG05, DIMENSION(10, 16), SAVE
  Decl
  Set 
  Used    1238    1239

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG06, DIMENSION(10, 8), SAVE
  Decl
  Set 
  Used    1418    1419

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG07, DIMENSION(10, 12), SAVE
  Decl
  Set 
  Used    1619    1620

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG08, DIMENSION(10, 8), SAVE
  Decl
  Set 
  Used    1794    1795

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG09, DIMENSION(10, 12), SAVE
  Decl
  Set 
  Used    2026    2027

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG10, DIMENSION(10, 6), SAVE
  Decl
  Set 
  Used    2163    2164

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG11, DIMENSION(10, 8), SAVE
  Decl
  Set 
  Used    2241    2242

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG12, DIMENSION(10, 8), SAVE
  Decl
  Set 
  Used    2421    2422

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG13, DIMENSION(10, 4), SAVE
  Decl
  Set 
  Used    2671    2672

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG14, DIMENSION(10, 2), SAVE
  Decl
  Set 
  Used    2792    2793

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG15, DIMENSION(10, 2), SAVE
  Decl
  Set 
  Used    2976    2977

SELFREF                         Use assoc                         REAL(KIND=8), From module RRLW_KG16, DIMENSION(10, 2), SAVE
  Decl
  Set 
  Used    3190    3191

SHR_KIND_MOD                                                      Module
  Decl
  Set 
  Used      20

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl     521
  Set      558     735
  Used     559     677     685     693     736     797

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl     840
  Set      865    1017
  Used     866     960     968     976    1018    1051

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    1105
  Set     1141    1308
  Used    1142    1249    1257    1265    1309    1342

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    1476
  Set     1510
  Used    1511    1630    1638    1646

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    1883
  Set     1917
  Used    1918    2037    2045    2053

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    2307
  Set     2332
  Used    2333    2427    2435    2443

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    2515
  Set     2555
  Used    2556    2687    2695    2703

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    2847
  Set     2878
  Used    2879    2987    2995    3003

SPECCOMB                        Stack                             REAL(KIND=8)
  Decl    3076
  Set     3101
  Used    3102    3196    3204    3212

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl     522
  Set      565     742
  Used     566     701     709     717     743     802

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl     841
  Set      872    1024
  Used     873     984     992    1000    1025    1056

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    1106
  Set     1148    1315
  Used    1149    1273    1281    1289    1316    1347

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    1477
  Set     1517
  Used    1518    1654    1662    1670

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    1884
  Set     1924
  Used    1925    2061    2069    2077

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    2308
  Set     2339
  Used    2340    2451    2459    2467

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    2516
  Set     2562
  Used    2563    2711    2719    2727

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    2848
  Set     2885
  Used    2886    3011    3019    3027

SPECCOMB1                       Stack                             REAL(KIND=8)
  Decl    3077
  Set     3108
  Used    3109    3220    3228    3236

SPECCOMB_MCO                    Stack                             REAL(KIND=8)
  Decl    2518
  Set     2588
  Used    2589

SPECCOMB_MCO2                   Stack                             REAL(KIND=8)
  Decl    1478
  Set     1524
  Used    1525

SPECCOMB_MCO2                   Stack                             REAL(KIND=8)
  Decl    2517
  Set     2569
  Used    2570

SPECCOMB_MN2                    Stack                             REAL(KIND=8)
  Decl    2849
  Set     2892
  Used    2893

SPECCOMB_MN2O                   Stack                             REAL(KIND=8)
  Decl     523
  Set      572     758
  Used     573     759

SPECCOMB_MN2O                   Stack                             REAL(KIND=8)
  Decl    1885
  Set     1931
  Used    1932

SPECCOMB_MO3                    Stack                             REAL(KIND=8)
  Decl    1107
  Set     1155
  Used    1156

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl     525
  Set      591     777
  Used     592     778

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl     842
  Set      879    1040
  Used     880    1041

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1108
  Set     1162    1331
  Used    1163    1332

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1479
  Set     1544
  Used    1545

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1886
  Set     1950
  Used    1951

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2309
  Set     2346
  Used    2347

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2519
  Set     2595
  Used    2596

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2850
  Set     2899
  Used    2900

SPECCOMB_PLANCK                 Stack                             REAL(KIND=8)
  Decl    3078
  Set     3115
  Used    3116

SPECMULT                        Stack                             REAL(KIND=8)
  Decl     521
  Set      561     738
  Used     562     563     739     740

SPECMULT                        Stack                             REAL(KIND=8)
  Decl     840
  Set      868    1020
  Used     869     870    1021    1022

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    1105
  Set     1144    1311
  Used    1145    1146    1312    1313

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    1476
  Set     1513
  Used    1514    1515

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    1883
  Set     1920
  Used    1921    1922

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    2307
  Set     2335
  Used    2336    2337

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    2515
  Set     2558
  Used    2559    2560

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    2847
  Set     2881
  Used    2882    2883

SPECMULT                        Stack                             REAL(KIND=8)
  Decl    3076
  Set     3104
  Used    3105    3106

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl     522
  Set      568     745
  Used     569     570     746     747

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl     841
  Set      875    1027
  Used     876     877    1028    1029

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    1106
  Set     1151    1318
  Used    1152    1153    1319    1320

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    1477
  Set     1520
  Used    1521    1522

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    1884
  Set     1927
  Used    1928    1929

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    2308
  Set     2342
  Used    2343    2344

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    2516
  Set     2565
  Used    2566    2567

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    2848
  Set     2888
  Used    2889    2890

SPECMULT1                       Stack                             REAL(KIND=8)
  Decl    3077
  Set     3111
  Used    3112    3113

SPECMULT_MCO                    Stack                             REAL(KIND=8)
  Decl    2518
  Set     2591
  Used    2592    2593

SPECMULT_MCO2                   Stack                             REAL(KIND=8)
  Decl    1478
  Set     1527
  Used    1529    1530

SPECMULT_MCO2                   Stack                             REAL(KIND=8)
  Decl    2517
  Set     2572
  Used    2573    2574

SPECMULT_MN2                    Stack                             REAL(KIND=8)
  Decl    2849
  Set     2895
  Used    2896    2897

SPECMULT_MN2O                   Stack                             REAL(KIND=8)
  Decl     523
  Set      575     761
  Used     576     577     762     763

SPECMULT_MN2O                   Stack                             REAL(KIND=8)
  Decl    1885
  Set     1934
  Used    1935    1936

SPECMULT_MO3                    Stack                             REAL(KIND=8)
  Decl    1107
  Set     1158
  Used    1159    1160

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl     525
  Set      594     780
  Used     595     596     781     782

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl     842
  Set      882    1043
  Used     883     884    1044    1045

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1108
  Set     1165    1334
  Used    1166    1167    1335    1336

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1479
  Set     1547
  Used    1548    1549

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1886
  Set     1953
  Used    1954    1955

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2309
  Set     2349
  Used    2350    2351

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2519
  Set     2598
  Used    2599    2600

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2850
  Set     2902
  Used    2903    2904

SPECMULT_PLANCK                 Stack                             REAL(KIND=8)
  Decl    3078
  Set     3118
  Used    3119    3120

SPECPARM                        Stack                             REAL(KIND=8)
  Decl     521
  Set      559     560     736     737
  Used     560     561     604     616     676     684     737     738

SPECPARM                        Stack                             REAL(KIND=8)
  Decl     840
  Set      866     867    1018    1019
  Used     867     868     891     903     959     967    1019    1020

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    1105
  Set     1142    1143    1309    1310
  Used    1143    1144    1175    1187    1248    1256    1310    1311

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    1476
  Set     1511    1512
  Used    1512    1513    1557    1569    1587    1629    1637

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    1883
  Set     1918    1919
  Used    1919    1920    1963    1975    2036    2044

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    2307
  Set     2333    2334
  Used    2334    2335    2358    2370    2426    2434

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    2515
  Set     2556    2557
  Used    2557    2558    2608    2620    2686    2694

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    2847
  Set     2879    2880
  Used    2880    2881    2914    2926    2986    2994

SPECPARM                        Stack                             REAL(KIND=8)
  Decl    3076
  Set     3102    3103
  Used    3103    3104    3127    3139    3195    3203

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl     522
  Set      566     567     743     744
  Used     567     568     634     646     700     708     744     745

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl     841
  Set      873     874    1025    1026
  Used     874     875     922     934     983     991    1026    1027

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    1106
  Set     1149    1150    1316    1317
  Used    1150    1151    1206    1218    1272    1280    1317    1318

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    1477
  Set     1518    1519
  Used    1519    1520    1599    1653    1661

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    1884
  Set     1925    1926
  Used    1926    1927    1994    2006    2060    2068

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    2308
  Set     2340    2341
  Used    2341    2342    2389    2401    2450    2458

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    2516
  Set     2563    2564
  Used    2564    2565    2639    2651    2710    2718

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    2848
  Set     2886    2887
  Used    2887    2888    2944    2956    3010    3018

SPECPARM1                       Stack                             REAL(KIND=8)
  Decl    3077
  Set     3109    3110
  Used    3110    3111    3158    3170    3219    3227

SPECPARM_MCO                    Stack                             REAL(KIND=8)
  Decl    2518
  Set     2589    2590
  Used    2590    2591

SPECPARM_MCO2                   Stack                             REAL(KIND=8)
  Decl    1478
  Set     1525    1526
  Used    1526    1527

SPECPARM_MCO2                   Stack                             REAL(KIND=8)
  Decl    2517
  Set     2570    2571
  Used    2571    2572

SPECPARM_MN2                    Stack                             REAL(KIND=8)
  Decl    2849
  Set     2893    2894
  Used    2894    2895

SPECPARM_MN2O                   Stack                             REAL(KIND=8)
  Decl     523
  Set      573     574     759     760
  Used     574     575     760     761

SPECPARM_MN2O                   Stack                             REAL(KIND=8)
  Decl    1885
  Set     1932    1933
  Used    1933    1934

SPECPARM_MO3                    Stack                             REAL(KIND=8)
  Decl    1107
  Set     1156    1157
  Used    1157    1158

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl     525
  Set      592     593     778     779
  Used     593     594     779     780

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl     842
  Set      880     881    1041    1042
  Used     881     882    1042    1043

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1108
  Set     1163    1164    1332    1333
  Used    1164    1165    1333    1334

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1479
  Set     1545    1546
  Used    1546    1547

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    1886
  Set     1951    1952
  Used    1952    1953

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2309
  Set     2347    2348
  Used    2348    2349

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2519
  Set     2596    2597
  Used    2597    2598

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    2850
  Set     2900    2901
  Used    2901    2902

SPECPARM_PLANCK                 Stack                             REAL(KIND=8)
  Decl    3078
  Set     3116    3117
  Used    3117    3118

TAUFOR                          Stack                             REAL(KIND=8)
  Decl     348
  Set      377     403
  Used     386     412

TAUFOR                          Stack                             REAL(KIND=8)
  Decl     444
  Set      463     482
  Used     470     489

TAUFOR                          Stack                             REAL(KIND=8)
  Decl     529
  Set      668     790
  Used     725     807

TAUFOR                          Stack                             REAL(KIND=8)
  Decl     846
  Set      956
  Used    1008

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    1112
  Set     1240
  Used    1297

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    1385
  Set     1420
  Used    1429

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    1483
  Set     1621
  Used    1678

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    1755
  Set     1796
  Used    1809

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    1890
  Set     2028
  Used    2085

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2148
  Set     2165    2184
  Used    2172    2191

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2221
  Set     2243    2266
  Used    2252    2275

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2313
  Set     2423
  Used    2475

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2523
  Set     2673
  Used    2735

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2778
  Set     2794
  Used    2801

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    2854
  Set     2978
  Used    3035

TAUFOR                          Stack                             REAL(KIND=8)
  Decl    3082
  Set     3192
  Used    3244

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 140), INTENT(OUT)
  Decl      79     292
  Set 
  Used     299     300     301     302     303     304     305     306     307     308     309     310     311     312     313
           314

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     319     344
  Set      381     407
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     420     440
  Set      465     484
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     497     516
  Set      724     797
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl     817     835
  Set     1007    1051    1068    1069    1070    1071    1072    1073    1074
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1081    1100
  Set     1296    1342
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1361    1380
  Set     1424    1442
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1452    1471
  Set     1677    1707    1719    1720    1721    1722    1723    1724
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1731    1751
  Set     1804    1843
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    1859    1878
  Set     2084    2114
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2127    2144
  Set     2167    2186
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2199    2217
  Set     2247    2270
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2284    2302
  Set     2474    2484
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2492    2510
  Set     2734    2749
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2757    2774
  Set     2796    2811
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    2823    2842
  Set     3034    3045
  Used

TAUG                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(OUT)
  Decl    3053    3071
  Set     3243    3255
  Used

TAUGB1                                                            Subroutine, Internal procedure
  Decl     319
  Set 
  Used     299

TAUGB10                                                           Subroutine, Internal procedure
  Decl    2127
  Set 
  Used     308

TAUGB11                                                           Subroutine, Internal procedure
  Decl    2199
  Set 
  Used     309

TAUGB12                                                           Subroutine, Internal procedure
  Decl    2284
  Set 
  Used     310

TAUGB13                                                           Subroutine, Internal procedure
  Decl    2492
  Set 
  Used     311

TAUGB14                                                           Subroutine, Internal procedure
  Decl    2757
  Set 
  Used     312

TAUGB15                                                           Subroutine, Internal procedure
  Decl    2823
  Set 
  Used     313

TAUGB16                                                           Subroutine, Internal procedure
  Decl    3053
  Set 
  Used     314

TAUGB2                                                            Subroutine, Internal procedure
  Decl     420
  Set 
  Used     300

TAUGB3                                                            Subroutine, Internal procedure
  Decl     497
  Set 
  Used     301

TAUGB4                                                            Subroutine, Internal procedure
  Decl     817
  Set 
  Used     302

TAUGB5                                                            Subroutine, Internal procedure
  Decl    1081
  Set 
  Used     303

TAUGB6                                                            Subroutine, Internal procedure
  Decl    1361
  Set 
  Used     304

TAUGB7                                                            Subroutine, Internal procedure
  Decl    1452
  Set 
  Used     305

TAUGB8                                                            Subroutine, Internal procedure
  Decl    1731
  Set 
  Used     306

TAUGB9                                                            Subroutine, Internal procedure
  Decl    1859
  Set 
  Used     307

TAUMOL                                                            Subroutine, Module procedure
  Decl      32
  Set 
  Used

TAUN2                           Stack                             REAL(KIND=8)
  Decl     348
  Set      379     405
  Used     386     412

TAUN2                           Stack                             REAL(KIND=8)
  Decl    2854
  Set     2984
  Used    3036

TAUO2                           Stack                             REAL(KIND=8)
  Decl    2221
  Set     2245    2268
  Used    2253    2276

TAUSELF                         Stack                             REAL(KIND=8)
  Decl     348
  Set      375
  Used     386

TAUSELF                         Stack                             REAL(KIND=8)
  Decl     444
  Set      461
  Used     470

TAUSELF                         Stack                             REAL(KIND=8)
  Decl     529
  Set      666
  Used     725

TAUSELF                         Stack                             REAL(KIND=8)
  Decl     846
  Set      954
  Used    1008

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    1112
  Set     1238
  Used    1297

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    1385
  Set     1418
  Used    1429

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    1483
  Set     1619
  Used    1678

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    1755
  Set     1794
  Used    1809

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    1890
  Set     2026
  Used    2085

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2148
  Set     2163
  Used    2172

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2221
  Set     2241
  Used    2252

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2313
  Set     2421
  Used    2475

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2523
  Set     2671
  Used    2735

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2778
  Set     2792
  Used    2801

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    2854
  Set     2976
  Used    3035

TAUSELF                         Stack                             REAL(KIND=8)
  Decl    3082
  Set     3190
  Used    3244

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl     531
  Set      677     685     693
  Used     724

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl     848
  Set      960     968     976
  Used    1007

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    1114
  Set     1249    1257    1265
  Used    1296

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    1486
  Set     1630    1638    1646
  Used    1677

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    1893
  Set     2037    2045    2053
  Used    2084

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    2315
  Set     2427    2435    2443
  Used    2474

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    2527
  Set     2687    2695    2703
  Used    2734

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    2856
  Set     2987    2995    3003
  Used    3034

TAU_MAJOR                       Stack                             REAL(KIND=8)
  Decl    3084
  Set     3196    3204    3212
  Used    3243

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl     531
  Set      701     709     717
  Used     724

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl     848
  Set      984     992    1000
  Used    1007

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    1114
  Set     1273    1281    1289
  Used    1296

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    1486
  Set     1654    1662    1670
  Used    1677

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    1893
  Set     2061    2069    2077
  Used    2084

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    2315
  Set     2451    2459    2467
  Used    2474

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    2527
  Set     2711    2719    2727
  Used    2734

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    2856
  Set     3011    3019    3027
  Used    3034

TAU_MAJOR1                      Stack                             REAL(KIND=8)
  Decl    3084
  Set     3220    3228    3236
  Used    3243

WX                              Dummy Arg                         REAL(KIND=8), DIMENSION(4, <exp>), INTENT(IN)
  Decl      35     220
  Set 
  Used    1299    1352    1431    1432    1443    1444    1813    1814    1850    1851


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
INT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 562, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 569, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 576, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 595, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 739, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 746, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 762, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 781, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 869, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 876, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 883, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1021, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1028, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1044, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1145, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1152, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1159, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1166, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1312, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1319, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1335, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1514, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1521, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1529, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1548, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1921, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1928, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1935, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1954, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2336, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2343, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2350, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2559, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2566, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2573, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2592, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2599, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2882, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2889, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2896, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2903, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3105, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3112, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3119, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
MAX(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1529, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1548, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
MOD(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 563, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 570, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 577, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 596, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 740, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 747, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 763, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 782, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 870, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 877, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 884, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1022, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1029, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1045, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1146, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1153, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1160, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1167, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1313, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1320, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1336, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1515, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1522, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1530, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1549, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1922, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1929, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1936, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 1955, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2337, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2344, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2351, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2560, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2567, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2574, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2593, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2600, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2883, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2890, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2897, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 2904, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3106, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3113, file rrtmg_lw_taumol.f90)
                   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 3120, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
PARRRTM
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_CON
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG01
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG02
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG03
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG04
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG05
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG06
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG07
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG08
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG09
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG10
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG11
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG12
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG13
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG14
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG15
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_KG16
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_REF
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL
                   RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_VSN
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRLW_WVN
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
RRTMG_LW_TAUMOL
      Defined as:  Module (line 6, file rrtmg_lw_taumol.f90)

        Uses:      SHR_KIND_MOD
                   PARRRTM
                   RRLW_CON
                   RRLW_WVN
                   RRLW_VSN
                   PARRRTM
                   RRLW_KG01
                   PARRRTM
                   RRLW_KG02
                   PARRRTM
                   RRLW_REF
                   RRLW_KG03
                   PARRRTM
                   RRLW_REF
                   RRLW_KG04
                   PARRRTM
                   RRLW_REF
                   RRLW_KG05
                   PARRRTM
                   RRLW_REF
                   RRLW_KG06
                   PARRRTM
                   RRLW_REF
                   RRLW_KG07
                   PARRRTM
                   RRLW_REF
                   RRLW_KG08
                   PARRRTM
                   RRLW_REF
                   RRLW_KG09
                   PARRRTM
                   RRLW_KG10
                   PARRRTM
                   RRLW_KG11
                   PARRRTM
                   RRLW_REF
                   RRLW_KG12
                   PARRRTM
                   RRLW_REF
                   RRLW_KG13
                   PARRRTM
                   RRLW_KG14
                   PARRRTM
                   RRLW_REF
                   RRLW_KG15
                   PARRRTM
                   RRLW_REF
                   RRLW_KG16

Name  Messages
----  --------
SHR_KIND_MOD
      Defined as:  No definitions.

      Used By:     RRTMG_LW_TAUMOL

Name  Messages
----  --------
TAUGB1 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 319, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB1 in TAUMOL in RRTMG_LW_TAUMOL (Line 299, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB1 in TAUMOL in RRTMG_LW_TAUMOL (Line 299, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB1 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB10 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2127, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB10 in TAUMOL in RRTMG_LW_TAUMOL (Line 308, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB10 in TAUMOL in RRTMG_LW_TAUMOL (Line 308, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB10 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB11 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2199, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB11 in TAUMOL in RRTMG_LW_TAUMOL (Line 309, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB11 in TAUMOL in RRTMG_LW_TAUMOL (Line 309, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB11 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB12 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2284, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB12 in TAUMOL in RRTMG_LW_TAUMOL (Line 310, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB12 in TAUMOL in RRTMG_LW_TAUMOL (Line 310, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB12 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB13 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2492, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB13 in TAUMOL in RRTMG_LW_TAUMOL (Line 311, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB13 in TAUMOL in RRTMG_LW_TAUMOL (Line 311, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB13 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB14 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2757, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB14 in TAUMOL in RRTMG_LW_TAUMOL (Line 312, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB14 in TAUMOL in RRTMG_LW_TAUMOL (Line 312, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB14 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB15 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 2823, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB15 in TAUMOL in RRTMG_LW_TAUMOL (Line 313, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB15 in TAUMOL in RRTMG_LW_TAUMOL (Line 313, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB15 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 3053, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 314, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB16 in TAUMOL in RRTMG_LW_TAUMOL (Line 314, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 562, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 569, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 576, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 595, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 739, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 746, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 762, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 781, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 563, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 570, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 577, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 596, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 740, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 747, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 763, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 782, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 869, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 876, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 883, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1021, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1028, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1044, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 870, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 877, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 884, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1022, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1029, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1045, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1145, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1152, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1159, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1166, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1312, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1319, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1335, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1146, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1153, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1160, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1167, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1313, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1320, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1336, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1514, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1521, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1529, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1548, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1515, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1522, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1530, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1549, file rrtmg_lw_taumol.f90)
                   MAX(Intrinsic) (Line 1529, file rrtmg_lw_taumol.f90)
                   MAX(Intrinsic) (Line 1548, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1921, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1928, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1935, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 1954, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1922, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1929, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1936, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 1955, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2336, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2343, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2350, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2337, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2344, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2351, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2559, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2566, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2573, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2592, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2599, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2560, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2567, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2574, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2593, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2600, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2882, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2889, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2896, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 2903, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2883, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2890, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2897, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 2904, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 3105, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 3112, file rrtmg_lw_taumol.f90)
                   INT(Intrinsic) (Line 3119, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 3106, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 3113, file rrtmg_lw_taumol.f90)
                   MOD(Intrinsic) (Line 3120, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB16 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB2 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 420, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB2 in TAUMOL in RRTMG_LW_TAUMOL (Line 300, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB2 in TAUMOL in RRTMG_LW_TAUMOL (Line 300, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB2 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB3 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 497, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB3 in TAUMOL in RRTMG_LW_TAUMOL (Line 301, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB3 in TAUMOL in RRTMG_LW_TAUMOL (Line 301, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB3 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB4 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 817, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB4 in TAUMOL in RRTMG_LW_TAUMOL (Line 302, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB4 in TAUMOL in RRTMG_LW_TAUMOL (Line 302, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB4 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB5 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 1081, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB5 in TAUMOL in RRTMG_LW_TAUMOL (Line 303, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB5 in TAUMOL in RRTMG_LW_TAUMOL (Line 303, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB5 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB6 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 1361, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB6 in TAUMOL in RRTMG_LW_TAUMOL (Line 304, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB6 in TAUMOL in RRTMG_LW_TAUMOL (Line 304, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB6 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB7 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 1452, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB7 in TAUMOL in RRTMG_LW_TAUMOL (Line 305, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB7 in TAUMOL in RRTMG_LW_TAUMOL (Line 305, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB7 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB8 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 1731, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB8 in TAUMOL in RRTMG_LW_TAUMOL (Line 306, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB8 in TAUMOL in RRTMG_LW_TAUMOL (Line 306, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB8 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUGB9 in TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 1859, file rrtmg_lw_taumol.f90)

      Interface:   None

      Called By:   TAUGB9 in TAUMOL in RRTMG_LW_TAUMOL (Line 307, file rrtmg_lw_taumol.f90)

      Calls:       TAUGB9 in TAUMOL in RRTMG_LW_TAUMOL (Line 307, file rrtmg_lw_taumol.f90)

Name  Messages
----  --------
TAUGB9 in RRTMG_LW_TAUMOL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
TAUMOL in RRTMG_LW_TAUMOL
      Defined as:  Subroutine (line 32, file rrtmg_lw_taumol.f90)

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
