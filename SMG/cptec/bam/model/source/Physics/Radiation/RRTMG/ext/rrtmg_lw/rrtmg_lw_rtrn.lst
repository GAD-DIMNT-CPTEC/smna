%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_lw/rrtmg_lw_rtrn.f90
Compiled : 12/12/20  00:52:54
Compiler : Version 8.0.6
Target   : x86-64
Command  : /opt/cray/cce/8.0.6/cftn/x86-64/bin/ftn_driver.exe -hcpu=mc12
           -hnetwork=gemini -hstatic -ra -hbyteswapio
           -Onomodinline,vector0,ipa0,fusion0,unroll0,fp0 -homp -sdefault32
           -hdisplay_opt -c -I/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/include
           -I/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/include
           -I/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/include
           -I/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/include
           -I/opt/cray/gni-headers/2.1-1.0400.4351.3.1.gem/include
           -I/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/include
           -I/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/include
           -I/opt/cray-hss-devel/6.0.0/include
           -I/opt/cray/krca/1.0.0-2.0400.31554.3.55.gem/include
           -I/opt/cray/cce/8.0.6/craylibs/x86-64/include
           -I/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/include
           -L/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/lib64
           -L/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/lib64
           -L/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/lib64
           -L/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/lib64
           -L/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/lib64
           -L/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/lib64 -lrca
           -L/opt/cray/cce/8.0.6/craylibs/x86-64 -L/opt/gcc/4.4.4/snos/lib64
           -D__CRAYXE -D__CRAYXT_COMPUTE_LINUX_TARGET -D__TARGET_LINUX__
           -I/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/include
           -I/opt/xt-libsci/11.1.01/cray/74/mc12/include
           -I/opt/cray/hdf5/1.8.8/cray/74/include
           -I/opt/cray/netcdf/4.2.0/cray/74/include
           -L/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/lib
           -L/opt/xt-libsci/11.1.01/cray/74/mc12/lib
           -L/opt/cray/hdf5/1.8.8/cray/74/lib
           -L/opt/cray/netcdf/4.2.0/cray/74/lib -lnetcdff_cray -lnetcdf_cray
           -lhdf5hl_fortran_cray -lhdf5_hl_cray -lhdf5_fortran_cray -lhdf5_cray
           -lz -lscicpp_cray -lsci_cray_mp -lmpichf90_cray -lmpich_cray -lmpl
           -lxpmem -ldmapp -lpmi -lugni -lalpslli -lalpsutil -ludreg
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib/alps
           -L/usr/lib/alps rrtmg_lw_rtrn.f90

ftnlx report
------------
Source   : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_lw/rrtmg_lw_rtrn.f90
Date     : 12/12/2020  00:52:55


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          O p t i o n s   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Options :  -O cache2,fp0,scalar2,thread2,vector0,mpi0,nomodinline,ipa0,noaggress
           -O autoprefetch,noautothread,fusion0,nomsgs,negmsgs,nooverindex
           -O nopattern,shortcircuit2,unroll0,nozeroinc
           -h noadd_paren,align_arrays,nocaf,dwarf,fp_trap,nofunc_trace,nomessag
           e
           -h noomp_analyze,noomp_trace,nopat_trace
           -h omp,noomp_acc,noacc
           -h flex_mp=default
           -h cpu=x86-64,mc12,gemini
           -s default32
           -eh
           -d acdgjmnopvwBDEFILPQRSTZ0
           -e qsAC 
           -f free
           -m3
           -S /tmp/pe_6602/rrtmg_lw_rtrn_1.s


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


     %%%    L o o p m a r k   L e g e n d    %%%

     Primary Loop Type        Modifiers
     ------- ---- ----        ---------
     A - Pattern matched      a - atomic memory operation
                              b - blocked
     C - Collapsed            c - conditional and/or computed
     D - Deleted               
     E - Cloned               f - fused
     G - Accelerated          g - partitioned
     I - Inlined              i - interchanged
     M - Multithreaded        m - partitioned
                              n - non-blocking remote transfer
                              p - partial
                              r - unrolled
                              s - shortloop
     V - Vectorized           w - unwound


    1.          !     path:      $Source: /storm/rc1/cvsroot/rc/rrtmg_lw/src/rrtmg_lw_rtrn.f90,v $
    2.          !     author:    $Author: mike $
    3.          !     revision:  $Revision: 1.3 $
    4.          !     created:   $Date: 2008/04/24 16:17:28 $
    5.          !
    6.                module rrtmg_lw_rtrn
    7.          
    8.          !  --------------------------------------------------------------------------
    9.          ! |                                                                          |
   10.          ! |  Copyright 2002-2007, Atmospheric & Environmental Research, Inc. (AER).  |
   11.          ! |  This software may be used, copied, or redistributed as long as it is    |
   12.          ! |  not sold and this copyright notice is reproduced on each copy made.     |
   13.          ! |  This model is provided as is without any express or implied warranties. |
   14.          ! |                       (http://www.rtweb.aer.com/)                        |
   15.          ! |                                                                          |
   16.          !  --------------------------------------------------------------------------
   17.          
   18.          ! --------- Modules ----------
   19.          
   20.                use shr_kind_mod, only: r8 => shr_kind_r8
   21.          
   22.          !      use parkind, only : jpim, jprb 
   23.                use parrrtm, only : mg, nbndlw, ngptlw
   24.                use rrlw_con, only: fluxfac, heatfac
   25.                use rrlw_wvn, only: delwave, ngs
   26.                use rrlw_tbl, only: tblint, bpade, tau_tbl, exp_tbl, tfn_tbl
   27.                use rrlw_vsn, only: hvrrtr, hnamrtr
   28.          
   29.                implicit none
   30.          
   31.                contains
   32.          
   33.          !-----------------------------------------------------------------------------
   34.                subroutine rtrn( &           !    call rtrn( &
   35.                                nlayers   , &!           nlayers                          , &
   36.                                istart    , &!           istart                           , &
   37.                                iend      , &!           iend                             , &
   38.                                iout      , &!           iout                             , &
   39.                                pz        , &!           pz        (0:nlayers)            , &
   40.                                semiss    , &!           semiss    (1:nbndlw)             , &
   41.                                ncbands   , &!           ncbands                          , &
   42.                                cldfrac   , &!           cldfrac   (1:nlayers)            , &
   43.                                taucloud  , &!           taucloud  (1:nlayers ,1:nbndlw)  , &
   44.                                planklay  , &!           planklay  (1:nlayers ,1:nbndlw)  , &
   45.                                planklev  , &!           planklev  (0:nlayers ,1:nbndlw)  , &
   46.                                plankbnd  , &!           plankbnd  (1:nbndlw)             , &
   47.                                pwvcm     , &!           pwvcm                            , &
   48.                                fracs     , &!           fracs     (1:nlayers,1:ngptlw)   , &
   49.                                taut      , &!           taut      (1:nlayers,1:ngptlw)   , &
   50.                                totuflux  , &!           totuflux  (0:nlayers)            , &
   51.                                totdflux  , &!           totdflux  (0:nlayers)            , &
   52.                                fnet      , &!           fnet      (0:nlayers)            , &
   53.                                htr       , &!           htr       (0:nlayers)            , &
   54.                                totuclfl  , &!           totuclfl  (0:nlayers)            , &
   55.                                totdclfl  , &!           totdclfl  (0:nlayers)            , &
   56.                                fnetc     , &!           fnetc     (0:nlayers)            , &
   57.                                htrc      , &!           htrc      (0:nlayers)            , &
   58.                                totufluxs , &!           totufluxs (1:nbndlw,0:nlayers)   , &
   59.                                totdfluxs   )!           totdfluxs (1:nbndlw,0:nlayers)     )
   60.          !-----------------------------------------------------------------------------
   61.          !
   62.          !  Original version:   E. J. Mlawer, et al. RRTM_V3.0
   63.          !  Revision for GCMs:  Michael J. Iacono; October, 2002
   64.          !  Revision for F90:  Michael J. Iacono; June, 2006
   65.          !
   66.          !  This program calculates the upward fluxes, downward fluxes, and
   67.          !  heating rates for an arbitrary clear or cloudy atmosphere.  The input
   68.          !  to this program is the atmospheric profile, all Planck function
   69.          !  information, and the cloud fraction by layer.  A variable diffusivity 
   70.          !  angle (SECDIFF) is used for the angle integration.  Bands 2-3 and 5-9 
   71.          !  use a value for SECDIFF that varies from 1.50 to 1.80 as a function of 
   72.          !  the column water vapor, and other bands use a value of 1.66.  The Gaussian 
   73.          !  weight appropriate to this angle (WTDIFF=0.5) is applied here.  Note that 
   74.          !  use of the emissivity angle for the flux integration can cause errors of 
   75.          !  1 to 4 W/m2 within cloudy layers.  
   76.          !  Clouds are treated with a random cloud overlap method.
   77.          !***************************************************************************
   78.          
   79.          ! ------- Declarations -------
   80.          
   81.          ! ----- Input -----
   82.                integer, intent(in) :: nlayers                    ! total number of layers
   83.                integer, intent(in) :: istart                     ! beginning band of calculation
   84.                integer, intent(in) :: iend                       ! ending band of calculation
   85.                integer, intent(in) :: iout                       ! output option flag
   86.          
   87.          ! Atmosphere
   88.                real(kind=r8), intent(in) :: pz(0:nlayers)               ! level (interface) pressures (hPa, mb)
   89.                                                                  !    Dimensions: (0:nlayers)
   90.                real(kind=r8), intent(in) :: pwvcm                ! precipitable water vapor (cm)
   91.                real(kind=r8), intent(in) :: semiss(1:nbndlw)             ! lw surface emissivity
   92.                                                                  !    Dimensions: (nbndlw)
   93.                real(kind=r8), intent(in) :: planklay(1:nlayers ,1:nbndlw)        ! 
   94.                                                                  !    Dimensions: (nlayers,nbndlw)
   95.                real(kind=r8), intent(in) :: planklev(0:nlayers ,1:nbndlw)       ! 
   96.                                                                  !    Dimensions: (0:nlayers,nbndlw)
   97.                real(kind=r8), intent(in) :: plankbnd(1:nbndlw)          ! 
   98.                                                                  !    Dimensions: (nbndlw)
   99.                real(kind=r8), intent(in) :: fracs(1:nlayers,1:ngptlw)           ! 
  100.                                                                  !    Dimensions: (nlayers,ngptw)
  101.                real(kind=r8), intent(in) :: taut(1:nlayers,1:ngptlw)            ! gaseous + aerosol optical depths
  102.                                                                  !    Dimensions: (nlayers,ngptlw)
  103.          
  104.          ! Clouds
  105.                integer, intent(in) :: ncbands                    ! number of cloud spectral bands
  106.                real(kind=r8), intent(in) :: cldfrac(1:nlayers)           ! layer cloud fraction
  107.                                                                  !    Dimensions: (nlayers)
  108.                real(kind=r8), intent(in) :: taucloud(1:nlayers ,1:nbndlw)        ! layer cloud optical depth
  109.                                                                  !    Dimensions: (nlayers,nbndlw)
  110.          
  111.          ! ----- Output -----
  112.                real(kind=r8), intent(out) :: totuflux(0:nlayers)        ! upward longwave flux (w/m2)
  113.                                                                  !    Dimensions: (0:nlayers)
  114.                real(kind=r8), intent(out) :: totdflux(0:nlayers)        ! downward longwave flux (w/m2)
  115.                                                                  !    Dimensions: (0:nlayers)
  116.                real(kind=r8), intent(out) :: fnet(0:nlayers)            ! net longwave flux (w/m2)
  117.                                                                  !    Dimensions: (0:nlayers)
  118.                real(kind=r8), intent(out) :: htr(0:nlayers)             ! longwave heating rate (k/day)
  119.                                                                  !    Dimensions: (0:nlayers)
  120.                real(kind=r8), intent(out) :: totuclfl(0:nlayers)        ! clear sky upward longwave flux (w/m2)
  121.                                                                  !    Dimensions: (0:nlayers)
  122.                real(kind=r8), intent(out) :: totdclfl(0:nlayers)        ! clear sky downward longwave flux (w/m2)
  123.                                                                  !    Dimensions: (0:nlayers)
  124.                real(kind=r8), intent(out) :: fnetc(0:nlayers)           ! clear sky net longwave flux (w/m2)
  125.                                                                  !    Dimensions: (0:nlayers)
  126.                real(kind=r8), intent(out) :: htrc(0:nlayers)            ! clear sky longwave heating rate (k/day)
  127.                                                                  !    Dimensions: (0:nlayers)
  128.                real(kind=r8), intent(out) :: totufluxs(1:nbndlw,0:nlayers)     ! upward longwave flux spectral (w/m2)
  129.                                                                  !    Dimensions: (nbndlw, 0:nlayers)
  130.                real(kind=r8), intent(out) :: totdfluxs(1:nbndlw,0:nlayers)     ! downward longwave flux spectral (w/m2)
  131.                                                                  !    Dimensions: (nbndlw, 0:nlayers)
  132.          
  133.          ! ----- Local -----
  134.          ! Declarations for radiative transfer
  135.                real(kind=r8) :: abscld(nlayers,nbndlw)
  136.                real(kind=r8) :: atot(nlayers)
  137.                real(kind=r8) :: atrans(nlayers)
  138.                real(kind=r8) :: bbugas(nlayers)
  139.                real(kind=r8) :: bbutot(nlayers)
  140.                real(kind=r8) :: clrurad(0:nlayers)
  141.                real(kind=r8) :: clrdrad(0:nlayers)
  142.                real(kind=r8) :: efclfrac(nlayers,nbndlw)
  143.                real(kind=r8) :: uflux(0:nlayers)
  144.                real(kind=r8) :: dflux(0:nlayers)
  145.                real(kind=r8) :: urad(0:nlayers)
  146.                real(kind=r8) :: drad(0:nlayers)
  147.                real(kind=r8) :: uclfl(0:nlayers)
  148.                real(kind=r8) :: dclfl(0:nlayers)
  149.                real(kind=r8) :: odcld(nlayers,nbndlw)
  150.          
  151.          
  152.                real(kind=r8) :: secdiff(nbndlw)                   ! secant of diffusivity angle
  153.                real(kind=r8) :: a0(nbndlw),a1(nbndlw),a2(nbndlw)  ! diffusivity angle adjustment coefficients
  154.                real(kind=r8) :: wtdiff, rec_6
  155.                real(kind=r8) :: transcld, radld, radclrd, plfrac, blay, dplankup, dplankdn
  156.                real(kind=r8) :: odepth, odtot, odepth_rec, odtot_rec, gassrc
  157.                real(kind=r8) :: tblind, tfactot, bbd, bbdtot, tfacgas, transc, tausfac
  158.                real(kind=r8) :: rad0, reflect, radlu, radclru
  159.          
  160.                integer :: icldlyr(nlayers)                        ! flag for cloud in layer
  161.                integer :: ibnd, ib, iband, lay, lev, l            ! loop indices
  162.                integer :: igc                                     ! g-point interval counter
  163.                integer :: iclddn                                  ! flag for cloud in down path
  164.                integer :: ittot, itgas, itr                       ! lookup table indices
  165.                integer :: ipat(16,0:2)
  166.          
  167.          
  168.          ! ------- Definitions -------
  169.          ! input
  170.          !    nlayers                      ! number of model layers
  171.          !    ngptlw                       ! total number of g-point subintervals
  172.          !    nbndlw                       ! number of longwave spectral bands
  173.          !    ncbands                      ! number of spectral bands for clouds
  174.          !    secdiff                      ! diffusivity angle
  175.          !    wtdiff                       ! weight for radiance to flux conversion
  176.          !    pavel                        ! layer pressures (mb)
  177.          !    pz                           ! level (interface) pressures (mb)
  178.          !    tavel                        ! layer temperatures (k)
  179.          !    tz                           ! level (interface) temperatures(mb)
  180.          !    tbound                       ! surface temperature (k)
  181.          !    cldfrac                      ! layer cloud fraction
  182.          !    taucloud                     ! layer cloud optical depth
  183.          !    itr                          ! integer look-up table index
  184.          !    icldlyr                      ! flag for cloudy layers
  185.          !    iclddn                       ! flag for cloud in column at any layer
  186.          !    semiss                       ! surface emissivities for each band
  187.          !    reflect                      ! surface reflectance
  188.          !    bpade                        ! 1/(pade constant)
  189.          !    tau_tbl                      ! clear sky optical depth look-up table
  190.          !    exp_tbl                      ! exponential look-up table for transmittance
  191.          !    tfn_tbl                      ! tau transition function look-up table
  192.          
  193.          ! local
  194.          !    atrans                       ! gaseous absorptivity
  195.          !    abscld                       ! cloud absorptivity
  196.          !    atot                         ! combined gaseous and cloud absorptivity
  197.          !    odclr                        ! clear sky (gaseous) optical depth
  198.          !    odcld                        ! cloud optical depth
  199.          !    odtot                        ! optical depth of gas and cloud
  200.          !    tfacgas                      ! gas-only pade factor, used for planck fn
  201.          !    tfactot                      ! gas and cloud pade factor, used for planck fn
  202.          !    bbdgas                       ! gas-only planck function for downward rt
  203.          !    bbugas                       ! gas-only planck function for upward rt
  204.          !    bbdtot                       ! gas and cloud planck function for downward rt
  205.          !    bbutot                       ! gas and cloud planck function for upward calc.
  206.          !    gassrc                       ! source radiance due to gas only
  207.          !    efclfrac                     ! effective cloud fraction
  208.          !    radlu                        ! spectrally summed upward radiance 
  209.          !    radclru                      ! spectrally summed clear sky upward radiance 
  210.          !    urad                         ! upward radiance by layer
  211.          !    clrurad                      ! clear sky upward radiance by layer
  212.          !    radld                        ! spectrally summed downward radiance 
  213.          !    radclrd                      ! spectrally summed clear sky downward radiance 
  214.          !    drad                         ! downward radiance by layer
  215.          !    clrdrad                      ! clear sky downward radiance by layer
  216.          
  217.          ! output
  218.          !    totuflux                     ! upward longwave flux (w/m2)
  219.          !    totdflux                     ! downward longwave flux (w/m2)
  220.          !    fnet                         ! net longwave flux (w/m2)
  221.          !    htr                          ! longwave heating rate (k/day)
  222.          !    totuclfl                     ! clear sky upward longwave flux (w/m2)
  223.          !    totdclfl                     ! clear sky downward longwave flux (w/m2)
  224.          !    fnetc                        ! clear sky net longwave flux (w/m2)
  225.          !    htrc                         ! clear sky longwave heating rate (k/day)
  226.          
  227.          ! These arrays indicate the spectral 'region' (used in the 
  228.          ! calculation of ice cloud optical depths) corresponding
  229.          ! to each spectral band.  See cldprop.f for more details.
  230.                data ipat /1,1,1,1,1,1,1,1,1, 1, 1, 1, 1, 1, 1, 1, &
  231.                           1,2,3,3,3,4,4,4,5, 5, 5, 5, 5, 5, 5, 5, &
  232.                           1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16/
  233.          
  234.          ! This secant and weight corresponds to the standard diffusivity 
  235.          ! angle.  This initial value is redefined below for some bands.
  236.                data wtdiff /0.5_r8/
  237.                data rec_6 /0.166667_r8/
  238.          
  239.          ! Reset diffusivity angle for Bands 2-3 and 5-9 to vary (between 1.50
  240.          ! and 1.80) as a function of total column water vapor.  The function
  241.          ! has been defined to minimize flux and cooling rate errors in these bands
  242.          ! over a wide range of precipitable water values.
  243.                data a0 / 1.66_r8,  1.55_r8,  1.58_r8,  1.66_r8, &
  244.                          1.54_r8, 1.454_r8,  1.89_r8,  1.33_r8, &
  245.                         1.668_r8,  1.66_r8,  1.66_r8,  1.66_r8, &
  246.                          1.66_r8,  1.66_r8,  1.66_r8,  1.66_r8 /
  247.                data a1 / 0.00_r8,  0.25_r8,  0.22_r8,  0.00_r8, &
  248.                          0.13_r8, 0.446_r8, -0.10_r8,  0.40_r8, &
  249.                        -0.006_r8,  0.00_r8,  0.00_r8,  0.00_r8, &
  250.                          0.00_r8,  0.00_r8,  0.00_r8,  0.00_r8 /
  251.                data a2 / 0.00_r8, -12.0_r8, -11.7_r8,  0.00_r8, &
  252.                         -0.72_r8,-0.243_r8,  0.19_r8,-0.062_r8, &
  253.                         0.414_r8,  0.00_r8,  0.00_r8,  0.00_r8, &
  254.                          0.00_r8,  0.00_r8,  0.00_r8,  0.00_r8 /
  255.          
  256.                hvrrtr = '$Revision: 1.3 $'
  257.          
  258.  1-----<       do ibnd = 1,nbndlw
  259.  1                if (ibnd.eq.1 .or. ibnd.eq.4 .or. ibnd.ge.10) then
  260.  1                  secdiff(ibnd) = 1.66_r8
  261.  1                else
  262.  1                  secdiff(ibnd) = a0(ibnd) + a1(ibnd)*exp(a2(ibnd)*pwvcm)
  263.  1                endif
  264.  1----->       enddo
  265.                if (pwvcm.lt.1.0) secdiff(6) = 1.80_r8
  266.                if (pwvcm.gt.7.1) secdiff(7) = 1.50_r8
  267.          
  268.                urad(0) = 0.0_r8
  269.                drad(0) = 0.0_r8
  270.                totuflux(0) = 0.0_r8
  271.                totdflux(0) = 0.0_r8
  272.                clrurad(0) = 0.0_r8
  273.                clrdrad(0) = 0.0_r8
  274.                totuclfl(0) = 0.0_r8
  275.                totdclfl(0) = 0.0_r8
  276.          
  277.  1-----<       do lay = 1, nlayers
  278.  1                urad(lay) = 0.0_r8
  279.  1                drad(lay) = 0.0_r8
  280.  1                totuflux(lay) = 0.0_r8
  281.  1                totdflux(lay) = 0.0_r8
  282.  1                clrurad(lay) = 0.0_r8
  283.  1                clrdrad(lay) = 0.0_r8
  284.  1                totuclfl(lay) = 0.0_r8
  285.  1                totdclfl(lay) = 0.0_r8
  286.  1       
  287.  1 2---<          do ib = 1, ncbands
  288.  1 2                 if (cldfrac(lay) .ge. 1.e-6_r8) then
  289.  1 2                    odcld(lay,ib) = secdiff(ib) * taucloud(lay,ib)
  290.  1 2                    transcld = exp(-odcld(lay,ib))
  291.  1 2                    abscld(lay,ib) = 1. - transcld
  292.  1 2                    efclfrac(lay,ib) = abscld(lay,ib) * cldfrac(lay)
  293.  1 2                    icldlyr(lay) = 1
  294.  1 2                 else
  295.  1 2                    odcld(lay,ib) = 0.0_r8
  296.  1 2                    abscld(lay,ib) = 0.0_r8
  297.  1 2                    efclfrac(lay,ib) = 0.0_r8
  298.  1 2                    icldlyr(lay) = 0
  299.  1 2                 endif
  300.  1 2--->          enddo
  301.  1----->       enddo
  302.          
  303.                igc = 1
  304.          ! Loop over frequency bands.
  305.  1-----<       do iband = istart, iend
  306.  1       
  307.  1       ! Reinitialize g-point counter for each band if output for each band is requested.
  308.  1                if (iout.gt.0.and.iband.ge.2) igc = ngs(iband-1)+1
  309.  1                if (ncbands .eq. 1) then
  310.  1                   ib = ipat(iband,0)
  311.  1                elseif (ncbands .eq.  5) then
  312.  1                   ib = ipat(iband,1)
  313.  1                elseif (ncbands .eq. 16) then
  314.  1                   ib = ipat(iband,2)
  315.  1                endif
  316.  1       
  317.  1       ! Loop over g-channels.
  318.  1        1000    continue
  319.  1       
  320.  1       ! Radiative transfer starts here.
  321.  1                radld = 0._r8
  322.  1                radclrd = 0._r8
  323.  1                iclddn = 0
  324.  1       
  325.  1       ! Downward radiative transfer loop.  
  326.  1       
  327.  1 2---<          do lev = nlayers, 1, -1
  328.  1 2                    plfrac = fracs(lev,igc)
  329.  1 2                    blay = planklay(lev,iband)
  330.  1 2                    dplankup = planklev(lev,iband) - blay
  331.  1 2                    dplankdn = planklev(lev-1,iband) - blay
  332.  1 2                    odepth = secdiff(iband) * taut(lev,igc)
  333.  1 2                    if (odepth .lt. 0.0_r8) odepth = 0.0_r8
  334.  1 2     ! Cloudy layer
  335.  1 2                    if (icldlyr(lev).eq.1) then
  336.  1 2                       iclddn = 1
  337.  1 2                       odtot = odepth + odcld(lev,ib)
  338.  1 2                       if (odtot .lt. 0.06_r8) then
  339.  1 2                          atrans(lev) = odepth - 0.5_r8*odepth*odepth
  340.  1 2                          odepth_rec = rec_6*odepth
  341.  1 2                          gassrc = plfrac*(blay+dplankdn*odepth_rec)*atrans(lev)
  342.  1 2     
  343.  1 2                          atot(lev) =  odtot - 0.5_r8*odtot*odtot
  344.  1 2                          odtot_rec = rec_6*odtot
  345.  1 2                          bbdtot =  plfrac * (blay+dplankdn*odtot_rec)
  346.  1 2                          bbd = plfrac*(blay+dplankdn*odepth_rec)
  347.  1 2                          radld = radld - radld * (atrans(lev) + &
  348.  1 2                              efclfrac(lev,ib) * (1. - atrans(lev))) + &
  349.  1 2                              gassrc + cldfrac(lev) * &
  350.  1 2                              (bbdtot * atot(lev) - gassrc)
  351.  1 2                          drad(lev-1) = drad(lev-1) + radld
  352.  1 2                       
  353.  1 2                          bbugas(lev) =  plfrac * (blay+dplankup*odepth_rec)
  354.  1 2                          bbutot(lev) =  plfrac * (blay+dplankup*odtot_rec)
  355.  1 2     
  356.  1 2                       elseif (odepth .le. 0.06_r8) then
  357.  1 2                          atrans(lev) = odepth - 0.5_r8*odepth*odepth
  358.  1 2                          odepth_rec = rec_6*odepth
  359.  1 2                          gassrc = plfrac*(blay+dplankdn*odepth_rec)*atrans(lev)
  360.  1 2     
  361.  1 2                          odtot = odepth + odcld(lev,ib)
  362.  1 2                          tblind = odtot/(bpade+odtot)
  363.  1 2                          ittot = tblint*tblind + 0.5_r8
  364.  1 2                          tfactot = tfn_tbl(ittot)
  365.  1 2                          bbdtot = plfrac * (blay + tfactot*dplankdn)
  366.  1 2                          bbd = plfrac*(blay+dplankdn*odepth_rec)
  367.  1 2                          atot(lev) = 1._r8 - exp_tbl(ittot)
  368.  1 2     
  369.  1 2                          radld = radld - radld * (atrans(lev) + &
  370.  1 2                              efclfrac(lev,ib) * (1._r8 - atrans(lev))) + &
  371.  1 2                              gassrc + cldfrac(lev) * &
  372.  1 2                              (bbdtot * atot(lev) - gassrc)
  373.  1 2                          drad(lev-1) = drad(lev-1) + radld
  374.  1 2     
  375.  1 2                          bbugas(lev) = plfrac * (blay + dplankup*odepth_rec)
  376.  1 2                          bbutot(lev) = plfrac * (blay + tfactot * dplankup)
  377.  1 2     
  378.  1 2                       else
  379.  1 2     
  380.  1 2                          tblind = odepth/(bpade+odepth)
  381.  1 2                          itgas = tblint*tblind+0.5_r8
  382.  1 2                          odepth = tau_tbl(itgas)
  383.  1 2                          atrans(lev) = 1._r8 - exp_tbl(itgas)
  384.  1 2                          tfacgas = tfn_tbl(itgas)
  385.  1 2                          gassrc = atrans(lev) * plfrac * (blay + tfacgas*dplankdn)
  386.  1 2     
  387.  1 2                          odtot = odepth + odcld(lev,ib)
  388.  1 2                          tblind = odtot/(bpade+odtot)
  389.  1 2                          ittot = tblint*tblind + 0.5_r8
  390.  1 2                          tfactot = tfn_tbl(ittot)
  391.  1 2                          bbdtot = plfrac * (blay + tfactot*dplankdn)
  392.  1 2                          bbd = plfrac*(blay+tfacgas*dplankdn)
  393.  1 2                          atot(lev) = 1._r8 - exp_tbl(ittot)
  394.  1 2     
  395.  1 2                       radld = radld - radld * (atrans(lev) + &
  396.  1 2                          efclfrac(lev,ib) * (1._r8 - atrans(lev))) + &
  397.  1 2                          gassrc + cldfrac(lev) * &
  398.  1 2                          (bbdtot * atot(lev) - gassrc)
  399.  1 2                       drad(lev-1) = drad(lev-1) + radld
  400.  1 2                       bbugas(lev) = plfrac * (blay + tfacgas * dplankup)
  401.  1 2                       bbutot(lev) = plfrac * (blay + tfactot * dplankup)
  402.  1 2                       endif
  403.  1 2     ! Clear layer
  404.  1 2                    else
  405.  1 2                       if (odepth .le. 0.06_r8) then
  406.  1 2                          atrans(lev) = odepth-0.5_r8*odepth*odepth
  407.  1 2                          odepth = rec_6*odepth
  408.  1 2                          bbd = plfrac*(blay+dplankdn*odepth)
  409.  1 2                          bbugas(lev) = plfrac*(blay+dplankup*odepth)
  410.  1 2                       else
  411.  1 2                          tblind = odepth/(bpade+odepth)
  412.  1 2                          itr = tblint*tblind+0.5_r8
  413.  1 2                          transc = exp_tbl(itr)
  414.  1 2                          atrans(lev) = 1._r8-transc
  415.  1 2                          tausfac = tfn_tbl(itr)
  416.  1 2                          bbd = plfrac*(blay+tausfac*dplankdn)
  417.  1 2                          bbugas(lev) = plfrac * (blay + tausfac * dplankup)
  418.  1 2                       endif   
  419.  1 2                       radld = radld + (bbd-radld)*atrans(lev)
  420.  1 2                       drad(lev-1) = drad(lev-1) + radld
  421.  1 2                    endif
  422.  1 2     !  Set clear sky stream to total sky stream as long as layers
  423.  1 2     !  remain clear.  Streams diverge when a cloud is reached (iclddn=1),
  424.  1 2     !  and clear sky stream must be computed separately from that point.
  425.  1 2                       if (iclddn.eq.1) then
  426.  1 2                          radclrd = radclrd + (bbd-radclrd) * atrans(lev) 
  427.  1 2                          clrdrad(lev-1) = clrdrad(lev-1) + radclrd
  428.  1 2                       else
  429.  1 2                          radclrd = radld
  430.  1 2                          clrdrad(lev-1) = drad(lev-1)
  431.  1 2                       endif
  432.  1 2--->             enddo
  433.  1       
  434.  1       ! Spectral emissivity & reflectance
  435.  1       !  Include the contribution of spectrally varying longwave emissivity
  436.  1       !  and reflection from the surface to the upward radiative transfer.
  437.  1       !  Note: Spectral and Lambertian reflection are identical for the
  438.  1       !  diffusivity angle flux integration used here.
  439.  1       
  440.  1                rad0 = fracs(1,igc) * plankbnd(iband)
  441.  1       !  Add in specular reflection of surface downward radiance.
  442.  1                reflect = 1._r8 - semiss(iband)
  443.  1                radlu = rad0 + reflect * radld
  444.  1                radclru = rad0 + reflect * radclrd
  445.  1       
  446.  1       
  447.  1       ! Upward radiative transfer loop.
  448.  1                urad(0) = urad(0) + radlu
  449.  1                clrurad(0) = clrurad(0) + radclru
  450.  1       
  451.  1 2---<          do lev = 1, nlayers
  452.  1 2     ! Cloudy layer
  453.  1 2                 if (icldlyr(lev) .eq. 1) then
  454.  1 2                    gassrc = bbugas(lev) * atrans(lev)
  455.  1 2                    radlu = radlu - radlu * (atrans(lev) + &
  456.  1 2                        efclfrac(lev,ib) * (1._r8 - atrans(lev))) + &
  457.  1 2                        gassrc + cldfrac(lev) * &
  458.  1 2                        (bbutot(lev) * atot(lev) - gassrc)
  459.  1 2                    urad(lev) = urad(lev) + radlu
  460.  1 2     ! Clear layer
  461.  1 2                 else
  462.  1 2                    radlu = radlu + (bbugas(lev)-radlu)*atrans(lev)
  463.  1 2                    urad(lev) = urad(lev) + radlu
  464.  1 2                 endif
  465.  1 2     !  Set clear sky stream to total sky stream as long as all layers
  466.  1 2     !  are clear (iclddn=0).  Streams must be calculated separately at 
  467.  1 2     !  all layers when a cloud is present (iclddn=1), because surface 
  468.  1 2     !  reflectance is different for each stream.
  469.  1 2                    if (iclddn.eq.1) then
  470.  1 2                       radclru = radclru + (bbugas(lev)-radclru)*atrans(lev) 
  471.  1 2                       clrurad(lev) = clrurad(lev) + radclru
  472.  1 2                    else
  473.  1 2                       radclru = radlu
  474.  1 2                       clrurad(lev) = urad(lev)
  475.  1 2                    endif
  476.  1 2--->          enddo
  477.  1       
  478.  1       ! Increment g-point counter
  479.  1                igc = igc + 1
  480.  1       ! Return to continue radiative transfer for all g-channels in present band
  481.  1                if (igc .le. ngs(iband)) go to 1000
  482.  1       
  483.  1       ! Process longwave output from band for total and clear streams.
  484.  1       ! Calculate upward, downward, and net flux.
  485.  1 2---<          do lev = nlayers, 0, -1
  486.  1 2                 uflux(lev) = urad(lev)*wtdiff
  487.  1 2                 dflux(lev) = drad(lev)*wtdiff
  488.  1 2                 urad(lev) = 0.0_r8
  489.  1 2                 drad(lev) = 0.0_r8
  490.  1 2                 totuflux(lev) = totuflux(lev) + uflux(lev) * delwave(iband)
  491.  1 2                 totdflux(lev) = totdflux(lev) + dflux(lev) * delwave(iband)
  492.  1 2                 uclfl(lev) = clrurad(lev)*wtdiff
  493.  1 2                 dclfl(lev) = clrdrad(lev)*wtdiff
  494.  1 2                 clrurad(lev) = 0.0_r8
  495.  1 2                 clrdrad(lev) = 0.0_r8
  496.  1 2                 totuclfl(lev) = totuclfl(lev) + uclfl(lev) * delwave(iband)
  497.  1 2                 totdclfl(lev) = totdclfl(lev) + dclfl(lev) * delwave(iband)
  498.  1 2                 totufluxs(iband,lev) = uflux(lev) * delwave(iband)
  499.  1 2                 totdfluxs(iband,lev) = dflux(lev) * delwave(iband)
  500.  1 2--->          enddo
  501.  1       
  502.  1       ! End spectral band loop
  503.  1----->       enddo
  504.          
  505.          ! Calculate fluxes at surface
  506.                totuflux(0) = totuflux(0) * fluxfac
  507.                totdflux(0) = totdflux(0) * fluxfac
  508.  V----<>       totufluxs(:,0) = totufluxs(:,0) * fluxfac
  509.  V----<>       totdfluxs(:,0) = totdfluxs(:,0) * fluxfac
  510.                fnet(0) = totuflux(0) - totdflux(0)
  511.                totuclfl(0) = totuclfl(0) * fluxfac
  512.                totdclfl(0) = totdclfl(0) * fluxfac
  513.                fnetc(0) = totuclfl(0) - totdclfl(0)
  514.          
  515.          ! Calculate fluxes at model levels
  516.  1-----<       do lev = 1, nlayers
  517.  1                totuflux(lev) = totuflux(lev) * fluxfac
  518.  1                totdflux(lev) = totdflux(lev) * fluxfac
  519.  1 V--<>          totufluxs(:,lev) = totufluxs(:,lev) * fluxfac
  520.  1 V--<>          totdfluxs(:,lev) = totdfluxs(:,lev) * fluxfac
  521.  1                fnet(lev) = totuflux(lev) - totdflux(lev)
  522.  1                totuclfl(lev) = totuclfl(lev) * fluxfac
  523.  1                totdclfl(lev) = totdclfl(lev) * fluxfac
  524.  1                fnetc(lev) = totuclfl(lev) - totdclfl(lev)
  525.  1                l = lev - 1
  526.  1       
  527.  1       ! Calculate heating rates at model layers
  528.  1                htr(l)=heatfac*(fnet(l)-fnet(lev))/(pz(l)-pz(lev)) 
  529.  1                htrc(l)=heatfac*(fnetc(l)-fnetc(lev))/(pz(l)-pz(lev)) 
  530.  1----->       enddo
  531.          
  532.          ! Set heating rate to zero in top layer
  533.                htr(nlayers) = 0.0_r8
  534.                htrc(nlayers) = 0.0_r8
  535.          
  536.                end subroutine rtrn
  537.          
  538.                end module rrtmg_lw_rtrn

ftn-6315 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 305 
  A loop starting at line 305 was not vectorized because the target array (atrans) would require rank expansion.

ftn-6315 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 318 
  A loop starting at line 318 was not vectorized because the target array (atrans) would require rank expansion.

ftn-6204 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 508 
  A loop starting at line 508 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 509 
  A loop starting at line 509 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 519 
  A loop starting at line 519 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_lw_rtrn.f90, Line = 520 
  A loop starting at line 520 was vectorized.

  539.          


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
              C r o s s   R e f e r e n c e   for   RRTMG_LW_RTRN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name                            Storage                           Attributes
----                            -------                           ----------

1000                                                              Statement label
  Decl     318
  Set 
  Used     481

A0                              Static offset=1536                REAL(KIND=8), DIMENSION(16), INITIALIZED, SAVE
  Decl     153
  Set 
  Used     262

A1                              Static offset=5120                REAL(KIND=8), DIMENSION(16), INITIALIZED, SAVE
  Decl     153
  Set 
  Used     262

A2                              Static offset=8704                REAL(KIND=8), DIMENSION(16), INITIALIZED, SAVE
  Decl     153
  Set 
  Used     262

ABSCLD                          Stack                             REAL(KIND=8), DIMENSION(<exp>, 16)
  Decl     135
  Set      291     296
  Used     292

ATOT                            Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     136
  Set      343     367     393
  Used     350     372     398     458

ATRANS                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     137
  Set      339     357     383     406     414
  Used     341     347     348     359     369     370     385     395     396     419     426     454     455     456     462
           470

BBD                             Stack                             REAL(KIND=8)
  Decl     157
  Set      346     366     392     408     416
  Used     419     426

BBDTOT                          Stack                             REAL(KIND=8)
  Decl     157
  Set      345     365     391
  Used     350     372     398

BBUGAS                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     138
  Set      353     375     400     409     417
  Used     454     462     470

BBUTOT                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     139
  Set      354     376     401
  Used     458

BLAY                            Stack                             REAL(KIND=8)
  Decl     155
  Set      329
  Used     330     331     341     345     346     353     354     359     365     366     375     376     385     391     392
           400     401     408     409     416     417

BPADE                           Use assoc                         REAL(KIND=8), From module RRLW_TBL, SAVE
  Decl
  Set 
  Used     362     380     388     411

CLDFRAC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl      42     106
  Set 
  Used     288     292     349     371     397     457

CLRDRAD                         Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     141
  Set      273     283     427     430     495
  Used     493

CLRURAD                         Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     140
  Set      272     282     449     471     474     494
  Used     492

DCLFL                           Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     148
  Set      493
  Used     497

DELWAVE                         Use assoc                         REAL(KIND=8), From module RRLW_WVN, DIMENSION(16), SAVE
  Decl
  Set 
  Used     490     491     496     497     498     499

DFLUX                           Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     144
  Set      487
  Used     491     499

DPLANKDN                        Stack                             REAL(KIND=8)
  Decl     155
  Set      331
  Used     341     345     346     359     365     366     385     391     392     408     416

DPLANKUP                        Stack                             REAL(KIND=8)
  Decl     155
  Set      330
  Used     353     354     375     376     400     401     409     417

DRAD                            Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     146
  Set      269     279     351     373     399     420     489
  Used     430     487

EFCLFRAC                        Stack                             REAL(KIND=8), DIMENSION(<exp>, 16)
  Decl     142
  Set      292     297
  Used     348     370     396     456

EXP                                                               Function, REAL, INTRINSIC
  Decl
  Set 
  Used       0     290

EXP_TBL                         Use assoc                         REAL(KIND=8), From module RRLW_TBL, DIMENSION(0:10000), SAVE
  Decl
  Set 
  Used     367     383     393     413

FLUXFAC                         Use assoc                         REAL(KIND=8), From module RRLW_CON, SAVE
  Decl
  Set 
  Used     506     507     508     509     511     512     517     518     519     520     522     523

FNET                            Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      52     116
  Set      510     521
  Used     528

FNETC                           Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      56     124
  Set      513     524
  Used     529

FRACS                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 140), INTENT(IN)
  Decl      48      99
  Set 
  Used     328     440

GASSRC                          Stack                             REAL(KIND=8)
  Decl     156
  Set      341     359     385     454
  Used     349     350     371     372     397     398     457     458

HEATFAC                         Use assoc                         REAL(KIND=8), From module RRLW_CON, SAVE
  Decl
  Set 
  Used     528     529

HTR                             Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      53     118
  Set      528     533
  Used

HTRC                            Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      57     126
  Set      529     534
  Used

HVRRTR                          Use assoc                         CHARACTER(18), From module RRLW_VSN, SAVE
  Decl
  Set      256
  Used

IB                              Stack                             INTEGER
  Decl     161
  Set      310     312     314
  Used     289     290     291     292     295     296     297     337     348     361     370     387     396     456

IBAND                           Stack                             INTEGER
  Decl     161
  Set 
  Used     308     310     312     314     329     330     331     332     440     442     481     490     491     496     497
           498     499

IBND                            Stack                             INTEGER
  Decl     161
  Set 
  Used     259     260     262

ICLDDN                          Stack                             INTEGER
  Decl     163
  Set      323     336
  Used     425     469

ICLDLYR                         Stack                             INTEGER, DIMENSION(<exp>)
  Decl     160
  Set      293     298
  Used     335     453

IEND                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl      37      84
  Set 
  Used     305

IGC                             Stack                             INTEGER
  Decl     162
  Set      303     308     479
  Used     328     332     440     481

IOUT                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl      38      85
  Set 
  Used

IPAT                            Static offset=0                   INTEGER, DIMENSION(16, 0:2), INITIALIZED, SAVE
  Decl     165
  Set 
  Used     310     312     314

ISTART                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl      36      83
  Set 
  Used

ITGAS                           Stack                             INTEGER
  Decl     164
  Set      381
  Used     382     383     384

ITR                             Stack                             INTEGER
  Decl     164
  Set      412
  Used     413     415

ITTOT                           Stack                             INTEGER
  Decl     164
  Set      363     389
  Used     364     367     390     393

L                               Stack                             INTEGER
  Decl     161
  Set      525
  Used     528     529

LAY                             Stack                             INTEGER
  Decl     161
  Set 
  Used     278     279     280     281     282     283     284     285     288     289     290     291     292     293     295
           296     297     298

LEV                             Stack                             INTEGER
  Decl     161
  Set 
  Used     328     329     330     331     332     335     337     339     341     343     347     348     349     350     351
           353     354     357     359     361     367     369     370     371     372     373     375     376     383     385
           387     393     395     396     397     398     399     400     401     406     409     414     417     419     420
           426     427     430     453     454     455     456     457     458     459     462     463     470     471     474
           486     487     488     489     490     491     492     493     494     495     496     497     498     499     517
           518     519     520     521     522     523     524     525     528     529

NBNDLW                          Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used      91      93      95      97     108     128     130     135     142     149     152     153     258

NCBANDS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl      41     105
  Set 
  Used     287     309     311     313

NGPTLW                          Use assoc                         INTEGER, PARAMETER, From module PARRRTM
  Decl
  Set 
  Used      99     101

NGS                             Use assoc                         INTEGER, From module RRLW_WVN, DIMENSION(16), SAVE
  Decl
  Set 
  Used     308     481

NLAYERS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl      35      82
  Set 
  Used      88      93      95      99     101     106     108     112     114     116     118     120     122     124     126
           128     130     135     136     137     138     139     140     141     142     143     144     145     146     147
           148     149     160     277     451     516     533     534

ODCLD                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 16)
  Decl     149
  Set      289     295
  Used     290     337     361     387

ODEPTH                          Stack                             REAL(KIND=8)
  Decl     156
  Set      332     333     382     407
  Used     333     337     339     340     356     357     358     361     380     387     405     406     408     409     411

ODEPTH_REC                      Stack                             REAL(KIND=8)
  Decl     156
  Set      340     358
  Used     341     346     353     359     366     375

ODTOT                           Stack                             REAL(KIND=8)
  Decl     156
  Set      337     361     387
  Used     338     343     344     362     388

ODTOT_REC                       Stack                             REAL(KIND=8)
  Decl     156
  Set      344
  Used     345     354

PARRRTM                                                           Module
  Decl
  Set 
  Used      23

PLANKBND                        Dummy Arg                         REAL(KIND=8), DIMENSION(16), INTENT(IN)
  Decl      46      97
  Set 
  Used     440

PLANKLAY                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 16), INTENT(IN)
  Decl      44      93
  Set 
  Used     329

PLANKLEV                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>, 16), INTENT(IN)
  Decl      45      95
  Set 
  Used     330     331

PLFRAC                          Stack                             REAL(KIND=8)
  Decl     155
  Set      328
  Used     341     345     346     353     354     359     365     366     375     376     385     391     392     400     401
           408     409     416     417

PWVCM                           Dummy Arg                         REAL(KIND=8), INTENT(IN)
  Decl      47      90
  Set 
  Used     262     265     266

PZ                              Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(IN)
  Decl      39      88
  Set 
  Used     528     529

R8                                                                INTEGER, PARAMETER, Renames SHR_KIND_R8 in SHR_KIND_MOD
  Decl      20
  Set 
  Used      88      90      91      93      95      97      99     101     106     108     112     114     116     118     120
           122     124     126     128     130     135     136     137     138     139     140     141     142     143     144
           145     146     147     148     149     152     153     154     155     156     157     158

RAD0                            Stack                             REAL(KIND=8)
  Decl     158
  Set      440
  Used     443     444

RADCLRD                         Stack                             REAL(KIND=8)
  Decl     155
  Set      322     426     429
  Used     427     444

RADCLRU                         Stack                             REAL(KIND=8)
  Decl     158
  Set      444     470     473
  Used     449     471

RADLD                           Stack                             REAL(KIND=8)
  Decl     155
  Set      321     347     369     395     419
  Used     351     373     399     420     429     443

RADLU                           Stack                             REAL(KIND=8)
  Decl     158
  Set      443     455     462
  Used     448     459     463     473

REC_6                           Static offset=12288               REAL(KIND=8), INITIALIZED, SAVE
  Decl     154
  Set 
  Used     237     340     344     358     407

REFLECT                         Stack                             REAL(KIND=8)
  Decl     158
  Set      442
  Used     443     444

RRLW_CON                                                          Module
  Decl
  Set 
  Used      24

RRLW_TBL                                                          Module
  Decl
  Set 
  Used      26

RRLW_VSN                                                          Module
  Decl
  Set 
  Used      27

RRLW_WVN                                                          Module
  Decl
  Set 
  Used      25

RRTMG_LW_RTRN                                                     Module
  Decl       6
  Set 
  Used

RTRN                                                              Subroutine, Module procedure
  Decl      34
  Set 
  Used

SECDIFF                         Stack                             REAL(KIND=8), DIMENSION(16)
  Decl     152
  Set      260     262     265     266
  Used     289     332

SEMISS                          Dummy Arg                         REAL(KIND=8), DIMENSION(16), INTENT(IN)
  Decl      40      91
  Set 
  Used     442

SHR_KIND_MOD                                                      Module
  Decl
  Set 
  Used      20

TAUCLOUD                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 16), INTENT(IN)
  Decl      43     108
  Set 
  Used     289

TAUSFAC                         Stack                             REAL(KIND=8)
  Decl     157
  Set      415
  Used     416     417

TAUT                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 140), INTENT(IN)
  Decl      49     101
  Set 
  Used     332

TAU_TBL                         Use assoc                         REAL(KIND=8), From module RRLW_TBL, DIMENSION(0:10000), SAVE
  Decl
  Set 
  Used     382

TBLIND                          Stack                             REAL(KIND=8)
  Decl     157
  Set      362     380     388     411
  Used     363     381     389     412

TBLINT                          Use assoc                         REAL(KIND=8), PARAMETER, From module RRLW_TBL
  Decl
  Set 
  Used     363     381     389     412

TFACGAS                         Stack                             REAL(KIND=8)
  Decl     157
  Set      384
  Used     385     392     400

TFACTOT                         Stack                             REAL(KIND=8)
  Decl     157
  Set      364     390
  Used     365     376     391     401

TFN_TBL                         Use assoc                         REAL(KIND=8), From module RRLW_TBL, DIMENSION(0:10000), SAVE
  Decl
  Set 
  Used     364     384     390     415

TOTDCLFL                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      55     122
  Set      275     285     497     512     523
  Used     513     524

TOTDFLUX                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      51     114
  Set      271     281     491     507     518
  Used     510     521

TOTDFLUXS                       Dummy Arg                         REAL(KIND=8), DIMENSION(16, 0:<exp>), INTENT(OUT)
  Decl      59     130
  Set      499     509     520
  Used

TOTUCLFL                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      54     120
  Set      274     284     496     511     522
  Used     513     524

TOTUFLUX                        Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl      50     112
  Set      270     280     490     506     517
  Used     510     521

TOTUFLUXS                       Dummy Arg                         REAL(KIND=8), DIMENSION(16, 0:<exp>), INTENT(OUT)
  Decl      58     128
  Set      498     508     519
  Used

TRANSC                          Stack                             REAL(KIND=8)
  Decl     157
  Set      413
  Used     414

TRANSCLD                        Stack                             REAL(KIND=8)
  Decl     155
  Set      290
  Used     291

UCLFL                           Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     147
  Set      492
  Used     496

UFLUX                           Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     143
  Set      486
  Used     490     498

URAD                            Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     145
  Set      268     278     448     459     463     488
  Used     474     486

WTDIFF                          Static offset=12352               REAL(KIND=8), INITIALIZED, SAVE
  Decl     154
  Set 
  Used     236     486     487     492     493


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
EXP(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   RTRN in RRTMG_LW_RTRN (Line 262, file rrtmg_lw_rtrn.f90)
                   RTRN in RRTMG_LW_RTRN (Line 290, file rrtmg_lw_rtrn.f90)

Name  Messages
----  --------
PARRRTM
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN

Name  Messages
----  --------
RRLW_CON
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN

Name  Messages
----  --------
RRLW_TBL
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN

Name  Messages
----  --------
RRLW_VSN
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN

Name  Messages
----  --------
RRLW_WVN
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN

Name  Messages
----  --------
RRTMG_LW_RTRN
      Defined as:  Module (line 6, file rrtmg_lw_rtrn.f90)

        Uses:      SHR_KIND_MOD
                   PARRRTM
                   RRLW_CON
                   RRLW_WVN
                   RRLW_TBL
                   RRLW_VSN

Name  Messages
----  --------
RTRN in RRTMG_LW_RTRN
      Defined as:  Subroutine (line 34, file rrtmg_lw_rtrn.f90)

      Interface:   None

      Calls:       EXP(Intrinsic) (Line 262, file rrtmg_lw_rtrn.f90)
                   EXP(Intrinsic) (Line 290, file rrtmg_lw_rtrn.f90)

Name  Messages
----  --------
SHR_KIND_MOD
      Defined as:  No definitions.

      Used By:     RRTMG_LW_RTRN


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
