%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_sw/rrtmg_sw_rad.f90
Compiled : 12/12/20  00:22:34
Compiler : Version 8.0.6
Target   : x86-64
Command  : /opt/cray/cce/8.0.6/cftn/x86-64/bin/ftn_driver.exe -hcpu=mc12
           -hnetwork=gemini -hstatic -ra -hbyteswapio
           -Onomodinline,vector0,ipa0,fusion0,unroll0,fp0 -homp -sdefault32
           -hdisplay_opt -c -I/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/include
           -I/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/include
           -I/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/include
           -I/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/include
           -I/opt/cray/gni-headers/2.1-1.0400.4351.3.1.gem/include
           -I/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/include
           -I/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/include
           -I/opt/cray-hss-devel/6.0.0/include
           -I/opt/cray/krca/1.0.0-2.0400.31554.3.55.gem/include
           -I/opt/cray/cce/8.0.6/craylibs/x86-64/include
           -I/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/include
           -L/opt/cray/udreg/2.3.1-1.0400.4264.3.1.gem/lib64
           -L/opt/cray/ugni/2.3-1.0400.4374.4.88.gem/lib64
           -L/opt/cray/pmi/3.0.1-1.0000.9101.2.26.gem/lib64
           -L/opt/cray/dmapp/3.2.1-1.0400.4255.2.159.gem/lib64
           -L/opt/cray/xpmem/0.1-2.0400.31280.3.1.gem/lib64
           -L/opt/cray/rca/1.0.0-2.0400.31553.3.58.gem/lib64 -lrca
           -L/opt/cray/cce/8.0.6/craylibs/x86-64 -L/opt/gcc/4.4.4/snos/lib64
           -D__CRAYXE -D__CRAYXT_COMPUTE_LINUX_TARGET -D__TARGET_LINUX__
           -I/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/include
           -I/opt/xt-libsci/11.1.01/cray/74/mc12/include
           -I/opt/cray/hdf5/1.8.8/cray/74/include
           -I/opt/cray/netcdf/4.2.0/cray/74/include
           -L/opt/cray/mpt/5.5.4/gni/mpich2-cray/74/lib
           -L/opt/xt-libsci/11.1.01/cray/74/mc12/lib
           -L/opt/cray/hdf5/1.8.8/cray/74/lib
           -L/opt/cray/netcdf/4.2.0/cray/74/lib -lnetcdff_cray -lnetcdf_cray
           -lhdf5hl_fortran_cray -lhdf5_hl_cray -lhdf5_fortran_cray -lhdf5_cray
           -lz -lscicpp_cray -lsci_cray_mp -lmpichf90_cray -lmpich_cray -lmpl
           -lxpmem -ldmapp -lpmi -lugni -lalpslli -lalpsutil -ludreg
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/lib64
           -L/opt/cray/xe-sysroot/4.0.46.securitypatch.20120828/usr/lib/alps
           -L/usr/lib/alps rrtmg_sw_rad.f90

ftnlx report
------------
Source   : /scratchin/grupos/bam/home/paulo.kubota/bam_hybrid-2.0/model/source_cray_dbx_diffusion_save_rad_sfc_ibis_restart/Physics/Radiation/RRTMG/ext/rrtmg_sw/rrtmg_sw_rad.f90
Date     : 12/12/2020  00:22:41


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          O p t i o n s   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Options :  -O cache2,fp0,scalar2,thread2,vector0,mpi0,nomodinline,ipa0,noaggress
           -O autoprefetch,noautothread,fusion0,nomsgs,negmsgs,nooverindex
           -O nopattern,shortcircuit2,unroll0,nozeroinc
           -h noadd_paren,align_arrays,nocaf,dwarf,fp_trap,nofunc_trace,nomessag
           e
           -h noomp_analyze,noomp_trace,nopat_trace
           -h omp,noomp_acc,noacc
           -h flex_mp=default
           -h cpu=x86-64,mc12,gemini
           -s default32
           -eh
           -d acdgjmnopvwBDEFILPQRSTZ0
           -e qsAC 
           -f free
           -m3
           -S /tmp/pe_10031/rrtmg_sw_rad_1.s


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


     %%%    L o o p m a r k   L e g e n d    %%%

     Primary Loop Type        Modifiers
     ------- ---- ----        ---------
     A - Pattern matched      a - atomic memory operation
                              b - blocked
     C - Collapsed            c - conditional and/or computed
     D - Deleted               
     E - Cloned               f - fused
     G - Accelerated          g - partitioned
     I - Inlined              i - interchanged
     M - Multithreaded        m - partitioned
                              n - non-blocking remote transfer
                              p - partial
                              r - unrolled
                              s - shortloop
     V - Vectorized           w - unwound


    1.               !     path:      $Source: /storm/rc1/cvsroot/rc/rrtmg_sw/src/rrtmg_sw.f90,v $
    2.               !     author:    $Author: mike $
    3.               !     revision:  $Revision: 1.6 $
    4.               !     created:   $Date: 2008/01/03 21:35:35 $
    5.               !
    6.               !  Modified by Tarassova 2015
    7.               !  Climate aerosol (Kinne, 2013) (coarse mode) included
    8.               !  Fine aerosol mode is included
    9.               !  Modifications are marked by
   10.               !  !tar begin.....!tar end
   11.               
   12.               
   13.                      module rrtmg_sw_rad
   14.               
   15.               !  --------------------------------------------------------------------------
   16.               ! |                                                                          |
   17.               ! |  Copyright 2002-2007, Atmospheric & Environmental Research, Inc. (AER).  |
   18.               ! |  This software may be used, copied, or redistributed as long as it is    |
   19.               ! |  not sold and this copyright notice is reproduced on each copy made.     |
   20.               ! |  This model is provided as is without any express or implied warranties. |
   21.               ! |                       (http://www.rtweb.aer.com/)                        |
   22.               ! |                                                                          |
   23.               !  --------------------------------------------------------------------------
   24.               !
   25.               ! ****************************************************************************
   26.               ! *                                                                          *
   27.               ! *                             RRTMG_SW                                     *
   28.               ! *                                                                          *
   29.               ! *                                                                          *
   30.               ! *                                                                          *
   31.               ! *                 a rapid radiative transfer model                         *
   32.               ! *                  for the solar spectral region                           *
   33.               ! *           for application to general circulation models                  *
   34.               ! *                                                                          *
   35.               ! *                                                                          *
   36.               ! *           Atmospheric and Environmental Research, Inc.                   *
   37.               ! *                       131 Hartwell Avenue                                *
   38.               ! *                       Lexington, MA 02421                                *
   39.               ! *                                                                          *
   40.               ! *                                                                          *
   41.               ! *                          Eli J. Mlawer                                   *
   42.               ! *                       Jennifer S. Delamere                               *
   43.               ! *                        Michael J. Iacono                                 *
   44.               ! *                        Shepard A. Clough                                 *
   45.               ! *                                                                          *
   46.               ! *                                                                          *
   47.               ! *                                                                          *
   48.               ! *                                                                          *
   49.               ! *                                                                          *
   50.               ! *                                                                          *
   51.               ! *                      email:  miacono@aer.com                             *
   52.               ! *                      email:  emlawer@aer.com                             *
   53.               ! *                      email:  jdelamer@aer.com                            *
   54.               ! *                                                                          *
   55.               ! *       The authors wish to acknowledge the contributions of the           *
   56.               ! *       following people:  Steven J. Taubman, Patrick D. Brown,            *
   57.               ! *       Ronald E. Farren, Luke Chen, Robert Bergstrom.                     *
   58.               ! *                                                                          *
   59.               ! ****************************************************************************
   60.               
   61.               ! --------- Modules ---------
   62.               
   63.                     use shr_kind_mod, only: r8 => shr_kind_r8
   64.               
   65.               !      use parkind, only : jpim, jprb
   66.                     use rrsw_vsn
   67.                     use mcica_subcol_gen_sw, only: mcica_subcol_sw
   68.                     use rrtmg_sw_cldprop, only: cldprop_sw
   69.                     use rrtmg_sw_cldprmc, only: cldprmc_sw
   70.               ! Move call to rrtmg_sw_ini and following use association to 
   71.               ! GCM initialization area
   72.               !      use rrtmg_sw_init, only: rrtmg_sw_ini
   73.                     use rrtmg_sw_setcoef, only: setcoef_sw
   74.                     use rrtmg_sw_spcvmc, only: spcvmc_sw
   75.                     use rrtmg_sw_spcvrt, only: spcvrt_sw
   76.               
   77.               !      use perf_mod
   78.               
   79.                     implicit none
   80.               
   81.               ! public interfaces/functions/subroutines
   82.               !      public :: rrtmg_sw, inatm_sw, earth_sun
   83.                     public :: rrtmg_sw
   84.               
   85.               !------------------------------------------------------------------
   86.                     contains
   87.               !------------------------------------------------------------------
   88.               
   89.               !------------------------------------------------------------------
   90.               ! Public subroutines
   91.               !------------------------------------------------------------------
   92.               !      subroutine rrtmg_sw &
   93.               !            ( ncol    ,nlay    ,icld    ,          &
   94.               !             play    ,plev    ,tlay    ,tlev    ,tsfc    , &
   95.               !             h2ovmr  ,o3vmr   ,co2vmr  ,ch4vmr  ,o2vmr   ,n2ovmr  , &
   96.               !             asdir   ,asdif   ,aldir   ,aldif   , &
   97.               !             coszen  ,adjes   ,dyofyr  ,solvar, &
   98.               !             inflgsw ,iceflgsw,liqflgsw, &
   99.               !             cldfmcl ,taucmcl ,ssacmcl ,asmcmcl ,fsfcmcl, &
  100.               !             ciwpmcl ,clwpmcl ,reicmcl ,relqmcl , &
  101.               !             tauaer  ,ssaaer  ,asmaer  , &
  102.               !             swuflx  ,swdflx  ,swhr    ,swuflxc ,swdflxc ,swhrc, &
  103.               !             dirdnuv, dirdnir, difdnuv, difdnir, &
  104.               !             dirdnuvc,difdnuvc,dirdnirc,difdnirc,ninflx, ninflxc, &
  105.               !             swuflxs, swdflxs)
  106.               
  107.                     subroutine rrtmg_sw( &
  108.                            imca    , & !                ! flag for mcica [0=off, 1=on]
  109.                            pcols   , & !integer, intent(in) :: pcols                      ! Total Number of horizontal columns 
  110.                            ncol    , & !integer, intent(in) :: ncol                       ! Number of horizontal columns     
  111.                            nlay    , & !integer, intent(in) :: nlay                       ! Number of model layers
  112.                            icld    , & !integer, intent(inout) :: icld                    ! Cloud overlap method
  113.                            play    , & !real(kind=r8), intent(in) :: play(pcols,nlay)            ! Layer pressures (hPa, mb)
  114.                            plev    , & !real(kind=r8), intent(in) :: plev (pcols,nlay+1)            ! Interface pressures (hPa, mb)
  115.                            tlay    , & !real(kind=r8), intent(in) :: tlay(pcols,nlay)            ! Layer temperatures (K)
  116.                            tlev    , & !real(kind=r8), intent(in) :: tlev (pcols,nlay+1)            ! Interface temperatures (K)
  117.                            tsfc    , & !real(kind=r8), intent(in) :: tsfc(pcols)              ! Surface temperature (K)
  118.                            h2ovmr  , & ! real(kind=r8), intent(in) :: h2ovmr(pcols,nlay)          ! H2O volume mixing ratio
  119.                            o3vmr   , & !real(kind=r8), intent(in) :: o3vmr(pcols,nlay)           ! O3 volume mixing ratio
  120.                            co2vmr  , & !real(kind=r8), intent(in) :: co2vmr(pcols,nlay)          ! CO2 volume mixing ratio
  121.                            ch4vmr  , & ! real(kind=r8), intent(in) :: ch4vmr(pcols,nlay)          ! Methane volume mixing ratio
  122.                            o2vmr   , & !real(kind=r8), intent(in) :: o2vmr(pcols,nlay)           ! O2 volume mixing ratio
  123.                            n2ovmr  , & !real(kind=r8), intent(in) :: n2ovmr(pcols,nlay)          ! Nitrous oxide volume mixing ratio
  124.                            asdir   , & !real(kind=r8), intent(in) :: asdir(pcols)             ! UV/vis surface albedo direct rad
  125.                            asdif   , & !real(kind=r8), intent(in) :: asdif(pcols)             ! UV/vis surface albedo: diffuse rad
  126.                            aldir   , & !real(kind=r8), intent(in) :: aldir(pcols)             ! Near-IR surface albedo direct rad
  127.                            aldif   , & !real(kind=r8), intent(in) :: aldif(pcols)             ! Near-IR surface albedo: diffuse rad
  128.                            coszen  , & !real(kind=r8), intent(in) :: coszen(pcols)            ! Cosine of solar zenith angle
  129.                            adjes   , & !real(kind=r8), intent(in) :: adjes                ! Flux adjustment for Earth/Sun distance
  130.                            dyofyr  , & ! integer, intent(in) :: dyofyr                     ! Day of the year (used to get Earth/Sun
  131.                            solvar  , & !real(kind=r8), intent(in) :: solvar(1:nbndsw)     ! Solar constant (Wm-2) scaling per band
  132.                            inflgsw , & !integer, intent(in) :: inflgsw                    ! Flag for cloud optical properties
  133.                            iceflgsw, & !integer, intent(in) :: iceflgsw                   ! Flag for ice particle specification
  134.                            liqflgsw, & !integer, intent(in) :: liqflgsw                   ! Flag for liquid droplet specification
  135.                            cldfmcl , & !real(kind=r8), intent(in) :: cldfmcl(ngptsw,pcols,nlay-1)       ! Cloud fraction
  136.                            taucmcl , & !real(kind=r8), intent(in) :: taucmcl(ngptsw,pcols,nlay-1)      ! Cloud optical depth
  137.                            ssacmcl , & !real(kind=r8), intent(in) :: ssacmcl(ngptsw,pcols,nlay-1)       ! Cloud single scattering albedo
  138.                            asmcmcl , & !real(kind=r8), intent(in) :: asmcmcl(ngptsw,pcols,nlay-1)       ! Cloud asymmetry parameter
  139.                            fsfcmcl , & !real(kind=r8), intent(in) :: fsfcmcl(ngptsw,pcols,nlay-1)       ! Cloud forward scattering parameter
  140.                            ciwpmcl , & !real(kind=r8), intent(in) :: ciwpmcl(ngptsw,pcols,nlay-1)      ! Cloud ice water path (g/m2)
  141.                            clwpmcl , & !real(kind=r8), intent(in) :: clwpmcl(ngptsw,pcols,nlay-1)      ! Cloud liquid water path (g/m2)
  142.                            cld                , &! Fractional cloud cover
  143.                            cicewp             , &! in-cloud cloud ice water path
  144.                            cliqwp             , &! in-cloud cloud liquid water path
  145.                            tauc_sw            , &! cloud optical depth  
  146.                            ssac_sw            , &! cloud single scat. albedo   
  147.                            asmc_sw           , &! cloud asymmetry parameter  
  148.                            fsfc_sw            , &! cloud forward scattering fraction
  149.               
  150.                            reicmcl , & !real(kind=r8), intent(in) :: reicmcl(pcols,nlay-1)         ! Cloud ice effective radius (microns)
  151.                            relqmcl , & !real(kind=r8), intent(in) :: relqmcl (pcols,nlay-1)         ! Cloud water drop effective radius (microns)
  152.                            tauaer  , & !real(kind=r8), intent(inout) :: tauaer(pcols,nlay-1,nbndsw)        ! Aerosol optical depth (iaer=10 only)
  153.                            ssaaer  , & !real(kind=r8), intent(inout) :: ssaaer(pcols,nlay-1,nbndsw)       ! Aerosol single scattering albedo (iaer=10 only)
  154.                            asmaer  , & !real(kind=r8), intent(inout) :: asmaer(pcols,nlay-1,nbndsw)        ! Aerosol asymmetry parameter (iaer=10 only)
  155.                            swuflx  , & !real(kind=r8), intent(out) :: swuflx(pcols,nlay+1)        ! Total sky shortwave upward flux (W/m2)
  156.                            swdflx  , & !real(kind=r8), intent(out) :: swdflx(pcols,nlay+1)        ! Total sky shortwave downward flux (W/m2)
  157.                            swhr    , & !real(kind=r8), intent(out) :: swhr (pcols,nlay)           ! Total sky shortwave radiative heating rate (K/d)
  158.                            swuflxc , & !real(kind=r8), intent(out) :: swuflxc(pcols,nlay+1)   ! Clear sky shortwave upward flux (W/m2)
  159.                            swdflxc , & !real(kind=r8), intent(out) :: swdflxc(pcols,nlay+1)        ! Clear sky shortwave downward flux (W/m2)
  160.                            swhrc   , & !real(kind=r8), intent(out) :: swhrc(pcols,nlay)          ! Clear sky shortwave radiative heating rate (K/d)
  161.                            dirdnuv , & !real(kind=r8), intent(out) :: dirdnuv(pcols,nlay+1)        ! Direct downward shortwave flux, UV/vis
  162.                            dirdnir , & !real(kind=r8), intent(out) :: dirdnir(pcols,nlay+1)        ! Direct downward shortwave flux, near-IR
  163.                            difdnuv , & !real(kind=r8), intent(out) :: difdnuv(pcols,nlay+1)        ! Diffuse downward shortwave flux, UV/vis
  164.                            difdnir , & !real(kind=r8), intent(out) :: difdnir(pcols,nlay+1)        ! Diffuse downward shortwave flux, near-IR
  165.                            dirdnuvc, & !real(kind=r8), intent(out) :: dirdnuvc(pcols,nlay+1)       ! Direct downward shortwave flux, UV/vis
  166.                            difdnuvc, & !real(kind=r8), intent(out) :: difdnuvc(pcols,nlay+1)       ! Diffuse downward shortwave flux, UV/vis
  167.                            dirdnirc, & !real(kind=r8), intent(out) :: dirdnirc(pcols,nlay+1)       ! Direct downward shortwave flux, near-IR
  168.                            difdnirc, & !real(kind=r8), intent(out) :: difdnirc(pcols,nlay+1)       ! Diffuse downward shortwave flux, near-IR
  169.                            ninflx  , & !real(kind=r8), intent(out) :: ninflx(pcols,nlay+1)         ! Net shortwave flux, near-IR
  170.                            ninflxc , & !real(kind=r8), intent(out) :: ninflxc(pcols,nlay+1)        ! Net clear sky shortwave flux, near-IR
  171.                            swuflxs , & !real(kind=r8), intent(out)  :: swuflxs(nbndsw,pcols,nlay+1)   ! shortwave spectral flux up
  172.                            swdflxs , & !real(kind=r8), intent(out)  :: swdflxs(nbndsw,pcols,nlay+1)   ! shortwave spectral flux down
  173.               !tar begin
  174.               ! Climate aerosol parameters of coarse mode (Kinne, 2013)
  175.                              ifaeros,aodsol,asysol,ssasol,z_aersol,topogsol, &
  176.               !tar end
  177.               !
  178.               !tar begin
  179.               ! Climate aerosol parameters of fine mode (Kinne, 2013)
  180.                               aodFsol,asyFsol,ssaFsol,z_aerFsol )
  181.               !tar end
  182.               
  183.               
  184.               
  185.               ! ------- Description -------
  186.               
  187.               ! This program is the driver for RRTMG_SW, the AER SW radiation model for 
  188.               !  application to GCMs, that has been adapted from RRTM_SW for improved
  189.               !  efficiency and to provide fractional cloudiness and cloud overlap
  190.               !  capability using McICA.
  191.               !
  192.               ! Note: The call to RRTMG_SW_INI should be moved to the GCM initialization 
  193.               !  area, since this has to be called only once. 
  194.               !
  195.               ! This routine
  196.               !    b) calls INATM_SW to read in the atmospheric profile;
  197.               !       all layering in RRTMG is ordered from surface to toa. 
  198.               !    c) calls CLDPRMC_SW to set cloud optical depth for McICA based
  199.               !       on input cloud properties
  200.               !    d) calls SETCOEF_SW to calculate various quantities needed for 
  201.               !       the radiative transfer algorithm
  202.               !    e) calls SPCVMC to call the two-stream model that in turn 
  203.               !       calls TAUMOL to calculate gaseous optical depths for each 
  204.               !       of the 16 spectral bands and to perform the radiative transfer
  205.               !       using McICA, the Monte-Carlo Independent Column Approximation,
  206.               !       to represent sub-grid scale cloud variability
  207.               !    f) passes the calculated fluxes and cooling rates back to GCM
  208.               !
  209.               ! Two modes of operation are possible:
  210.               !     The mode is chosen by using either rrtmg_sw.nomcica.f90 (to not use
  211.               !     McICA) or rrtmg_sw.f90 (to use McICA) to interface with a GCM.
  212.               !
  213.               !    1) Standard, single forward model calculation (imca = 0); this is 
  214.               !       valid only for clear sky or fully overcast clouds
  215.               !    2) Monte Carlo Independent Column Approximation (McICA, Pincus et al., 
  216.               !       JC, 2003) method is applied to the forward model calculation (imca = 1)
  217.               !       This method is valid for clear sky or partial cloud conditions.
  218.               !
  219.               ! This call to RRTMG_SW must be preceeded by a call to the module
  220.               !     mcica_subcol_gen_sw.f90 to run the McICA sub-column cloud generator,
  221.               !     which will provide the cloud physical or cloud optical properties
  222.               !     on the RRTMG quadrature point (ngptsw) dimension.
  223.               !
  224.               ! Two methods of cloud property input are possible:
  225.               !     Cloud properties can be input in one of two ways (controlled by input 
  226.               !     flags inflag, iceflag and liqflag; see text file rrtmg_sw_instructions
  227.               !     and subroutine rrtmg_sw_cldprop.f90 for further details):
  228.               !
  229.               !    1) Input cloud fraction, cloud optical depth, single scattering albedo 
  230.               !       and asymmetry parameter directly (inflgsw = 0)
  231.               !    2) Input cloud fraction and cloud physical properties: ice fracion,
  232.               !       ice and liquid particle sizes (inflgsw = 1 or 2);  
  233.               !       cloud optical properties are calculated by cldprop or cldprmc based
  234.               !       on input settings of iceflgsw and liqflgsw
  235.               !
  236.               ! Two methods of aerosol property input are possible:
  237.               !     Aerosol properties can be input in one of two ways (controlled by input 
  238.               !     flag iaer, see text file rrtmg_sw_instructions for further details):
  239.               !
  240.               !    1) Input aerosol optical depth, single scattering albedo and asymmetry
  241.               !       parameter directly by layer and spectral band (iaer=10)
  242.               !    2) Input aerosol optical depth and 0.55 micron directly by layer and use
  243.               !       one or more of six ECMWF aerosol types (iaer=6)
  244.               !
  245.               !
  246.               ! ------- Modifications -------
  247.               !
  248.               ! This version of RRTMG_SW has been modified from RRTM_SW to use a reduced
  249.               ! set of g-point intervals and a two-stream model for application to GCMs. 
  250.               !
  251.               !-- Original version (derived from RRTM_SW)
  252.               !     2002: AER. Inc.
  253.               !-- Conversion to F90 formatting; addition of 2-stream radiative transfer
  254.               !     Feb 2003: J.-J. Morcrette, ECMWF
  255.               !-- Additional modifications for GCM application
  256.               !     Aug 2003: M. J. Iacono, AER Inc.
  257.               !-- Total number of g-points reduced from 224 to 112.  Original
  258.               !   set of 224 can be restored by exchanging code in module parrrsw.f90 
  259.               !   and in file rrtmg_sw_init.f90.
  260.               !     Apr 2004: M. J. Iacono, AER, Inc.
  261.               !-- Modifications to include output for direct and diffuse 
  262.               !   downward fluxes.  There are output as "true" fluxes without
  263.               !   any delta scaling applied.  Code can be commented to exclude
  264.               !   this calculation in source file rrtmg_sw_spcvrt.f90.
  265.               !     Jan 2005: E. J. Mlawer, M. J. Iacono, AER, Inc.
  266.               !-- Revised to add McICA capability.
  267.               !     Nov 2005: M. J. Iacono, AER, Inc.
  268.               !-- Reformatted for consistency with rrtmg_lw.
  269.               !     Feb 2007: M. J. Iacono, AER, Inc.
  270.               !-- Modifications to formatting to use assumed-shape arrays. 
  271.               !     Aug 2007: M. J. Iacono, AER, Inc.
  272.               !-- Modified to output direct and diffuse fluxes either with or without
  273.               !   delta scaling based on setting of idelm flag
  274.               !     Dec 2008: M. J. Iacono, AER, Inc.
  275.               
  276.               ! --------- Modules ---------
  277.               
  278.                     use parrrsw, only : nbndsw, ngptsw, naerec, nstr, nmol, mxmol, &
  279.                                         jpband, jpb1, jpb2
  280.                     use rrsw_aer, only : rsrtaua, rsrpiza, rsrasya
  281.                     use rrsw_con, only : heatfac, oneminus, pi
  282.                     use rrsw_wvn, only : wavenum1, wavenum2
  283.               
  284.               ! ------- Declarations
  285.               
  286.               ! ----- Input -----
  287.                     integer, intent(in) :: imca                       !                ! flag for mcica [0=off, 1=on]
  288.                     integer, intent(in) :: pcols                      ! Total Number of horizontal columns     
  289.                     integer, intent(in) :: ncol                       ! Number of horizontal columns     
  290.                     integer, intent(in) :: nlay                       ! Number of model layers
  291.                     integer, intent(inout) :: icld                    ! Cloud overlap method
  292.                                                                       !    0: Clear only
  293.                                                                       !    1: Random
  294.                                                                       !    2: Maximum/random
  295.                                                                       !    3: Maximum
  296.                     real(kind=r8), intent(in) :: play(pcols,nlay)            ! Layer pressures (hPa, mb)
  297.                                                                       !    Dimensions: (ncol,nlay)
  298.                     real(kind=r8), intent(in) :: plev (pcols,nlay+1)            ! Interface pressures (hPa, mb)
  299.                                                                       !    Dimensions: (ncol,nlay+1)
  300.                     real(kind=r8), intent(in) :: tlay(pcols,nlay)            ! Layer temperatures (K)
  301.                                                                       !    Dimensions: (ncol,nlay)
  302.                     real(kind=r8), intent(in) :: tlev (pcols,nlay+1)            ! Interface temperatures (K)
  303.                                                                       !    Dimensions: (ncol,nlay+1)
  304.                     real(kind=r8), intent(in) :: tsfc(pcols)              ! Surface temperature (K)
  305.                                                                       !    Dimensions: (ncol)
  306.                     real(kind=r8), intent(in) :: h2ovmr(pcols,nlay)          ! H2O volume mixing ratio
  307.                                                                       !    Dimensions: (ncol,nlay)
  308.                     real(kind=r8), intent(in) :: o3vmr(pcols,nlay)           ! O3 volume mixing ratio
  309.                                                                       !    Dimensions: (ncol,nlay)
  310.                     real(kind=r8), intent(in) :: co2vmr(pcols,nlay)          ! CO2 volume mixing ratio
  311.                                                                       !    Dimensions: (ncol,nlay)
  312.                     real(kind=r8), intent(in) :: ch4vmr(pcols,nlay)          ! Methane volume mixing ratio
  313.                                                                       !    Dimensions: (ncol,nlay)
  314.                     real(kind=r8), intent(in) :: o2vmr(pcols,nlay)           ! O2 volume mixing ratio
  315.                                                                       !    Dimensions: (ncol,nlay)
  316.                     real(kind=r8), intent(in) :: n2ovmr(pcols,nlay)          ! Nitrous oxide volume mixing ratio
  317.                                                                       !    Dimensions: (ncol,nlay)
  318.                     real(kind=r8), intent(in) :: asdir(pcols)             ! UV/vis surface albedo direct rad
  319.                                                                       !    Dimensions: (ncol)
  320.                     real(kind=r8), intent(in) :: aldir(pcols)             ! Near-IR surface albedo direct rad
  321.                                                                       !    Dimensions: (ncol)
  322.                     real(kind=r8), intent(in) :: asdif(pcols)             ! UV/vis surface albedo: diffuse rad
  323.                                                                       !    Dimensions: (ncol)
  324.                     real(kind=r8), intent(in) :: aldif(pcols)             ! Near-IR surface albedo: diffuse rad
  325.                                                                       !    Dimensions: (ncol)
  326.               
  327.                     integer      , intent(in) :: dyofyr                     ! Day of the year (used to get Earth/Sun
  328.                                                                       !  distance if adjflx not provided)
  329.                     real(kind=r8), intent(in) :: adjes                ! Flux adjustment for Earth/Sun distance
  330.                     real(kind=r8), intent(in) :: coszen(pcols)            ! Cosine of solar zenith angle
  331.                                                                       !    Dimensions: (ncol)
  332.                     real(kind=r8), intent(in) :: solvar(1:nbndsw)     ! Solar constant (Wm-2) scaling per band
  333.               
  334.                     integer, intent(in) :: inflgsw                    ! Flag for cloud optical properties
  335.                     integer, intent(in) :: iceflgsw                   ! Flag for ice particle specification
  336.                     integer, intent(in) :: liqflgsw                   ! Flag for liquid droplet specification
  337.               
  338.                     real(kind=r8), intent(in) :: cldfmcl(ngptsw,pcols,nlay-1)       ! Cloud fraction
  339.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  340.                     real(kind=r8), intent(in) :: taucmcl(ngptsw,pcols,nlay-1)      ! Cloud optical depth
  341.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  342.                     real(kind=r8), intent(in) :: ssacmcl(ngptsw,pcols,nlay-1)       ! Cloud single scattering albedo
  343.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  344.                     real(kind=r8), intent(in) :: asmcmcl(ngptsw,pcols,nlay-1)       ! Cloud asymmetry parameter
  345.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  346.                     real(kind=r8), intent(in) :: fsfcmcl(ngptsw,pcols,nlay-1)       ! Cloud forward scattering parameter
  347.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  348.                     real(kind=r8), intent(in) :: ciwpmcl(ngptsw,pcols,nlay-1)      ! Cloud ice water path (g/m2)
  349.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  350.                     real(kind=r8), intent(in) :: clwpmcl(ngptsw,pcols,nlay-1)      ! Cloud liquid water path (g/m2)
  351.                                                                       !    Dimensions: (ngptsw,ncol,nlay)
  352.               
  353.                     real(kind=r8), intent(in) :: cld     (1:pcols,1:nlay-1)       ! Fractional cloud cover
  354.                     real(kind=r8), intent(in) :: cicewp  (1:pcols,1:nlay-1)       ! in-cloud cloud ice water path
  355.                     real(kind=r8), intent(in) :: cliqwp  (1:pcols,1:nlay-1)       ! in-cloud cloud liquid water path
  356.                     real(kind=r8), intent(in) :: tauc_sw (1:nbndsw,1:pcols,1:nlay-1) ! cloud optical depth  
  357.                     real(kind=r8), intent(in) :: ssac_sw (1:nbndsw,1:pcols,1:nlay-1) ! cloud single scat. albedo   
  358.                     real(kind=r8), intent(in) :: asmc_sw (1:nbndsw,1:pcols,1:nlay-1) ! cloud asymmetry parameter  
  359.                     real(kind=r8), intent(in) :: fsfc_sw (1:nbndsw,1:pcols,1:nlay-1) ! cloud forward scattering fraction
  360.               
  361.                     real(kind=r8), intent(in) :: reicmcl(pcols,nlay-1)         ! Cloud ice effective radius (microns)
  362.                                                                       !    Dimensions: (ncol,nlay)
  363.                     real(kind=r8), intent(in) :: relqmcl (pcols,nlay-1)         ! Cloud water drop effective radius (microns)
  364.                                                                       !    Dimensions: (ncol,nlay)
  365.                     real(kind=r8), intent(inout) :: tauaer(pcols,nlay-1,nbndsw)        ! Aerosol optical depth (iaer=10 only)
  366.                                                                       !    Dimensions: (ncol,nlay,nbndsw)
  367.                                                                       ! (non-delta scaled)      
  368.                     real(kind=r8), intent(inout) :: ssaaer(pcols,nlay-1,nbndsw)       ! Aerosol single scattering albedo (iaer=10 only)
  369.                                                                       !    Dimensions: (ncol,nlay,nbndsw)
  370.                                                                       ! (non-delta scaled)      
  371.                     real(kind=r8), intent(inout) :: asmaer(pcols,nlay-1,nbndsw)        ! Aerosol asymmetry parameter (iaer=10 only)
  372.                                                                       !    Dimensions: (ncol,nlay,nbndsw)
  373.                                                                       ! (non-delta scaled)      
  374.                     real(kind=r8) :: ecaer(ncol,nlay,naerec)        ! Aerosol optical depth at 0.55 micron (iaer=6 only)
  375.                                                                       !    Dimensions: (ncol,nlay,naerec)
  376.                                                                       ! (non-delta scaled)      
  377.               !tar begin
  378.               ! input aerosol parameters
  379.               !
  380.                   INTEGER,    INTENT(in   ) :: ifaeros
  381.                   REAL(KIND=r8),    INTENT(in   )  :: aodsol(pcols,14) 
  382.                   REAL(KIND=r8),    INTENT(in   )  :: asysol(pcols,14)
  383.                   REAL(KIND=r8),    INTENT(in   )  :: ssasol(pcols,14)
  384.                   REAL(KIND=r8),    INTENT(in   )  :: z_aersol(pcols,40)       
  385.                   REAL(KIND=r8),    INTENT(in   )  :: topogsol (pcols)   
  386.                   REAL(KIND=r8),    INTENT(in   )  :: aodFsol(pcols,14) 
  387.                   REAL(KIND=r8),    INTENT(in   )  :: asyFsol(pcols,14)
  388.                   REAL(KIND=r8),    INTENT(in   )  :: ssaFsol(pcols,14)
  389.                   REAL(KIND=r8),    INTENT(in   )  :: z_aerFsol(pcols,40) 
  390.               !    
  391.               !tar end  
  392.               ! ----- Output -----
  393.               
  394.                     real(kind=r8), intent(inout) :: swuflx(pcols,nlay+1)        ! Total sky shortwave upward flux (W/m2)
  395.                                                                                     !    Dimensions: (ncol,nlay+1)
  396.                     real(kind=r8), intent(inout) :: swdflx(pcols,nlay+1)        ! Total sky shortwave downward flux (W/m2)
  397.                                                                                     !    Dimensions: (ncol,nlay+1)
  398.                     real(kind=r8), intent(inout) :: swhr (pcols,nlay)           ! Total sky shortwave radiative heating rate (K/d)
  399.                                                                                     !    Dimensions: (ncol,nlay)
  400.                     real(kind=r8), intent(inout) :: swuflxc(pcols,nlay+1)       ! Clear sky shortwave upward flux (W/m2)
  401.                                                                                     !    Dimensions: (ncol,nlay+1)
  402.                     real(kind=r8), intent(inout) :: swdflxc(pcols,nlay+1)       ! Clear sky shortwave downward flux (W/m2)
  403.                                                                                     !    Dimensions: (ncol,nlay+1)
  404.                     real(kind=r8), intent(inout) :: swhrc(pcols,nlay)          ! Clear sky shortwave radiative heating rate (K/d)
  405.                                                                       !    Dimensions: (ncol,nlay)
  406.               
  407.                     real(kind=r8), intent(inout) :: dirdnuv(pcols,nlay+1)        ! Direct downward shortwave flux, UV/vis
  408.                     real(kind=r8), intent(inout) :: difdnuv(pcols,nlay+1)        ! Diffuse downward shortwave flux, UV/vis
  409.                     real(kind=r8), intent(inout) :: dirdnir(pcols,nlay+1)        ! Direct downward shortwave flux, near-IR
  410.                     real(kind=r8), intent(inout) :: difdnir(pcols,nlay+1)        ! Diffuse downward shortwave flux, near-IR
  411.               
  412.                     real(kind=r8), intent(inout) :: dirdnuvc(pcols,nlay+1)        ! Direct downward shortwave flux, UV/vis
  413.                     real(kind=r8), intent(inout) :: difdnuvc(pcols,nlay+1)        ! Diffuse downward shortwave flux, UV/vis
  414.                     real(kind=r8), intent(inout) :: dirdnirc(pcols,nlay+1)        ! Direct downward shortwave flux, near-IR
  415.                     real(kind=r8), intent(inout) :: difdnirc(pcols,nlay+1)        ! Diffuse downward shortwave flux, near-IR
  416.               
  417.                     real(kind=r8), intent(inout) :: ninflx(pcols,nlay+1)         ! Net shortwave flux, near-IR
  418.                     real(kind=r8), intent(inout) :: ninflxc(pcols,nlay+1)        ! Net clear sky shortwave flux, near-IR
  419.               
  420.                     real(kind=r8), intent(inout) :: swuflxs(nbndsw,pcols,nlay+1)   ! shortwave spectral flux up
  421.                     real(kind=r8), intent(inout) :: swdflxs(nbndsw,pcols,nlay+1)   ! shortwave spectral flux down
  422.               
  423.               ! ----- Output -----
  424.               
  425.                     real(kind=r8) :: swuflx_local(pcols,nlay+1)         ! Total sky shortwave upward flux (W/m2)
  426.                                                                           !    Dimensions: (ncol,nlay+1)
  427.                     real(kind=r8) :: swdflx_local(pcols,nlay+1)         ! Total sky shortwave downward flux (W/m2)
  428.                                                                           !    Dimensions: (ncol,nlay+1)
  429.                     real(kind=r8) :: swhr_local (pcols,nlay)           ! Total sky shortwave radiative heating rate (K/d)
  430.                                                                           !    Dimensions: (ncol,nlay)
  431.                     real(kind=r8) :: swuflxc_local(pcols,nlay+1)         ! Clear sky shortwave upward flux (W/m2)
  432.                                                                           !    Dimensions: (ncol,nlay+1)
  433.                     real(kind=r8) :: swdflxc_local(pcols,nlay+1)         ! Clear sky shortwave downward flux (W/m2)
  434.                                                                           !    Dimensions: (ncol,nlay+1)
  435.                     real(kind=r8) :: swhrc_local(pcols,nlay)          ! Clear sky shortwave radiative heating rate (K/d)
  436.                                                             !        Dimensions: (ncol,nlay)
  437.               
  438.                     real(kind=r8) :: dirdnuv_local(pcols,nlay+1)          ! Direct downward shortwave flux, UV/vis
  439.                     real(kind=r8) :: difdnuv_local(pcols,nlay+1)          ! Diffuse downward shortwave flux, UV/vis
  440.                     real(kind=r8) :: dirdnir_local(pcols,nlay+1)          ! Direct downward shortwave flux, near-IR
  441.                     real(kind=r8) :: difdnir_local(pcols,nlay+1)          ! Diffuse downward shortwave flux, near-IR
  442.               
  443.                     real(kind=r8) :: dirdnuvc_local(pcols,nlay+1)           ! Direct downward shortwave flux, UV/vis
  444.                     real(kind=r8) :: difdnuvc_local(pcols,nlay+1)           ! Diffuse downward shortwave flux, UV/vis
  445.                     real(kind=r8) :: dirdnirc_local(pcols,nlay+1)           ! Direct downward shortwave flux, near-IR
  446.                     real(kind=r8) :: difdnirc_local(pcols,nlay+1)           ! Diffuse downward shortwave flux, near-IR
  447.               
  448.                     real(kind=r8) :: ninflx_local(pcols,nlay+1)          ! Net shortwave flux, near-IR
  449.                     real(kind=r8) :: ninflxc_local(pcols,nlay+1)          ! Net clear sky shortwave flux, near-IR
  450.               
  451.                     real(kind=r8)  :: swuflxs_local(nbndsw,pcols,nlay+1)   ! shortwave spectral flux up
  452.                     real(kind=r8)  :: swdflxs_local(nbndsw,pcols,nlay+1)   ! shortwave spectral flux down
  453.               
  454.               ! ----- Local -----
  455.               
  456.               ! Control
  457.                     integer :: istart                         ! beginning band of calculation
  458.                     integer :: iend                           ! ending band of calculation
  459.                     integer :: icpr                           ! cldprop/cldprmc use flag
  460.                     integer :: iout = 0                       ! output option flag (inactive)
  461.                     integer :: iaer                           ! aerosol option flag
  462.                     integer :: idelm                          ! delta-m scaling flag
  463.                                                               ! [0 = direct and diffuse fluxes are unscaled]
  464.                                                               ! [1 = direct and diffuse fluxes are scaled]
  465.                                                               ! (total downward fluxes are always delta scaled)
  466.                     integer :: isccos                         ! instrumental cosine response flag (inactive)
  467.                     integer :: iplon                          ! column loop index
  468.                     integer :: i                              ! layer loop index                       ! jk
  469.                     integer :: ib                             ! band loop index                        ! jsw
  470.                     integer :: ia, ig                         ! indices
  471.                     integer :: k                              ! layer loop index
  472.                     integer :: ims                            ! value for changing mcica permute seed
  473.               
  474.                     real(kind=r8) :: zepsec, zepzen           ! epsilon
  475.                     real(kind=r8) :: zdpgcp                   ! flux to heating conversion ratio
  476.               
  477.               ! Atmosphere
  478.                     real(kind=r8) :: pavel(nlay)            ! layer pressures (mb) 
  479.                     real(kind=r8) :: tavel(nlay)            ! layer temperatures (K)
  480.                     real(kind=r8) :: pz(0:nlay)             ! level (interface) pressures (hPa, mb)
  481.                     real(kind=r8) :: tz(0:nlay)             ! level (interface) temperatures (K)
  482.                     real(kind=r8) :: tbound                   ! surface temperature (K)
  483.                     real(kind=r8) :: pdp(nlay)              ! layer pressure thickness (hPa, mb)
  484.                     real(kind=r8) :: coldry (nlay)           ! dry air column amount
  485.                     real(kind=r8) :: wkl    (mxmol,nlay)        ! molecular amounts (mol/cm-2)
  486.               
  487.               !      real(kind=r8) :: earth_sun               ! function for Earth/Sun distance factor
  488.                     real(kind=r8) :: cossza                   ! Cosine of solar zenith angle
  489.                     real(kind=r8) :: adjflux(jpband)          ! adjustment for current Earth/Sun distance
  490.               !      real(kind=r8) :: solvar(jpband)           ! solar constant scaling factor from rrtmg_sw
  491.                                                               !  default value of 1368.22 Wm-2 at 1 AU
  492.                     real(kind=r8) :: albdir(nbndsw)           ! surface albedo, direct          ! zalbp
  493.                     real(kind=r8) :: albdif(nbndsw)           ! surface albedo, diffuse         ! zalbd
  494.               
  495.                     real(kind=r8) :: taua(nlay,nbndsw)      ! Aerosol optical depth
  496.                     real(kind=r8) :: ssaa(nlay,nbndsw)      ! Aerosol single scattering albedo
  497.                     real(kind=r8) :: asma(nlay,nbndsw)      ! Aerosol asymmetry parameter
  498.               
  499.               ! Atmosphere - setcoef
  500.                     integer :: laytrop                        ! tropopause layer index
  501.                     integer :: layswtch                       ! 
  502.                     integer :: laylow                         ! 
  503.                     integer :: jp(nlay)                     ! 
  504.                     integer :: jt(nlay)                     !
  505.                     integer :: jt1(nlay)                    !
  506.               
  507.                     real(kind=r8) :: colh2o(nlay)           ! column amount (h2o)
  508.                     real(kind=r8) :: colco2(nlay)           ! column amount (co2)
  509.                     real(kind=r8) :: colo3(nlay)            ! column amount (o3)
  510.                     real(kind=r8) :: coln2o(nlay)           ! column amount (n2o)
  511.                     real(kind=r8) :: colch4(nlay)           ! column amount (ch4)
  512.                     real(kind=r8) :: colo2(nlay)            ! column amount (o2)
  513.                     real(kind=r8) :: colmol(nlay)           ! column amount
  514.                     real(kind=r8) :: co2mult(nlay)          ! column amount 
  515.               
  516.                     integer :: indself(nlay)
  517.                     integer :: indfor(nlay)
  518.                     real(kind=r8) :: selffac(nlay)
  519.                     real(kind=r8) :: selffrac(nlay)
  520.                     real(kind=r8) :: forfac(nlay)
  521.                     real(kind=r8) :: forfrac(nlay)
  522.                     real(kind=r8) :: cldfrac(nlay)         ! layer cloud fraction
  523.               
  524.                     real(kind=r8) :: &                        !
  525.                                        fac00(nlay), fac01(nlay), &
  526.                                        fac10(nlay), fac11(nlay) 
  527.               
  528.               ! Atmosphere/clouds - cldprop
  529.                     integer :: ncbands                        ! number of cloud spectral bands
  530.                     integer :: inflag                         ! flag for cloud property method
  531.                     integer :: iceflag                        ! flag for ice cloud properties
  532.                     integer :: liqflag                        ! flag for liquid cloud properties
  533.               
  534.               !      real(kind=r8) :: cldfrac(nlay)            ! layer cloud fraction
  535.               !      real(kind=r8) :: tauc(nlay)               ! cloud optical depth (non-delta scaled)
  536.               !      real(kind=r8) :: ssac(nlay)               ! cloud single scattering albedo (non-delta scaled)
  537.               !      real(kind=r8) :: asmc(nlay)               ! cloud asymmetry parameter (non-delta scaled)
  538.               !      real(kind=r8) :: ciwp(nlay)               ! cloud ice water path
  539.               !      real(kind=r8) :: clwp(nlay)               ! cloud liquid water path
  540.               !      real(kind=r8) :: rei(nlay)                ! cloud ice particle size
  541.               !      real(kind=r8) :: rel(nlay)                ! cloud liquid particle size
  542.               
  543.                     real(kind=r8) :: taucloud  (nlay,jpband)    ! cloud optical depth
  544.                     real(kind=r8) :: taucldorig(nlay,jpband)  ! cloud optical depth (non-delta scaled)
  545.                     real(kind=r8) :: ssacloud  (nlay,jpband)    ! cloud single scattering albedo
  546.                     real(kind=r8) :: asmcloud  (nlay,jpband)    ! cloud asymmetry parameter
  547.               
  548.               ! Atmosphere/clouds - cldprmc [mcica]
  549.                     real(kind=r8) :: cldfmc(ngptsw,nlay)    ! cloud fraction [mcica]
  550.                     real(kind=r8) :: ciwpmc(ngptsw,nlay)    ! cloud ice water path [mcica]
  551.                     real(kind=r8) :: clwpmc(ngptsw,nlay)    ! cloud liquid water path [mcica]
  552.                     real(kind=r8) :: relqmc(nlay)           ! liquid particle size (microns)
  553.                     real(kind=r8) :: reicmc(nlay)           ! ice particle effective radius (microns)
  554.                     real(kind=r8) :: dgesmc(nlay)           ! ice particle generalized effective size (microns)
  555.                     real(kind=r8) :: taucmc(ngptsw,nlay)    ! cloud optical depth [mcica]
  556.                     real(kind=r8) :: taormc(ngptsw,nlay)    ! unscaled cloud optical depth [mcica]
  557.                     real(kind=r8) :: ssacmc(ngptsw,nlay)    ! cloud single scattering albedo [mcica]
  558.                     real(kind=r8) :: asmcmc(ngptsw,nlay)    ! cloud asymmetry parameter [mcica]
  559.                     real(kind=r8) :: fsfcmc(ngptsw,nlay)    ! cloud forward scattering fraction [mcica]
  560.               
  561.               ! Atmosphere/clouds/aerosol - spcvrt,spcvmc
  562.                     real(kind=r8) :: ztauc(nlay,nbndsw)     ! cloud optical depth
  563.                     real(kind=r8) :: ztaucorig(nlay,nbndsw) ! unscaled cloud optical depth
  564.                     real(kind=r8) :: zasyc(nlay,nbndsw)     ! cloud asymmetry parameter 
  565.                                                               !  (first moment of phase function)
  566.                     real(kind=r8) :: zomgc(nlay,nbndsw)     ! cloud single scattering albedo
  567.                     real(kind=r8) :: ztaua(nlay,nbndsw)     ! total aerosol optical depth
  568.                     real(kind=r8) :: zasya(nlay,nbndsw)     ! total aerosol asymmetry parameter 
  569.                     real(kind=r8) :: zomga(nlay,nbndsw)     ! total aerosol single scattering albedo
  570.               
  571.                     real(kind=r8) :: zcldfmc(nlay,ngptsw)   ! cloud fraction [mcica]
  572.                     real(kind=r8) :: ztaucmc(nlay,ngptsw)   ! cloud optical depth [mcica]
  573.                     real(kind=r8) :: ztaormc(nlay,ngptsw)   ! unscaled cloud optical depth [mcica]
  574.                     real(kind=r8) :: zasycmc(nlay,ngptsw)   ! cloud asymmetry parameter [mcica] 
  575.                     real(kind=r8) :: zomgcmc(nlay,ngptsw)   ! cloud single scattering albedo [mcica]
  576.               
  577.                     real(kind=r8) :: zbbfu(nlay+2)          ! temporary upward shortwave flux (w/m2)
  578.                     real(kind=r8) :: zbbfd(nlay+2)          ! temporary downward shortwave flux (w/m2)
  579.                     real(kind=r8) :: zbbcu(nlay+2)          ! temporary clear sky upward shortwave flux (w/m2)
  580.                     real(kind=r8) :: zbbcd(nlay+2)          ! temporary clear sky downward shortwave flux (w/m2)
  581.                     real(kind=r8) :: zbbfddir(nlay+2)       ! temporary downward direct shortwave flux (w/m2)
  582.                     real(kind=r8) :: zbbcddir(nlay+2)       ! temporary clear sky downward direct shortwave flux (w/m2)
  583.                     real(kind=r8) :: zuvfd(nlay+2)          ! temporary UV downward shortwave flux (w/m2)
  584.                     real(kind=r8) :: zuvcd(nlay+2)          ! temporary clear sky UV downward shortwave flux (w/m2)
  585.                     real(kind=r8) :: zuvfddir(nlay+2)       ! temporary UV downward direct shortwave flux (w/m2)
  586.                     real(kind=r8) :: zuvcddir(nlay+2)       ! temporary clear sky UV downward direct shortwave flux (w/m2)
  587.                     real(kind=r8) :: znifd(nlay+2)          ! temporary near-IR downward shortwave flux (w/m2)
  588.                     real(kind=r8) :: znicd(nlay+2)          ! temporary clear sky near-IR downward shortwave flux (w/m2)
  589.                     real(kind=r8) :: znifddir(nlay+2)       ! temporary near-IR downward direct shortwave flux (w/m2)
  590.                     real(kind=r8) :: znicddir(nlay+2)       ! temporary clear sky near-IR downward direct shortwave flux (w/m2)
  591.               ! Added for near-IR flux diagnostic
  592.                     real(kind=r8) :: znifu(nlay+2)          ! temporary near-IR downward shortwave flux (w/m2)
  593.                     real(kind=r8) :: znicu(nlay+2)          ! temporary clear sky near-IR downward shortwave flux (w/m2)
  594.               
  595.               ! Optional output fields 
  596.                     real(kind=r8) :: swnflx(nlay+2)         ! Total sky shortwave net flux (W/m2)
  597.                     real(kind=r8) :: swnflxc(nlay+2)        ! Clear sky shortwave net flux (W/m2)
  598.                     real(kind=r8) :: dirdflux(nlay+2)       ! Direct downward shortwave surface flux
  599.                     real(kind=r8) :: difdflux(nlay+2)       ! Diffuse downward shortwave surface flux
  600.                     real(kind=r8) :: uvdflx(nlay+2)         ! Total sky downward shortwave flux, UV/vis   
  601.                     real(kind=r8) :: nidflx(nlay+2)         ! Total sky downward shortwave flux, near-IR  
  602.                     real(kind=r8) :: zbbfsu(nbndsw,nlay+2)  ! temporary upward shortwave flux spectral (w/m2)
  603.                     real(kind=r8) :: zbbfsd(nbndsw,nlay+2)  ! temporary downward shortwave flux spectral (w/m2)
  604.               
  605.               ! Output - inactive
  606.               !      real(kind=r8) :: zuvfu(nlay+2)         ! temporary upward UV shortwave flux (w/m2)
  607.               !      real(kind=r8) :: zuvfd(nlay+2)         ! temporary downward UV shortwave flux (w/m2)
  608.               !      real(kind=r8) :: zuvcu(nlay+2)         ! temporary clear sky upward UV shortwave flux (w/m2)
  609.               !      real(kind=r8) :: zuvcd(nlay+2)         ! temporary clear sky downward UV shortwave flux (w/m2)
  610.               !      real(kind=r8) :: zvsfu(nlay+2)         ! temporary upward visible shortwave flux (w/m2)
  611.               !      real(kind=r8) :: zvsfd(nlay+2)         ! temporary downward visible shortwave flux (w/m2)
  612.               !      real(kind=r8) :: zvscu(nlay+2)         ! temporary clear sky upward visible shortwave flux (w/m2)
  613.               !      real(kind=r8) :: zvscd(nlay+2)         ! temporary clear sky downward visible shortwave flux (w/m2)
  614.               !      real(kind=r8) :: znifu(nlay+2)         ! temporary upward near-IR shortwave flux (w/m2)
  615.               !      real(kind=r8) :: znifd(nlay+2)         ! temporary downward near-IR shortwave flux (w/m2)
  616.               !      real(kind=r8) :: znicu(nlay+2)         ! temporary clear sky upward near-IR shortwave flux (w/m2)
  617.               !      real(kind=r8) :: znicd(nlay+2)         ! temporary clear sky downward near-IR shortwave flux (w/m2)
  618.               
  619.               
  620.               !tar begin
  621.               ! Climate aerosol parameters
  622.                   REAL(KIND=r8), DIMENSION(ncol,nlay,14)  :: taual,ssaal,asyal
  623.               !
  624.               !Fine mode
  625.                   REAL(KIND=r8), DIMENSION(ncol,nlay,14)  :: taualF,ssaalF,asyalF
  626.               !Coarse mode    
  627.                   REAL(KIND=r8), DIMENSION(ncol,nlay,14)  :: taualC,ssaalC,asyalC    
  628.               !
  629.               ! Aerosol local variables 
  630.                   REAL(KIND=r8) :: pr(nlay+1)     !levels pressure from surface in Pa
  631.                   REAL(KIND=r8) :: tmp(nlay)       ! layer temperature from surface in K
  632.                   REAL(KIND=r8) :: tpg          !grid topography
  633.                   REAL(KIND=r8) :: zlv(nlay+1)   !level height from surface   (m) 
  634.                   REAL(KIND=r8) :: dz(nlay)       ! layer depth from surface  (m)
  635.               !    REAL(KIND=r8) :: dzint(ncol,nlay)       ! layer depth from surface  (m)
  636.                   INTEGER :: j
  637.                   REAL(KIND=r8) :: ep(40),f(42),ha(41)  ! extinction in CA layers of coarse mode
  638.                   REAL(KIND=r8) :: fp(nlay)      !extinction in model layers from surface of coarse mode
  639.                   REAL(KIND=r8) :: od_n(nlay)    ! AOD in model layers from surface  of coarse mode           
  640.                   REAL(KIND=r8) :: aod_norm(ncol,nlay) ! extinction in model layers from top  of coarse mode     
  641.                   REAL(KIND=r8) :: epF(40),fF(42),haF(41)  ! extinction in CA layers of fine mode
  642.                   REAL(KIND=r8) :: fpF(nlay)      !extinction in model layers from surface of fine mode
  643.                   REAL(KIND=r8) :: od_nF(nlay)    ! AOD in model layers from surface of fine mode           
  644.                   REAL(KIND=r8) :: aod_normF(ncol,nlay) ! extinction in model layers from top of fine mode 
  645.                     
  646.               !tar end 
  647.               
  648.               ! Initializations
  649.  V---------<>        swuflx_local=0.0_r8;     swdflx_local=0.0_r8;     swhr_local =0.0_r8;      swuflxc_local=0.0_r8;    
  650.  V---------<>        swdflxc_local=0.0_r8;    swhrc_local=0.0_r8;      dirdnuv_local=0.0_r8;    difdnuv_local=0.0_r8;   
  651.  V---------<>        dirdnir_local=0.0_r8;    difdnir_local=0.0_r8;    
  652.  V---------<>        dirdnuvc_local=0.0_r8;   difdnuvc_local=0.0_r8;   dirdnirc_local=0.0_r8;   difdnirc_local=0.0_r8;   
  653.  V---------<>        ninflx_local=0.0_r8;     ninflxc_local=0.0_r8;    swuflxs_local=0.0_r8;    swdflxs_local=0.0_r8;    
  654.               
  655.  V---------<>        indself=0
  656.  V---------<>        indfor=0
  657.  V---------<>        pavel=0.0_r8;tavel=0.0_r8;pz=0.0_r8;tz=0.0_r8
  658.  V---------<>        pdp=0.0_r8;coldry=0.0_r8;wkl=0.0_r8;adjflux=0.0_r8;albdir=0.0_r8;albdif=0.0_r8;
  659.  V---------<>        taua=0.0_r8;ssaa=0.0_r8;asma=0.0_r8;colh2o=0.0_r8;colco2=0.0_r8;colo3=0.0_r8;coln2o=0.0_r8;
  660.  V---------<>        colch4=0.0_r8;colo2=0.0_r8;colmol=0.0_r8;co2mult=0.0_r8;
  661.               
  662.  V---------<>        selffac=0.0_r8;selffrac=0.0_r8;forfac=0.0_r8;forfrac=0.0_r8;
  663.               
  664.               
  665.  V---------<>        fac00=0.0_r8;fac01=0.0_r8;fac10=0.0_r8;fac11=0.0_r8;
  666.               
  667.               
  668.  V---------<>        cldfmc=0.0_r8;ciwpmc=0.0_r8;clwpmc=0.0_r8;relqmc=0.0_r8;reicmc=0.0_r8;dgesmc=0.0_r8;taucmc=0.0_r8;
  669.  V---------<>        taormc=0.0_r8;ssacmc=0.0_r8;asmcmc=0.0_r8;fsfcmc=0.0_r8;
  670.  V---------<>        taucldorig=0.0_r8;taucloud  =0.0_r8;
  671.  V---------<>        ssacloud  =0.0_r8;asmcloud  =0.0_r8;cldfrac=0.0_r8
  672.               ! Atmosphere/clouds/aerosol - spcvrt,spcvmc
  673.  V---------<>        ztauc=0.0_r8;ztaucorig=0.0_r8;zasyc=0.0_r8;
  674.                                           
  675.  V---------<>        zomgc=0.0_r8;ztaua=0.0_r8;zasya=0.0_r8;zomga=0.0_r8;
  676.               
  677.  V---------<>        zcldfmc=0.0_r8;ztaucmc=0.0_r8;ztaormc=0.0_r8;zasycmc=0.0_r8;zomgcmc=0.0_r8;zbbfu=0.0_r8;zbbfd=0.0_r8;
  678.  V---------<>        zbbcu=0.0_r8;zbbcd=0.0_r8;zbbfddir=0.0_r8;zbbcddir=0.0_r8;zuvfd=0.0_r8;zuvcd=0.0_r8;
  679.  V---------<>        zuvfddir=0.0_r8;zuvcddir=0.0_r8;znifd=0.0_r8;znicd=0.0_r8;znifddir=0.0_r8;znicddir=0.0_r8;
  680.               ! Added for near-IR flux diagnostic
  681.  V---------<>        znifu=0.0_r8;
  682.  V---------<>        znicu=0.0_r8;
  683.               
  684.               ! Optional output fields 
  685.  V---------<>        swnflx=0.0_r8;    
  686.  V---------<>        swnflxc=0.0_r8;   
  687.                      dirdflux=0.0_r8;  
  688.                      difdflux=0.0_r8;  
  689.                      uvdflx=0.0_r8;    
  690.                      nidflx=0.0_r8;    
  691.  VC--------<>        zbbfsu=0.0_r8;    
  692.  VC--------<>        zbbfsd=0.0_r8;    
  693.               
  694.               
  695.               
  696.               
  697.               
  698.               
  699.               
  700.               
  701.               
  702.               
  703.               
  704.               
  705.                     zepsec = 1.e-06_r8
  706.                     zepzen = 1.e-10_r8
  707.                     oneminus = 1.0_r8 - zepsec
  708.                     pi = 2._r8 * asin(1._r8)
  709.               
  710.                     istart = jpb1
  711.                     iend = jpb2
  712.                     icpr = 0
  713.                     ims = 2
  714.               !      
  715.               !tar begin
  716.               !
  717.               ! Climate aerosol (coarse + fine modes)  (Kinne, 2013)  
  718.                     IF(ifaeros==2) THEN 
  719.               
  720.               ! Initialize local vectors and output variables
  721.               !    
  722.  V---------<>          taual=0.0_r8; ssaal=0.0_r8; asyal=0.0_r8
  723.               !
  724.               ! Fine mode
  725.                        taualF=0.0_r8; ssaalF=0.0_r8; asyalF=0.0_r8
  726.               ! Coarse mode    
  727.                        taualC=0.0_r8; ssaalC=0.0_r8; asyalC=0.0_r8 
  728.               !Initialize new aerosol local vectors
  729.  V---------<>          pr=0.0_r8; tmp=0.0_r8; tpg=0.0_r8; zlv=0.0_r8; dz=0.0_r8; ep=0.0_r8
  730.  V---------<>          f=0.0_r8; ha=0.0_r8; fp=0.0_r8; od_n=0.0_r8; aod_norm=0.0_r8
  731.               !Initialize new aerosol local vectors of fine mode 
  732.  V---------<>          epF=0.0_r8;fF=0.0_r8; haF=0.0_r8; fpF=0.0_r8; od_nF=0.0_r8; aod_normF=0.0_r8
  733.               !       
  734.               !   
  735.  1----------<         DO i=1,ncol
  736.  1            !
  737.  1 2--------<            DO k=1,nlay
  738.  1 2                        tmp(k)=tlay(i,nlay-k+1)  !Flipping from surface
  739.  1 2-------->            END DO 
  740.  1            !
  741.  1 2--------<            DO k=1,nlay+1     
  742.  1 2                        pr(k)=plev(i,nlay-k+2)*100.0_r8  !Flipping from surface in Pa   
  743.  1 2-------->            END DO 
  744.  1            !
  745.  1                       tpg=topogsol(i)  !topography
  746.  1            !
  747.  1 2--------<            DO j=1,40
  748.  1 2                        ep(j)=z_aersol(i,j)  ! Extinction profile from surface, coarse mode
  749.  1 2          !
  750.  1 2                        epF(j)=z_aerFsol(i,j)  ! Extinction profile from surface, fine mode
  751.  1 2          !
  752.  1 2-------->            END DO
  753.  1            !
  754.  1                       CALL zplev(pr,tmp,tpg,nlay, zlv,dz)
  755.  1            ! coarse aerosol mode
  756.  1                       CALL zaero(ep,40, f,ha)
  757.  1            !
  758.  1                       CALL aeros_interp(zlv,ha,f,40,nlay, fp)
  759.  1            !
  760.  1                       CALL aod_n(fp,dz,nlay, od_n)
  761.  1            !
  762.  1            ! fine aerosol mode
  763.  1                       CALL zaero(epF,40, fF,haF)
  764.  1            !
  765.  1                       CALL   aeros_interp(zlv,haF,fF,40,nlay, fpF)
  766.  1            !
  767.  1                       CALL   aod_n(fpF,dz,nlay, od_nF)
  768.  1            !
  769.  1            !
  770.  1            !
  771.  1 2--------<            DO k=1,nlay
  772.  1 2                        aod_norm(i,k)=od_n(nlay-k+1)  !Flipping from top, coarse mode
  773.  1 2          !
  774.  1 2                        aod_normF(i,k)=od_nF(nlay-k+1)  !Flipping from top, fine mode
  775.  1 2          !
  776.  1 2-------->            END DO
  777.  1            !Layer depth in km
  778.  1            !           DO k=1,nlay        
  779.  1            !              dzint(i,k)=dz(nlay-k+1)*0.001_r8 !Flipping from top 
  780.  1            !           END DO
  781.  1            !
  782.  1---------->         END DO   !do i=1,ncol
  783.               
  784.               
  785.  ib---------<         DO k=1,nlay
  786.  ib ib------<            DO ib=1,14
  787.  ib ib b----<               DO i=1,ncol
  788.  ib ib b                       taualC(i,k,ib) = aodsol(i,ib)*aod_norm(i,k)
  789.  ib ib b      ! 
  790.  ib ib b      ! Fine aerosol mode included
  791.  ib ib b      
  792.  ib ib b                       taualF(i,k,ib) = aodFsol(i,ib)*aod_normF(i,k)
  793.  ib ib b      !
  794.  ib ib b                       IF(ssasol(i,ib).GE.0.99_r8) THEN
  795.  ib ib b                          ssaalC(i,k,ib)=0.99_r8
  796.  ib ib b                       ELSE
  797.  ib ib b                          ssaalC(i,k,ib) =ssasol(i,ib)
  798.  ib ib b                       END IF
  799.  ib ib b      !
  800.  ib ib b                       IF(ssaFsol(i,ib).GE.0.99_r8) THEN
  801.  ib ib b                          ssaalF(i,k,ib)=0.99_r8
  802.  ib ib b                       ELSE
  803.  ib ib b                          ssaalF(i,k,ib) =ssaFsol(i,ib)
  804.  ib ib b                       END IF
  805.  ib ib b      !
  806.  ib ib b                       asyalC(i,k,ib) =asysol(i,ib) 
  807.  ib ib b      !
  808.  ib ib b                       asyalF(i,k,ib) =asyFsol(i,ib)
  809.  ib ib b      !
  810.  ib ib b      !                taual(i,k,ib)=taualF(i,k,ib)
  811.  ib ib b      !                ssaal(i,k,ib)=ssaalF(i,k,ib)
  812.  ib ib b      !                asyal(i,k,ib)=asyalF(i,k,ib)
  813.  ib ib b      !
  814.  ib ib b                       taual(i,k,ib)=taualF(i,k,ib)+taualC(i,k,ib)  
  815.  ib ib b      !  
  816.  ib ib b                       IF (taual(i,k,ib)==0.0_r8) THEN
  817.  ib ib b                          ssaal(i,k,ib)=0.99_r8
  818.  ib ib b                          asyal(i,k,ib)=0.7_r8
  819.  ib ib b      !    
  820.  ib ib b                       ELSE
  821.  ib ib b                          ssaal(i,k,ib)=(ssaalF(i,k,ib)*taualF(i,k,ib)+ &
  822.  ib ib b                          ssaalC(i,k,ib)*taualC(i,k,ib))/ taual(i,k,ib)
  823.  ib ib b      !  
  824.  ib ib b                          asyal(i,k,ib)=(asyalF(i,k,ib)*ssaalF(i,k,ib)*taualF(i,k,ib)+   &
  825.  ib ib b                          asyalC(i,k,ib)*ssaalC(i,k,ib)*taualC(i,k,ib))/  &  
  826.  ib ib b                          (ssaalF(i,k,ib)*taualF(i,k,ib)+ssaalC(i,k,ib)*taualC(i,k,ib))
  827.  ib ib b      ! 
  828.  ib ib b                       END IF
  829.  ib ib b      !
  830.  ib ib b      !
  831.  ib ib b---->               END DO
  832.  ib ib------>            END DO
  833.  ib--------->         END DO 
  834.               !
  835.  i----------<         DO k=1,nlay-1
  836.  i i--------<            DO ib=1,14
  837.  i i 3------<               DO i=1,ncol 
  838.  i i 3                         tauaer(i,k,ib)=taual(i,nlay-k+1,ib)  !Flipping from surface
  839.  i i 3                         ssaaer(i,k,ib)=ssaal(i,nlay-k+1,ib)  !Flipping from surface
  840.  i i 3        !                 asyaer(i,k,ib)=asyal(i,nlay-k+1,ib)  !Flipping from surface
  841.  i i 3------>               END DO
  842.  i i-------->            END DO
  843.  i---------->         END DO
  844.                  END IF    !IF(ifaeros==2) THEN 
  845.               
  846.               ! tar end      
  847.                     
  848.                     
  849.               
  850.               ! In a GCM with or without McICA, set nlon to the longitude dimension
  851.               !
  852.               ! Set imca to select calculation type:
  853.               !  imca = 0, use standard forward model calculation (clear and overcast only)
  854.               !  imca = 1, use McICA for Monte Carlo treatment of sub-grid cloud variability
  855.               !            (clear, overcast or partial cloud conditions)
  856.               
  857.               ! *** This version uses McICA (imca = 1) ***
  858.               
  859.               ! Set icld to select of clear or cloud calculation and cloud 
  860.               ! overlap method (read by subroutine readprof from input file INPUT_RRTM):  
  861.               ! icld = 0, clear only
  862.               ! icld = 1, with clouds using random cloud overlap (McICA only)
  863.               ! icld = 2, with clouds using maximum/random cloud overlap (McICA only)
  864.               ! icld = 3, with clouds using maximum cloud overlap (McICA only)
  865.                     if (icld.lt.0.or.icld.gt.3) icld = 2
  866.               
  867.               ! Set iaer to select aerosol option
  868.               ! iaer = 0, no aerosols
  869.               ! iaer = 6, use six ECMWF aerosol types
  870.               !           input aerosol optical depth at 0.55 microns for each aerosol type (ecaer)
  871.               ! iaer = 10, input total aerosol optical depth, single scattering albedo 
  872.               !            and asymmetry parameter (tauaer, ssaaer, asmaer) directly
  873.               !PK      iaer = 10
  874.                      iaer = 10
  875.               ! Set idelm to select between delta-M scaled or unscaled output direct and diffuse fluxes
  876.               ! NOTE: total downward fluxes are always delta scaled
  877.               ! idelm = 0, output direct and diffuse flux components are not delta scaled
  878.               !            (direct flux does not include forward scattering peak)
  879.               ! idelm = 1, output direct and diffuse flux components are delta scaled (default)
  880.               !            (direct flux includes part or most of forward scattering peak)
  881.                     idelm = 1
  882.               
  883.               ! Call model and data initialization, compute lookup tables, perform
  884.               ! reduction of g-points from 224 to 112 for input absorption
  885.               ! coefficient data and other arrays.
  886.               !
  887.               ! In a GCM this call should be placed in the model initialization
  888.               ! area, since this has to be called only once.  
  889.               !      call rrtmg_sw_ini
  890.               
  891.               ! This is the main longitude/column loop in RRTMG.
  892.               ! Modify to loop over all columns (nlon) or over daylight columns
  893.               
  894.  1----------<       do iplon = 1, ncol
  895.  1            
  896.  1            ! Prepare atmosphere profile from GCM for use in RRTMG, and define
  897.  1            ! other input parameters
  898.  1            
  899.  1                     call inatm_sw (    &
  900.  1                         iplon                                   , &
  901.  1                         pcols                                   , &
  902.  1                         nlay                                    , &
  903.  1                         icld                                    , &
  904.  1                         iaer                                    , &
  905.  1                         play         (1:pcols,1:nlay)           , &
  906.  1                         plev         (1:pcols,1:nlay+1)         , &
  907.  1                         tlay         (1:pcols,1:nlay)           , &
  908.  1                         tlev         (1:pcols,1:nlay+1)         , &
  909.  1                         tsfc         (1:pcols)                  , &
  910.  1                         h2ovmr       (1:pcols,1:nlay)           , &
  911.  1                         o3vmr        (1:pcols,1:nlay)           , &
  912.  1                         co2vmr       (1:pcols,1:nlay)           , &
  913.  1                         ch4vmr       (1:pcols,1:nlay)           , &
  914.  1                         o2vmr        (1:pcols,1:nlay)           , &
  915.  1                         n2ovmr       (1:pcols,1:nlay)           , &
  916.  1                         adjes                                   , &
  917.  1                         dyofyr                                  , &
  918.  1                         solvar       (1:nbndsw)                 , &
  919.  1                         inflgsw                                 , &
  920.  1                         iceflgsw                                , &
  921.  1                         liqflgsw                                , &
  922.  1                         cldfmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  923.  1                         taucmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  924.  1                         ssacmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  925.  1                         asmcmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  926.  1                         fsfcmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  927.  1                         ciwpmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  928.  1                         clwpmcl      (1:ngptsw,1:pcols,1:nlay-1), &
  929.  1                         reicmcl      (1:pcols,1:nlay-1)         , &
  930.  1                         relqmcl      (1:pcols,1:nlay-1)         , &
  931.  1                         tauaer       (1:pcols,1:nlay-1,1:nbndsw), &
  932.  1                         ssaaer       (1:pcols,1:nlay-1,1:nbndsw), &
  933.  1                         asmaer       (1:pcols,1:nlay-1,1:nbndsw), &
  934.  1                         pavel        (1:nlay)                   , &
  935.  1                         pz           (0:nlay)                   , &
  936.  1                         pdp          (1:nlay)                   , &
  937.  1                         tavel        (1:nlay)                   , &
  938.  1                         tz           (0:nlay)                   , &
  939.  1                         tbound                                  , &
  940.  1                         coldry       (1:nlay)                   , &
  941.  1                         wkl          (1:mxmol,1:nlay)           , &
  942.  1                         adjflux      (1:jpband)                 , &
  943.  1                         inflag                                  , &
  944.  1                         iceflag                                 , &
  945.  1                         liqflag                                 , &
  946.  1                         cldfmc       (1:ngptsw,1:nlay)          , &
  947.  1                         taucmc       (1:ngptsw,1:nlay)          , &
  948.  1                         ssacmc       (1:ngptsw,1:nlay)          , &
  949.  1                         asmcmc       (1:ngptsw,1:nlay)          , &
  950.  1                         fsfcmc       (1:ngptsw,1:nlay)          , &
  951.  1                         ciwpmc       (1:ngptsw,1:nlay)          , &
  952.  1                         clwpmc       (1:ngptsw,1:nlay)          , &
  953.  1                         reicmc       (1:nlay)                   , &
  954.  1                         dgesmc       (1:nlay)                   , &
  955.  1                         relqmc       (1:nlay)                   , &
  956.  1                         taua         (1:nlay,1:nbndsw)          , &
  957.  1                         ssaa         (1:nlay,1:nbndsw)          , &
  958.  1                         asma         (1:nlay,1:nbndsw)            )
  959.  1            
  960.  1            !  For cloudy atmosphere, use cldprop to set cloud optical properties based on
  961.  1            !  input cloud physical properties.  Select method based on choices described
  962.  1            !  in cldprop.  Cloud fraction, water path, liquid droplet and ice particle
  963.  1            !  effective radius must be passed in cldprop.  Cloud fraction and cloud
  964.  1            !  optical properties are transferred to rrtmg_sw arrays in cldprop.  
  965.  1            
  966.  1            !  If McICA is requested use cloud fraction and cloud physical properties 
  967.  1            !  generated by sub-column cloud generator above. 
  968.  1                  cldfrac(1:nlay-1)=cld(iplon,1:nlay-1)
  969.  1            
  970.  1                     if (imca.eq.0) then
  971.  1 2--------<             do i = 1, nlay
  972.  1 2                         if (cldfrac(i).ne.0.0_r8 .and. cldfrac(i).ne.1.0_r8) then
  973.  1 2                               cldfrac(i)=MIN(MAX(cldfrac(i),0.00001_r8),0.9999_r8)
  974.  1 2                               !stop 'PARTIAL CLOUD NOT ALLOWED FOR IMCA=0'
  975.  1 2                         endif
  976.  1 2-------->             enddo
  977.  1                           call cldprop_sw(nlay-1   , &
  978.  1                                           inflag   , &
  979.  1                                           iceflag  , &
  980.  1                                           liqflag  , &
  981.  1                                           cldfrac   (1:nlay-1)                 , &
  982.  1                                           tauc_sw   (1:nbndsw,iplon,1:nlay-1)  , &
  983.  1                                           ssac_sw   (1:nbndsw,iplon,1:nlay-1)  , &
  984.  1                                           asmc_sw   (1:nbndsw,iplon,1:nlay-1)  , &
  985.  1                                           cicewp    (iplon,1:nlay-1)           , &
  986.  1                                           cliqwp    (iplon,1:nlay-1)           , &
  987.  1                                           reicmcl   (iplon,1:nlay-1)           , &
  988.  1                                           2*reicmcl (iplon,1:nlay-1)           , &
  989.  1                                           relqmcl   (iplon,1:nlay-1)           , &
  990.  1                                           taucldorig(1:nlay-1,1:jpband)          , &
  991.  1                                           taucloud  (1:nlay-1,1:jpband)          , &
  992.  1                                           ssacloud  (1:nlay-1,1:jpband)          , &
  993.  1                                           asmcloud  (1:nlay-1,1:jpband)            )
  994.  1                           icpr = 1
  995.  1            
  996.  1                     else
  997.  1                        call cldprmc_sw( &
  998.  1                                     nlay                                , &
  999.  1                                     inflag                              , &
 1000.  1                                     iceflag                             , &
 1001.  1                                     liqflag                             , &
 1002.  1                                     cldfmc          (1:ngptsw,1:nlay)   , &
 1003.  1                                     ciwpmc          (1:ngptsw,1:nlay)   , &
 1004.  1                                     clwpmc          (1:ngptsw,1:nlay)   , &
 1005.  1                                     reicmc          (1:nlay)            , &
 1006.  1                                     dgesmc          (1:nlay)            , &
 1007.  1                                     relqmc          (1:nlay)            , &
 1008.  1                                     taormc          (1:ngptsw,1:nlay)   , & 
 1009.  1                                     taucmc          (1:ngptsw,1:nlay)   , & 
 1010.  1                                     ssacmc          (1:ngptsw,1:nlay)   , & 
 1011.  1                                     asmcmc          (1:ngptsw,1:nlay)   , & 
 1012.  1                                     fsfcmc          (1:ngptsw,1:nlay)   ) 
 1013.  1                        icpr = 1
 1014.  1            
 1015.  1                     endif
 1016.  1            ! Calculate coefficients for the temperature and pressure dependence of the 
 1017.  1            ! molecular absorption coefficients by interpolating data from stored
 1018.  1            ! reference atmospheres.
 1019.  1            
 1020.  1                     call setcoef_sw( &
 1021.  1                                     nlay                  , &
 1022.  1                                     pavel         (1:nlay), &
 1023.  1                                     tavel         (1:nlay), &
 1024.  1                                     pz            (0:nlay), &
 1025.  1                                     tz            (0:nlay)        , &
 1026.  1                                     tbound                        , &
 1027.  1                                     coldry        (1:nlay)        , &
 1028.  1                                     wkl           (1:mxmol,1:nlay), &
 1029.  1                                     laytrop               , &
 1030.  1                                     layswtch              , &
 1031.  1                                     laylow                , &
 1032.  1                                     jp            (1:nlay), &
 1033.  1                                     jt            (1:nlay), &
 1034.  1                                     jt1           (1:nlay), &
 1035.  1                                     co2mult       (1:nlay), &
 1036.  1                                     colch4        (1:nlay), &
 1037.  1                                     colco2        (1:nlay), &
 1038.  1                                     colh2o        (1:nlay), &
 1039.  1                                     colmol        (1:nlay), &
 1040.  1                                     coln2o        (1:nlay), &
 1041.  1                                     colo2         (1:nlay), &
 1042.  1                                     colo3         (1:nlay), &
 1043.  1                                     fac00         (1:nlay), &
 1044.  1                                     fac01         (1:nlay), &
 1045.  1                                     fac10         (1:nlay), &
 1046.  1                                     fac11         (1:nlay), &
 1047.  1                                     selffac       (1:nlay), &
 1048.  1                                     selffrac      (1:nlay), &
 1049.  1                                     indself       (1:nlay), &
 1050.  1                                     forfac        (1:nlay), &
 1051.  1                                     forfrac       (1:nlay), &
 1052.  1                                     indfor        (1:nlay)  )
 1053.  1            
 1054.  1            ! Cosine of the solar zenith angle 
 1055.  1            !  Prevent using value of zero; ideally, SW model is not called from host model when sun 
 1056.  1            !  is below horizon
 1057.  1            
 1058.  1                     cossza = coszen(iplon)
 1059.  1                     if (cossza .lt. zepzen) cossza = zepzen
 1060.  1            
 1061.  1            ! Transfer albedo, cloud and aerosol properties into arrays for 2-stream radiative transfer 
 1062.  1            
 1063.  1            ! Surface albedo
 1064.  1            !  Near-IR bands 16-24 and 29 (1-9 and 14), 820-16000 cm-1, 0.625-12.195 microns
 1065.  1            !         do ib=1,9
 1066.  1 2--------<          do ib=1,8
 1067.  1 2                      albdir(ib) = aldir(iplon)
 1068.  1 2                      albdif(ib) = aldif(iplon)
 1069.  1 2-------->          enddo
 1070.  1                     albdir(nbndsw) = aldir(iplon)
 1071.  1                     albdif(nbndsw) = aldif(iplon)
 1072.  1            !  Set band 24 (or, band 9 counting from 1) to use linear average of UV/visible
 1073.  1            !  and near-IR values, since this band straddles 0.7 microns: 
 1074.  1                     albdir(9) = 0.5*(aldir(iplon) + asdir(iplon))
 1075.  1                     albdif(9) = 0.5*(aldif(iplon) + asdif(iplon))
 1076.  1            !  UV/visible bands 25-28 (10-13), 16000-50000 cm-1, 0.200-0.625 micron
 1077.  1 2--------<          do ib=10,13
 1078.  1 2                      albdir(ib) = asdir(iplon)
 1079.  1 2                      albdif(ib) = asdif(iplon)
 1080.  1 2-------->          enddo
 1081.  1            
 1082.  1            
 1083.  1            ! Clouds
 1084.  1                     if (icld.eq.0) then
 1085.  1            
 1086.  1 VC------<>             ztauc(:,:) = 0.0_r8
 1087.  1 VC------<>             ztaucorig(:,:) = 0.0_r8
 1088.  1 VC------<>             zasyc(:,:) = 0.0_r8
 1089.  1 VC------<>             zomgc(:,:) = 1.0_r8
 1090.  1 VC------<>             zcldfmc(:,:) = 0._r8
 1091.  1 VC------<>             ztaucmc(:,:) = 0._r8
 1092.  1 VC------<>             ztaormc(:,:) = 0._r8
 1093.  1 VC------<>             zasycmc(:,:) = 0._r8
 1094.  1 VC------<>             zomgcmc(:,:) = 1._r8
 1095.  1            
 1096.  1                     elseif (icld.ge.1) then
 1097.  1                        if (imca.eq.0) then
 1098.  1 2--------<                do i=1,nlay
 1099.  1 2 3------<                   do ib=1,nbndsw
 1100.  1 2 3                             if (cldfrac(i) .ge. zepsec) then
 1101.  1 2 3                                ztauc(i,ib) = taucloud(i,jpb1-1+ib)
 1102.  1 2 3                                ztaucorig(i,ib) = taucldorig(i,jpb1-1+ib)
 1103.  1 2 3                                zasyc(i,ib) = asmcloud(i,jpb1-1+ib)
 1104.  1 2 3                                zomgc(i,ib) = ssacloud(i,jpb1-1+ib)
 1105.  1 2 3                             endif
 1106.  1 2 3------>                   enddo
 1107.  1 2-------->                enddo
 1108.  1                        else
 1109.  1 ib-------<                do i=1,nlay
 1110.  1 ib ib----<                   do ig=1,ngptsw
 1111.  1 ib ib                           zcldfmc(i,ig) = cldfmc(ig,i)
 1112.  1 ib ib                           ztaucmc(i,ig) = taucmc(ig,i)
 1113.  1 ib ib                           ztaormc(i,ig) = taormc(ig,i)
 1114.  1 ib ib                           zasycmc(i,ig) = asmcmc(ig,i)
 1115.  1 ib ib                           zomgcmc(i,ig) = ssacmc(ig,i)
 1116.  1 ib ib---->                   enddo
 1117.  1 ib------->                enddo
 1118.  1                        endif   
 1119.  1                     endif   
 1120.  1            
 1121.  1            ! Aerosol
 1122.  1            ! IAER = 0: no aerosols
 1123.  1                     if (iaer.eq.0) then
 1124.  1            
 1125.  1 VC------<>             ztaua(:,:) = 0._r8
 1126.  1 VC------<>             zasya(:,:) = 0._r8
 1127.  1 VC------<>             zomga(:,:) = 1._r8
 1128.  1            
 1129.  1            ! IAER = 6: Use ECMWF six aerosol types. See rrsw_aer.f90 for details.
 1130.  1            ! Input aerosol optical thickness at 0.55 micron for each aerosol type (ecaer), 
 1131.  1            ! or set manually here for each aerosol and layer.
 1132.  1                     elseif (iaer.eq.6) then
 1133.  1            
 1134.  1 C--------<             do i = 1, nlay
 1135.  1 C C------<                do ia = 1, naerec
 1136.  1 C C                          ecaer(iplon,i,ia) =0.0e-15_r8
 1137.  1 C C------>                enddo
 1138.  1 C-------->             enddo
 1139.  1            
 1140.  1 ib-------<             do i = 1, nlay
 1141.  1 ib ib----<                do ib = 1, nbndsw
 1142.  1 ib ib                        ztaua(i,ib) = 0._r8
 1143.  1 ib ib                        zasya(i,ib) = 0._r8
 1144.  1 ib ib                        zomga(i,ib) = 1._r8
 1145.  1 ib ib 4--<                   do ia = 1, naerec
 1146.  1 ib ib 4                         ztaua(i,ib) = ztaua(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia)
 1147.  1 ib ib 4                        zomga(i,ib) = zomga(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia) * &
 1148.  1 ib ib 4                                       rsrpiza(ib,ia)
 1149.  1 ib ib 4                         zasya(i,ib) = zasya(i,ib) + rsrtaua(ib,ia) * ecaer(iplon,i,ia) * &
 1150.  1 ib ib 4                                       rsrpiza(ib,ia) * rsrasya(ib,ia)
 1151.  1 ib ib 4-->                   enddo
 1152.  1 ib ib                        if (zomga(i,ib) /= 0._r8) then
 1153.  1 ib ib                           zasya(i,ib) = zasya(i,ib) / zomga(i,ib)
 1154.  1 ib ib                        endif
 1155.  1 ib ib                        if (ztaua(i,ib) /= 0._r8) then
 1156.  1 ib ib                           zomga(i,ib) = zomga(i,ib) / ztaua(i,ib)
 1157.  1 ib ib                        endif
 1158.  1 ib ib---->                enddo
 1159.  1 ib------->             enddo
 1160.  1            
 1161.  1            ! IAER=10: Direct specification of aerosol optical properties from GCM
 1162.  1                     elseif (iaer.eq.10) then
 1163.  1            
 1164.  1 C--------<             do i = 1 ,nlay
 1165.  1 C C------<                do ib = 1 ,nbndsw
 1166.  1 C C                          ztaua(i,ib) = taua(i,ib)
 1167.  1 C C                          zasya(i,ib) = asma(i,ib)
 1168.  1 C C                          zomga(i,ib) = ssaa(i,ib)
 1169.  1 C C------>                enddo
 1170.  1 C-------->             enddo
 1171.  1            
 1172.  1                     endif
 1173.  1            
 1174.  1            
 1175.  1            ! Call the 2-stream radiation transfer model
 1176.  1            
 1177.  1 2--------<          do i=1,nlay+1
 1178.  1 2                      zbbcu(i) = 0._r8
 1179.  1 2                      zbbcd(i) = 0._r8
 1180.  1 2                      zbbfu(i) = 0._r8
 1181.  1 2                      zbbfd(i) = 0._r8
 1182.  1 2                      zbbcddir(i) = 0._r8
 1183.  1 2                      zbbfddir(i) = 0._r8
 1184.  1 2                      zuvcd(i) = 0._r8
 1185.  1 2                      zuvfd(i) = 0._r8
 1186.  1 2                      zuvcddir(i) = 0._r8
 1187.  1 2                      zuvfddir(i) = 0._r8  
 1188.  1 2                      znicd(i) = 0._r8
 1189.  1 2                      znifd(i) = 0._r8
 1190.  1 2                      znicddir(i) = 0._r8
 1191.  1 2                      znifddir(i) = 0._r8
 1192.  1 2              
 1193.  1 2                      znicu(i) = 0._r8
 1194.  1 2                      znifu(i) = 0._r8
 1195.  1 2 V-----<>             zbbfsu(:,i) = 0._r8
 1196.  1 2 V-----<>             zbbfsd(:,i) = 0._r8
 1197.  1 2-------->          enddo
 1198.  1            
 1199.  1                     if (imca.eq.0) then
 1200.  1                        call spcvrt_sw (&
 1201.  1                          nlay                                , &! nlay                             ,&!
 1202.  1                          istart                              , &! istart                           ,&!
 1203.  1                          iend                                , &! iend                             ,&!
 1204.  1                          icpr                                , &! icpr                             ,&!
 1205.  1                          idelm                               , &! idelm                            ,&!
 1206.  1                          iout                                , &! iout                             ,&!
 1207.  1                          pavel         (1:nlay)              , &! pavel      (1:nlay)              ,&!
 1208.  1                          tavel         (1:nlay)              , &! tavel      (1:nlay)              ,&!
 1209.  1                          pz            (0:nlay)              , &! pz         (0:nlay)              ,&!
 1210.  1                          tz            (0:nlay)              , &! tz         (0:nlay)              ,&!
 1211.  1                          tbound                              , &! tbound                           ,&!
 1212.  1                          albdif        (1:nbndsw)            , &! albdif     (1:nbndsw)            ,&!
 1213.  1                          albdir        (1:nbndsw)            , &! albdir     (1:nbndsw)            ,&!
 1214.  1                          cldfrac       (1:nlay)              , &! zcldfmc    (1:nlay,1:ngptsw)     ,&!
 1215.  1                          ztauc         (1:nlay,1:nbndsw)     , &! ztaucmc    (1:nlay,1:ngptsw)     ,&!
 1216.  1                          zasyc         (1:nlay,1:nbndsw)     , &! zasycmc    (1:nlay,1:ngptsw)     ,&!
 1217.  1                          zomgc         (1:nlay,1:nbndsw)     , &! zomgcmc    (1:nlay,1:ngptsw)     ,&!
 1218.  1                          ztaucorig     (1:nlay,1:nbndsw)     , &! ztaormc    (1:nlay,1:ngptsw)     ,&!
 1219.  1                          ztaua         (1:nlay,1:nbndsw)     , &! ztaua      (1:nlay,1:nbndsw)     ,&!
 1220.  1                          zasya         (1:nlay,1:nbndsw)     , &! zasya      (1:nlay,1:nbndsw)     ,&!
 1221.  1                          zomga         (1:nlay,1:nbndsw)     , &! zomga      (1:nlay,1:nbndsw)     ,&!
 1222.  1                          cossza                              , &! cossza                           ,&!
 1223.  1                          coldry        (1:nlay)              , &! coldry     (1:nlay)              ,&!
 1224.  1                          wkl           (1:mxmol,1:nlay)      , &! wkl        (1:mxmol,1:nlay)      ,&!
 1225.  1                          adjflux       (1:jpband)            , &! adjflux    (1:jpband)            ,&!
 1226.  1                          laytrop                             , &! laytrop                          ,&!
 1227.  1                          layswtch                            , &! layswtch                         ,&!
 1228.  1                          laylow                              , &! laylow                           ,&!
 1229.  1                          jp            (1:nlay)              , &! jp          (1:nlay)             ,&!
 1230.  1                          jt            (1:nlay)              , &! jt          (1:nlay)             ,&!
 1231.  1                          jt1           (1:nlay)              , &! jt1         (1:nlay)             ,&!
 1232.  1                          co2mult       (1:nlay)              , &! co2mult     (1:nlay)             ,&!
 1233.  1                          colch4        (1:nlay)              , &! colch4      (1:nlay)             ,&!
 1234.  1                          colco2        (1:nlay)              , &! colco2      (1:nlay)             ,&!
 1235.  1                          colh2o        (1:nlay)              , &! colh2o      (1:nlay)             ,&!
 1236.  1                          colmol        (1:nlay)              , &! colmol      (1:nlay)             ,&!
 1237.  1                          coln2o        (1:nlay)              , &! coln2o      (1:nlay)             ,&!
 1238.  1                          colo2         (1:nlay)              , &! colo2       (1:nlay)             ,&!
 1239.  1                          colo3         (1:nlay)              , &! colo3       (1:nlay)             ,&!
 1240.  1                          fac00         (1:nlay)              , &! fac00       (1:nlay)             ,&!
 1241.  1                          fac01         (1:nlay)              , &! fac01       (1:nlay)             ,&!
 1242.  1                          fac10         (1:nlay)              , &! fac10       (1:nlay)             ,&!
 1243.  1                          fac11         (1:nlay)              , &! fac11       (1:nlay)             ,&!
 1244.  1                          selffac       (1:nlay)              , &! selffac     (1:nlay)             ,&!
 1245.  1                          selffrac      (1:nlay)              , &! selffrac    (1:nlay)             ,&!
 1246.  1                          indself       (1:nlay)              , &! indself     (1:nlay)             ,&!
 1247.  1                          forfac        (1:nlay)              , &! forfac      (1:nlay)             ,&!
 1248.  1                          forfrac       (1:nlay)              , &! forfrac     (1:nlay)             ,&!
 1249.  1                          indfor        (1:nlay)              , &! indfor      (1:nlay)             ,&!
 1250.  1                          zbbfd         (1:nlay+2)            , &! zbbfd       (1:nlay+2)           ,&!
 1251.  1                          zbbfu         (1:nlay+2)            , &! zbbfu       (1:nlay+2)           ,&!
 1252.  1                          zbbcd         (1:nlay+2)            , &! zbbcd       (1:nlay+2)           ,&!
 1253.  1                          zbbcu         (1:nlay+2)            , &! zbbcu       (1:nlay+2)           ,&!
 1254.  1                          zuvfd         (1:nlay+2)            , &! zuvfd       (1:nlay+2)           ,&!
 1255.  1                          zuvcd         (1:nlay+2)            , &! zuvcd       (1:nlay+2)           ,&!
 1256.  1                          znifd         (1:nlay+2)            , &! znifd       (1:nlay+2)           ,&!
 1257.  1                          znicd         (1:nlay+2)            , &! znicd       (1:nlay+2)           ,&!
 1258.  1                          znifu         (1:nlay+2)            , &! znifu       (1:nlay+2)           ,&!
 1259.  1                          znicu         (1:nlay+2)            , &! znicu       (1:nlay+2)           ,&!
 1260.  1                          zbbfddir      (1:nlay+2)            , &! zbbfddir    (1:nlay+2)           ,&!
 1261.  1                          zbbcddir      (1:nlay+2)            , &! zbbcddir    (1:nlay+2)           ,&!
 1262.  1                          zuvfddir      (1:nlay+2)            , &! zuvfddir    (1:nlay+2)           ,&!
 1263.  1                          zuvcddir      (1:nlay+2)            , &! zuvcddir    (1:nlay+2)           ,&!
 1264.  1                          znifddir      (1:nlay+2)            , &! znifddir    (1:nlay+2)           ,&!
 1265.  1                          znicddir      (1:nlay+2)              )! znicddir    (1:nlay+2)           ,&!
 1266.  1                     else
 1267.  1                        call spcvmc_sw( &
 1268.  1                          iplon                          ,&!
 1269.  1                          nlay                           ,&!
 1270.  1                          istart                         ,&!
 1271.  1                          iend                           ,&!
 1272.  1                          icpr                           ,&!
 1273.  1                          idelm                          ,&!
 1274.  1                          iout                           ,&!
 1275.  1                          pavel      (1:nlay)            ,&!
 1276.  1                          tavel      (1:nlay)            ,&!
 1277.  1                          pz         (0:nlay)            ,&!
 1278.  1                          tz         (0:nlay)            ,&!
 1279.  1                          tbound                         ,&!
 1280.  1                          albdif     (1:nbndsw)          ,&!
 1281.  1                          albdir     (1:nbndsw)          ,&!
 1282.  1                          zcldfmc    (1:nlay,1:ngptsw)   ,&!
 1283.  1                          ztaucmc    (1:nlay,1:ngptsw)   ,&!
 1284.  1                          zasycmc    (1:nlay,1:ngptsw)   ,&!
 1285.  1                          zomgcmc    (1:nlay,1:ngptsw)   ,&!
 1286.  1                          ztaormc    (1:nlay,1:ngptsw)   ,&!
 1287.  1                          ztaua      (1:nlay,1:nbndsw)   ,&!
 1288.  1                          zasya      (1:nlay,1:nbndsw)   ,&!
 1289.  1                          zomga      (1:nlay,1:nbndsw)   ,&!
 1290.  1                          cossza                         ,&!
 1291.  1                          coldry     (1:nlay)            ,&!  
 1292.  1                          wkl        (1:mxmol,1:nlay)    ,&! 
 1293.  1                          adjflux    (1:jpband)          ,&!
 1294.  1                          laytrop                        ,&!
 1295.  1                          layswtch                       ,&!
 1296.  1                          laylow                         ,&!
 1297.  1                          jp         (1:nlay)            ,&! 
 1298.  1                          jt         (1:nlay)            ,&! 
 1299.  1                          jt1        (1:nlay)            ,&!
 1300.  1                          co2mult    (1:nlay)            ,&!
 1301.  1                          colch4     (1:nlay)            ,&!
 1302.  1                          colco2     (1:nlay)            ,&!
 1303.  1                          colh2o     (1:nlay)            ,&!
 1304.  1                          colmol     (1:nlay)            ,&!
 1305.  1                          coln2o     (1:nlay)            ,&!
 1306.  1                          colo2      (1:nlay)            ,&!
 1307.  1                          colo3      (1:nlay)            ,&!
 1308.  1                          fac00      (1:nlay)            ,&!
 1309.  1                          fac01      (1:nlay)            ,&!
 1310.  1                          fac10      (1:nlay)            ,&!
 1311.  1                          fac11      (1:nlay)            ,&!
 1312.  1                          selffac    (1:nlay)            ,&!
 1313.  1                          selffrac   (1:nlay)            ,&!
 1314.  1                          indself    (1:nlay)            ,&!
 1315.  1                          forfac     (1:nlay)            ,&!
 1316.  1                          forfrac    (1:nlay)            ,&!
 1317.  1                          indfor     (1:nlay)            ,&!
 1318.  1                          zbbfd      (1:nlay+2)          ,&! zbbfd(nlay+2)          ! temporary downward shortwave flux (w/m2)
 1319.  1                          zbbfu      (1:nlay+2)          ,&! zbbfu(nlay+2)          ! temporary upward shortwave flux (w/m2)
 1320.  1                          zbbcd      (1:nlay+2)          ,&! zbbcd(nlay+2)          ! temporary clear sky downward shortwave flux (w/m2)
 1321.  1                          zbbcu      (1:nlay+2)          ,&! zbbcu(nlay+2)          ! temporary clear sky upward shortwave flux (w/m2)
 1322.  1                          zuvfd      (1:nlay+2)          ,&! zuvfd(nlay+2)          ! temporary UV downward shortwave flux (w/m2)
 1323.  1                          zuvcd      (1:nlay+2)          ,&! zuvcd(nlay+2)          ! temporary clear sky UV downward shortwave flux (w/m2)
 1324.  1                          znifd      (1:nlay+2)          ,&! znifd(nlay+2)          ! temporary near-IR downward shortwave flux (w/m2)
 1325.  1                          znicd      (1:nlay+2)          ,&! znicd(nlay+2)          ! temporary clear sky near-IR downward shortwave flux (w/m2)
 1326.  1                          znifu      (1:nlay+2)          ,&! znifu(nlay+2)          ! temporary near-IR downward shortwave flux (w/m2)
 1327.  1                          znicu      (1:nlay+2)          ,&! znicu(nlay+2)          ! temporary clear sky near-IR downward shortwave flux (w/m2)
 1328.  1                          zbbfddir   (1:nlay+2)          ,&! zbbfddir(nlay+2)       ! temporary downward direct shortwave flux (w/m2)
 1329.  1                          zbbcddir   (1:nlay+2)          ,&! zbbcddir(nlay+2)       ! temporary clear sky downward direct shortwave flux (w/m2)
 1330.  1                          zuvfddir   (1:nlay+2)          ,&! zuvfddir(nlay+2)       ! temporary UV downward direct shortwave flux (w/m2)
 1331.  1                          zuvcddir   (1:nlay+2)          ,&! zuvcddir(nlay+2)       ! temporary clear sky UV downward direct shortwave flux (w/m2)
 1332.  1                          znifddir   (1:nlay+2)          ,&! znifddir(nlay+2)       ! temporary near-IR downward direct shortwave flux (w/m2)
 1333.  1                          znicddir   (1:nlay+2)          ,&! znicddir(nlay+2)       ! temporary clear sky near-IR downward direct shortwave flux (w/m2)
 1334.  1                          zbbfsu     (1:nbndsw,1:nlay+2) ,&! zbbfsu(nbndsw,nlay+2)  ! temporary upward shortwave flux spectral (w/m2)
 1335.  1                          zbbfsd     (1:nbndsw,1:nlay+2)  )! zbbfsd(nbndsw,nlay+2)  ! temporary downward shortwave flux spectral (w/m2)
 1336.  1                     endif
 1337.  1            
 1338.  1            ! Transfer up and down, clear and total sky fluxes to output arrays.
 1339.  1            ! Vertical indexing goes from bottom to top
 1340.  1            !      real(kind=r8), intent(out) :: dirdnuv_localc(:,:)        ! Direct downward shortwave flux, UV/vis
 1341.  1            !      real(kind=r8), intent(out) :: difdnuvc_local(:,:)        ! Diffuse downward shortwave flux, UV/vis
 1342.  1            !      real(kind=r8), intent(out) :: dirdnirc_local(:,:)        ! Direct downward shortwave flux, near-IR
 1343.  1            !      real(kind=r8), intent(out) :: difdnirc_local(:,:)        ! Diffuse downward shortwave flux, near-IR
 1344.  1             
 1345.  1            !      real(kind=r8) :: zuvcd(nlay+2)          ! temporary clear sky UV downward shortwave flux (w/m2)
 1346.  1            !      real(kind=r8) :: znifd(nlay+2)          ! temporary           near-IR downward shortwave flux (w/m2)
 1347.  1            !      real(kind=r8) :: znicd(nlay+2)          ! temporary clear sky near-IR downward shortwave flux (w/m2)
 1348.  1            
 1349.  1 2--------<          do i = 1, nlay+1
 1350.  1 2                      swuflxc_local(iplon,i) = zbbcu(i)
 1351.  1 2                      swdflxc_local(iplon,i) = zbbcd(i)
 1352.  1 2                      swuflx_local(iplon,i) = zbbfu(i)
 1353.  1 2                      swdflx_local(iplon,i) = zbbfd(i)
 1354.  1 2 V-----<>             swuflxs_local(:,iplon,i) = zbbfsu(:,i)
 1355.  1 2 V-----<>             swdflxs_local(:,iplon,i) = zbbfsd(:,i)
 1356.  1 2                      uvdflx(i) = zuvfd(i)
 1357.  1 2                      nidflx(i) = znifd(i)
 1358.  1 2          !  Direct/diffuse fluxes
 1359.  1 2                      dirdflux(i) = zbbfddir(i)
 1360.  1 2                      difdflux(i) = swdflx_local(iplon,i) - dirdflux(i)
 1361.  1 2          !  UV/visible direct/diffuse fluxes
 1362.  1 2                      dirdnuvc_local(iplon,i) =zuvcddir(i) ! temporary clear sky UV downward direct shortwave flux (w/m2)
 1363.  1 2                      dirdnuv_local(iplon,i) = zuvfddir(i) ! temporary           UV downward direct shortwave flux (w/m2)
 1364.  1 2                      difdnuv_local(iplon,i) = zuvfd(i) - dirdnuv_local(iplon,i)
 1365.  1 2                      difdnuvc_local(iplon,i)= zuvcd(i) - dirdnuvc_local(iplon,i)
 1366.  1 2          !  Near-IR direct/diffuse fluxes
 1367.  1 2                      dirdnirc_local(iplon,i) = znicddir(i)       ! temporary clear sky near-IR downward direct shortwave flux (w/m2)
 1368.  1 2                      dirdnir_local(iplon,i)  = znifddir(i)       ! temporary           near-IR downward direct shortwave flux (w/m2)
 1369.  1 2                      difdnir_local(iplon,i)  = znifd(i) - dirdnir_local(iplon,i)
 1370.  1 2                      difdnirc_local(iplon,i) = znicd(i) - dirdnirc_local(iplon,i)
 1371.  1 2          !  Added for net near-IR diagnostic
 1372.  1 2                      ninflx_local(iplon,i) = znifd(i) - znifu(i)
 1373.  1 2                      ninflxc_local(iplon,i) = znicd(i) - znicu(i)
 1374.  1 2-------->          enddo
 1375.  1            
 1376.  1            !  Total and clear sky net fluxes
 1377.  1 2--------<          do i = 1, nlay+1
 1378.  1 2                      swnflxc(i) = swdflxc_local(iplon,i) - swuflxc_local(iplon,i)
 1379.  1 2                      swnflx(i) = swdflx_local(iplon,i) - swuflx_local(iplon,i)
 1380.  1 2-------->          enddo
 1381.  1            
 1382.  1            !  Total and clear sky heating rates
 1383.  1            !  Heating units are in K/d. Flux units are in W/m2.
 1384.  1 2--------<          do i = 1, nlay
 1385.  1 2                      zdpgcp = heatfac / pdp(i)
 1386.  1 2                      swhrc_local(iplon,i) = (swnflxc(i+1) - swnflxc(i)) * zdpgcp
 1387.  1 2                      swhr_local(iplon,i) = (swnflx(i+1) - swnflx(i)) * zdpgcp
 1388.  1 2-------->          enddo
 1389.  1                     swhrc_local(iplon,nlay) = 0._r8
 1390.  1                     swhr_local(iplon,nlay) = 0._r8
 1391.  1            !***********************************************************************************************************************
 1392.  1 2--------<          do i = 1, nlay+1
 1393.  1 2                      swuflx  (iplon,i) = swuflx  (iplon,i) +  swuflx_local  (iplon,i) ! Total sky shortwave upward flux (W/m2)!    Dimensions: (ncol,nlay+1)
 1394.  1 2                      swdflx  (iplon,i) = swdflx  (iplon,i) +  swdflx_local  (iplon,i) ! Total sky shortwave downward flux (W/m2)!    Dimensions: (ncol,nlay+1)
 1395.  1 2                      swuflxc (iplon,i) = swuflxc (iplon,i) +  swuflxc_local (iplon,i) ! Clear sky shortwave upward flux (W/m2)!    Dimensions: (ncol,nlay+1)
 1396.  1 2                      swdflxc (iplon,i) = swdflxc (iplon,i) +  swdflxc_local (iplon,i) ! Clear sky shortwave downward flux (W/m2)!    Dimensions: (ncol,nlay+1)
 1397.  1 2          
 1398.  1 2                      dirdnuv (iplon,i) = dirdnuv (iplon,i) +  dirdnuv_local (iplon,i) ! Direct downward shortwave flux, UV/vis
 1399.  1 2                      difdnuv (iplon,i) = difdnuv (iplon,i) +  difdnuv_local (iplon,i) ! Diffuse downward shortwave flux, UV/vis
 1400.  1 2                      dirdnir (iplon,i) = dirdnir (iplon,i) +  dirdnir_local (iplon,i) ! Direct downward shortwave flux, near-IR
 1401.  1 2                      difdnir (iplon,i) = difdnir (iplon,i) +  difdnir_local (iplon,i) ! Diffuse downward shortwave flux, near-IR
 1402.  1 2          
 1403.  1 2                      dirdnuvc(iplon,i) = dirdnuvc(iplon,i) +  dirdnuvc_local(iplon,i) ! Direct downward shortwave flux, UV/vis
 1404.  1 2                      difdnuvc(iplon,i) = difdnuvc(iplon,i) +  difdnuvc_local(iplon,i) ! Diffuse downward shortwave flux, UV/vis
 1405.  1 2                      dirdnirc(iplon,i) = dirdnirc(iplon,i) +  dirdnirc_local(iplon,i) ! Direct downward shortwave flux, near-IR
 1406.  1 2                      difdnirc(iplon,i) = difdnirc(iplon,i) +  difdnirc_local(iplon,i) ! Diffuse downward shortwave flux, near-IR
 1407.  1 2          
 1408.  1 2                      ninflx  (iplon,i) = ninflx  (iplon,i) +  ninflx_local  (iplon,i) ! Net shortwave flux, near-IR
 1409.  1 2                      ninflxc (iplon,i) = ninflxc (iplon,i) +  ninflxc_local (iplon,i) ! Net clear sky shortwave flux, near-IR
 1410.  1 2-------->          END DO
 1411.  1 2--------<          do i = 1, nlay+1
 1412.  1 2 3------<             DO k=1,nbndsw
 1413.  1 2 3                       swuflxs (k,iplon,i) = swuflxs (k,iplon,i) + swuflxs_local (k,iplon,i)! shortwave spectral flux up
 1414.  1 2 3                       swdflxs (k,iplon,i) = swdflxs (k,iplon,i) + swdflxs_local (k,iplon,i)! shortwave spectral flux down
 1415.  1 2 3------>             END DO
 1416.  1 2-------->          END DO
 1417.  1 2--------<          do i = 1, nlay
 1418.  1 2                      swhrc   (iplon,i) = swhrc   (iplon,i) + swhrc_local   (iplon,i) ! Clear sky shortwave radiative heating rate (K/d)!    Dimensions: (ncol,nlay) 
 1419.  1 2                      swhr    (iplon,i) = swhr    (iplon,i) + swhr_local    (iplon,i) ! Total sky shortwave radiative heating rate (K/d)!    Dimensions: (ncol,nlay)
 1420.  1 2-------->          END DO
 1421.  1            ! End longitude loop
 1422.  1---------->       enddo
 1423.               
 1424.                     end subroutine rrtmg_sw
ftn-5001 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "DIFDFLUX" is assigned a value but never used.

ftn-5001 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "UVDFLX" is assigned a value but never used.

ftn-5001 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "IMS" is assigned a value but never used.

ftn-5001 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "NIDFLX" is assigned a value but never used.

ftn-5001 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "ASYAL" is assigned a value but never used.

ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "ISCCOS" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Local variable "NCBANDS" is declared but neither defined nor used.

ftn-5004 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1424 
  Dummy Argument "FSFC_SW" is not referenced or defined.

 1425.               
 1426.               !*************************************************************************
 1427.                     real(kind=r8) function earth_sun(idn)
 1428.               !*************************************************************************
 1429.               !
 1430.               !  Purpose: Function to calculate the correction factor of Earth's orbit
 1431.               !  for current day of the year
 1432.               
 1433.               !  idn        : Day of the year
 1434.               !  earth_sun  : square of the ratio of mean to actual Earth-Sun distance
 1435.               
 1436.               ! ------- Modules -------
 1437.               
 1438.                     use rrsw_con, only : pi
 1439.               
 1440.                     integer, intent(in) :: idn
 1441.               
 1442.                     real(kind=r8) :: gamma
 1443.               
 1444.                     gamma = 2._r8*pi*(idn-1)/365._r8
 1445.               
 1446.               ! Use Iqbal's equation 1.2.1
 1447.               
 1448.                     earth_sun = 1.000110_r8 + .034221_r8 * cos(gamma) + .001289_r8 * sin(gamma) + &
 1449.                                  .000719_r8 * cos(2._r8*gamma) + .000077_r8 * sin(2._r8*gamma)
 1450.               
 1451.                     end function earth_sun
 1452.               
 1453.               !***************************************************************************
 1454.                     subroutine inatm_sw ( &        !  call inatm_sw (    &
 1455.                           iplon      , &!              iplon                                     , &
 1456.                           pcols      , &!              pcols
 1457.                           nlay       , &!              nlay                                      , &
 1458.                           icld       , &!              icld                                      , &
 1459.                           iaer       , &!              iaer                                      , &
 1460.                           play       , &!              play           (1:pcols,1:nlay)           , &
 1461.                           plev       , &!              plev           (1:pcols,1:nlay+1)         , &
 1462.                           tlay       , &!              tlay           (1:pcols,1:nlay)           , &
 1463.                           tlev       , &!              tlev           (1:pcols,1:nlay+1)         , &
 1464.                           tsfc       , &!              tsfc           (1:pcols)                  , &
 1465.                           h2ovmr     , &!              h2ovmr         (1:pcols,1:nlay)           , &
 1466.                           o3vmr      , &!              o3vmr          (1:pcols,1:nlay)           , &
 1467.                           co2vmr     , &!              co2vmr         (1:pcols,1:nlay)           , &
 1468.                           ch4vmr     , &!              ch4vmr         (1:pcols,1:nlay)           , &
 1469.                           o2vmr      , &!              o2vmr          (1:pcols,1:nlay)           , &
 1470.                           n2ovmr     , &!              n2ovmr         (1:pcols,1:nlay)           , &
 1471.                           adjes      , &!              adjes                                     , &
 1472.                           dyofyr     , &!              dyofyr                                    , &
 1473.                           solvar     , &!              solvar         (1:nbndsw)                 , &
 1474.                           inflgsw    , &!              inflgsw                                   , &
 1475.                           iceflgsw   , &!              iceflgsw                                  , &
 1476.                           liqflgsw   , &!              liqflgsw                                  , &
 1477.                           cldfmcl    , &!              cldfmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1478.                           taucmcl    , &!              taucmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1479.                           ssacmcl    , &!              ssacmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1480.                           asmcmcl    , &!              asmcmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1481.                           fsfcmcl    , &!              fsfcmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1482.                           ciwpmcl    , &!              ciwpmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1483.                           clwpmcl    , &!              clwpmcl        (1:ngptsw,1:pcols,1:nlay-1), &
 1484.                           reicmcl    , &!              reicmcl        (1:pcols,1:nlay-1)         , &
 1485.                           relqmcl    , &!              relqmcl        (1:pcols,1:nlay-1)         , &
 1486.                           tauaer     , &!              tauaer         (1:pcols,1:nlay-1,1:nbndsw), &
 1487.                           ssaaer     , &!              ssaaer         (1:pcols,1:nlay-1,1:nbndsw), &
 1488.                           asmaer     , &!              asmaer         (1:pcols,1:nlay-1,1:nbndsw), &
 1489.                           pavel      , &!              pavel          (1:nlay)                   , &
 1490.                           pz         , &!              pz             (0:nlay)                   , &
 1491.                           pdp        , &!              pdp            (1:nlay)                   , &
 1492.                           tavel      , &!              tavel          (1:nlay)                   , &
 1493.                           tz         , &!              tz             (0:nlay)                   , &
 1494.                           tbound     , &!              tbound                                    , &
 1495.                           coldry     , &!              coldry         (1:nlay)                   , &
 1496.                           wkl        , &!              wkl            (1:mxmol,1:nlay)           , &
 1497.                           adjflux    , &!              adjflux           (1:jpband)              , &
 1498.                           inflag     , &!              inflag                                    , &
 1499.                           iceflag    , &!              iceflag                                   , &
 1500.                           liqflag    , &!              liqflag                                   , &
 1501.                           cldfmc     , &!              cldfmc           (1:ngptsw,1:nlay)        , &
 1502.                           taucmc     , &!              taucmc           (1:ngptsw,1:nlay)        , &
 1503.                           ssacmc     , &!              ssacmc           (1:ngptsw,1:nlay)        , &
 1504.                           asmcmc     , &!              asmcmc           (1:ngptsw,1:nlay)        , &
 1505.                           fsfcmc     , &!              fsfcmc           (1:ngptsw,1:nlay)        , &
 1506.                           ciwpmc     , &!              ciwpmc           (1:ngptsw,1:nlay)        , &
 1507.                           clwpmc     , &!              clwpmc           (1:ngptsw,1:nlay)        , &
 1508.                           reicmc     , &!              reicmc           (1:nlay)                 , &
 1509.                           dgesmc     , &!              dgesmc           (1:nlay)                 , &
 1510.                           relqmc     , &!              relqmc           (1:nlay)                 , &
 1511.                           taua       , &!              taua           (1:nlay,1:nbndsw)          , &
 1512.                           ssaa       , &!              ssaa           (1:nlay,1:nbndsw)          , &
 1513.                           asma         )!              asma           (1:nlay,1:nbndsw)            )
 1514.               !***************************************************************************
 1515.               !
 1516.               !  Input atmospheric profile from GCM, and prepare it for use in RRTMG_SW.
 1517.               !  Set other RRTMG_SW input parameters.  
 1518.               !
 1519.               !***************************************************************************
 1520.               
 1521.               ! --------- Modules ----------
 1522.               
 1523.                     use parrrsw, only : nbndsw, ngptsw, nstr, nmol, mxmol, &
 1524.                                         jpband, jpb1, jpb2, rrsw_scon
 1525.                     use rrsw_con, only : heatfac, oneminus, pi, grav, avogad
 1526.                     use rrsw_wvn, only : ng, nspa, nspb, wavenum1, wavenum2, delwave
 1527.               
 1528.               ! ------- Declarations -------
 1529.               
 1530.               ! ----- Input -----
 1531.                     integer, intent(in) :: iplon                      ! column loop index
 1532.                     integer, intent(in) :: pcols
 1533.                     integer, intent(in) :: nlay                       ! number of model layers
 1534.                     integer, intent(in) :: icld                       ! clear/cloud and cloud overlap flag
 1535.                     integer, intent(in) :: iaer                       ! aerosol option flag
 1536.               
 1537.                     real(kind=r8), intent(in) :: play(1:pcols,1:nlay)            ! Layer pressures (hPa, mb)
 1538.                                                                       ! Dimensions: (ncol,nlay)
 1539.                     real(kind=r8), intent(in) :: plev(1:pcols,1:nlay+1)            ! Interface pressures (hPa, mb)
 1540.                                                                       ! Dimensions: (ncol,nlay+1)
 1541.                     real(kind=r8), intent(in) :: tlay(1:pcols,1:nlay)             ! Layer temperatures (K)
 1542.                                                                       ! Dimensions: (ncol,nlay)
 1543.                     real(kind=r8), intent(in) :: tlev(1:pcols,1:nlay+1)            ! Interface temperatures (K)
 1544.                                                                       ! Dimensions: (ncol,nlay+1)
 1545.                     real(kind=r8), intent(in) :: tsfc(1:pcols)              ! Surface temperature (K)
 1546.                                                                       ! Dimensions: (ncol)
 1547.                     real(kind=r8), intent(in) :: h2ovmr(1:pcols,1:nlay)           ! H2O volume mixing ratio
 1548.                                                                       ! Dimensions: (ncol,nlay)
 1549.                     real(kind=r8), intent(in) :: o3vmr(1:pcols,1:nlay)            ! O3 volume mixing ratio
 1550.                                                                       ! Dimensions: (ncol,nlay)
 1551.                     real(kind=r8), intent(in) :: co2vmr(1:pcols,1:nlay)           ! CO2 volume mixing ratio
 1552.                                                                       ! Dimensions: (ncol,nlay)
 1553.                     real(kind=r8), intent(in) :: ch4vmr(1:pcols,1:nlay)           ! Methane volume mixing ratio
 1554.                                                                       ! Dimensions: (ncol,nlay)
 1555.                     real(kind=r8), intent(in) :: o2vmr(1:pcols,1:nlay)            ! O2 volume mixing ratio
 1556.                                                                       ! Dimensions: (ncol,nlay)
 1557.                     real(kind=r8), intent(in) :: n2ovmr(1:pcols,1:nlay)          ! Nitrous oxide volume mixing ratio
 1558.                                                                       ! Dimensions: (ncol,nlay)
 1559.               
 1560.                     integer, intent(in) :: dyofyr                     ! Day of the year (used to get Earth/Sun
 1561.                                                                       !  distance if adjflx not provided)
 1562.                     real(kind=r8), intent(in) :: adjes                ! Flux adjustment for Earth/Sun distance
 1563.                     real(kind=r8), intent(in) :: solvar(jpb1:jpb2)    ! Solar constant (Wm-2) scaling per band
 1564.               
 1565.                     integer, intent(in) :: inflgsw                    ! Flag for cloud optical properties
 1566.                     integer, intent(in) :: iceflgsw                   ! Flag for ice particle specification
 1567.                     integer, intent(in) :: liqflgsw                   ! Flag for liquid droplet specification
 1568.               
 1569.                     real(kind=r8), intent(in) :: cldfmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud fraction
 1570.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1571.                     real(kind=r8), intent(in) :: taucmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud optical depth (optional)
 1572.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1573.                     real(kind=r8), intent(in) :: ssacmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud single scattering albedo
 1574.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1575.                     real(kind=r8), intent(in) :: asmcmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud asymmetry parameter
 1576.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1577.                     real(kind=r8), intent(in) :: fsfcmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud forward scattering fraction
 1578.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1579.                     real(kind=r8), intent(in) :: ciwpmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud ice water path (g/m2)
 1580.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1581.                     real(kind=r8), intent(in) :: clwpmcl(1:ngptsw,1:pcols,1:nlay-1)       ! Cloud liquid water path (g/m2)
 1582.                                                                       ! Dimensions: (ngptsw,ncol,nlay)
 1583.                     real(kind=r8), intent(in) :: reicmcl(1:pcols,1:nlay-1)         ! Cloud ice effective radius (microns)
 1584.                                                                       ! Dimensions: (ncol,nlay)
 1585.                     real(kind=r8), intent(in) :: relqmcl(1:pcols,1:nlay-1)         ! Cloud water drop effective radius (microns)
 1586.                                                                       ! Dimensions: (ncol,nlay)
 1587.               
 1588.                     real(kind=r8), intent(in) :: tauaer(1:pcols,1:nlay-1,1:nbndsw)        ! Aerosol optical depth
 1589.                                                                       ! Dimensions: (ncol,nlay,nbndsw)
 1590.                     real(kind=r8), intent(in) :: ssaaer(1:pcols,1:nlay-1,1:nbndsw)        ! Aerosol single scattering albedo
 1591.                                                                       ! Dimensions: (ncol,nlay,nbndsw)
 1592.                     real(kind=r8), intent(in) :: asmaer(1:pcols,1:nlay-1,1:nbndsw)        ! Aerosol asymmetry parameter
 1593.                                                                       ! Dimensions: (ncol,nlay,nbndsw)
 1594.               
 1595.               ! Atmosphere
 1596.               
 1597.                     real(kind=r8), intent(out) :: pavel(1:nlay)            ! layer pressures (mb) 
 1598.                                                                       ! Dimensions: (nlay)
 1599.                     real(kind=r8), intent(out) :: tavel (1:nlay)            ! layer temperatures (K)
 1600.                                                                       ! Dimensions: (nlay)
 1601.                     real(kind=r8), intent(out) :: pz(0:nlay)              ! level (interface) pressures (hPa, mb)
 1602.                                                                       ! Dimensions: (0:nlay)
 1603.                     real(kind=r8), intent(out) :: tz(0:nlay)              ! level (interface) temperatures (K)
 1604.                                                                       ! Dimensions: (0:nlay)
 1605.                     real(kind=r8), intent(out) :: tbound              ! surface temperature (K)
 1606.                     real(kind=r8), intent(out) :: pdp (1:nlay)              ! layer pressure thickness (hPa, mb)
 1607.                                                                       ! Dimensions: (nlay)
 1608.                     real(kind=r8), intent(out) :: coldry(1:nlay)           ! dry air column density (mol/cm2)
 1609.                                                                       ! Dimensions: (nlay)
 1610.                     real(kind=r8), intent(out) :: wkl(1:mxmol,1:nlay)            ! molecular amounts (mol/cm-2)
 1611.                                                                       ! Dimensions: (mxmol,nlay)
 1612.               
 1613.                     real(kind=r8), intent(out) :: adjflux(1:jpband)           ! adjustment for current Earth/Sun distance
 1614.                                                                       ! Dimensions: (jpband)
 1615.               !      real(kind=r8), intent(out) :: solvar(:)           ! solar constant scaling factor from rrtmg_sw
 1616.                                                                       ! Dimensions: (jpband)
 1617.                                                                       !  default value of 1368.22 Wm-2 at 1 AU
 1618.                     real(kind=r8), intent(out) :: taua(1:nlay,1:nbndsw)            ! Aerosol optical depth
 1619.                                                                       ! Dimensions: (nlay,nbndsw)
 1620.                     real(kind=r8), intent(out) :: ssaa(1:nlay,1:nbndsw)            ! Aerosol single scattering albedo
 1621.                                                                       ! Dimensions: (nlay,nbndsw)
 1622.                     real(kind=r8), intent(out) :: asma(1:nlay,1:nbndsw)            ! Aerosol asymmetry parameter
 1623.                                                                       ! Dimensions: (nlay,nbndsw)
 1624.               
 1625.               ! Atmosphere/clouds - cldprop
 1626.                     integer, intent(out) :: inflag                    ! flag for cloud property method
 1627.                     integer, intent(out) :: iceflag                   ! flag for ice cloud properties
 1628.                     integer, intent(out) :: liqflag                   ! flag for liquid cloud properties
 1629.               
 1630.                     real(kind=r8), intent(out) :: cldfmc(1:ngptsw,1:nlay)         ! layer cloud fraction
 1631.                                                                       ! Dimensions: (ngptsw,nlay)
 1632.                     real(kind=r8), intent(out) :: taucmc(1:ngptsw,1:nlay)         ! cloud optical depth (non-delta scaled)
 1633.                                                                       ! Dimensions: (ngptsw,nlay)
 1634.                     real(kind=r8), intent(out) :: ssacmc(1:ngptsw,1:nlay)         ! cloud single scattering albedo (non-delta-scaled)
 1635.                                                                       ! Dimensions: (ngptsw,nlay)
 1636.                     real(kind=r8), intent(out) :: asmcmc(1:ngptsw,1:nlay)         ! cloud asymmetry parameter (non-delta scaled)
 1637.                     real(kind=r8), intent(out) :: fsfcmc(1:ngptsw,1:nlay)         ! cloud forward scattering fraction (non-delta scaled)
 1638.                                                                       ! Dimensions: (ngptsw,nlay)
 1639.                     real(kind=r8), intent(out) :: ciwpmc(1:ngptsw,1:nlay)         ! cloud ice water path
 1640.                                                                       ! Dimensions: (ngptsw,nlay)
 1641.                     real(kind=r8), intent(out) :: clwpmc(1:ngptsw,1:nlay)         ! cloud liquid water path
 1642.                                                                       ! Dimensions: (ngptsw,nlay)
 1643.                     real(kind=r8), intent(out) :: reicmc(1:nlay)           ! cloud ice particle effective radius
 1644.                                                                       ! Dimensions: (nlay)
 1645.                     real(kind=r8), intent(out) :: dgesmc(1:nlay)           ! cloud ice particle effective radius
 1646.                                                                       ! Dimensions: (nlay)
 1647.                     real(kind=r8), intent(out) :: relqmc(1:nlay)           ! cloud liquid particle size
 1648.                                                                       ! Dimensions: (nlay)
 1649.               
 1650.               ! ----- Local -----
 1651.                     real(kind=r8), parameter :: amd = 28.9660_r8      ! Effective molecular weight of dry air (g/mol)
 1652.                     real(kind=r8), parameter :: amw = 18.0160_r8      ! Molecular weight of water vapor (g/mol)
 1653.               !      real(kind=r8), parameter :: amc = 44.0098_r8      ! Molecular weight of carbon dioxide (g/mol)
 1654.               !      real(kind=r8), parameter :: amo = 47.9998_r8      ! Molecular weight of ozone (g/mol)
 1655.               !      real(kind=r8), parameter :: amo2 = 31.9999_r8     ! Molecular weight of oxygen (g/mol)
 1656.               !      real(kind=r8), parameter :: amch4 = 16.0430_r8    ! Molecular weight of methane (g/mol)
 1657.               !      real(kind=r8), parameter :: amn2o = 44.0128_r8    ! Molecular weight of nitrous oxide (g/mol)
 1658.               
 1659.               ! Set molecular weight ratios (for converting mmr to vmr)
 1660.               !  e.g. h2ovmr = h2ommr * amdw)
 1661.                     real(kind=r8), parameter :: amdw = 1.607793_r8    ! Molecular weight of dry air / water vapor
 1662.                     real(kind=r8), parameter :: amdc = 0.658114_r8    ! Molecular weight of dry air / carbon dioxide
 1663.                     real(kind=r8), parameter :: amdo = 0.603428_r8    ! Molecular weight of dry air / ozone
 1664.                     real(kind=r8), parameter :: amdm = 1.805423_r8    ! Molecular weight of dry air / methane
 1665.                     real(kind=r8), parameter :: amdn = 0.658090_r8    ! Molecular weight of dry air / nitrous oxide
 1666.               
 1667.                     real(kind=r8), parameter :: sbc = 5.67e-08_r8     ! Stefan-Boltzmann constant (W/m2K4)
 1668.               
 1669.                     integer :: isp, l, ix, n, imol, ib, ig   ! Loop indices
 1670.                     real(kind=r8) :: amm, summol                      ! 
 1671.                     real(kind=r8) :: adjflx                           ! flux adjustment for Earth/Sun distance
 1672.               !      real(kind=r8) :: earth_sun                        ! function for Earth/Sun distance adjustment
 1673.               !      real(kind=r8) :: solar_band_irrad(jpb1:jpb2) ! rrtmg assumed-solar irradiance in each sw band
 1674.               
 1675.               !  Initialize all molecular amounts to zero here, then pass input amounts
 1676.               !  into RRTM array WKL below.
 1677.               
 1678.  VC--------<>        wkl(:,:) = 0.0_r8
 1679.  VC--------<>        cldfmc(:,:) = 0.0_r8
 1680.  VC--------<>        taucmc(:,:) = 0.0_r8
 1681.  VC--------<>        ssacmc(:,:) = 1.0_r8
 1682.  VC--------<>        asmcmc(:,:) = 0.0_r8
 1683.  VC--------<>        fsfcmc(:,:) = 0.0_r8
 1684.  VC--------<>        ciwpmc(:,:) = 0.0_r8
 1685.  VC--------<>        clwpmc(:,:) = 0.0_r8
 1686.  V---------<>        reicmc(:) = 0.0_r8
 1687.  V---------<>        dgesmc(:) = 0.0_r8
 1688.  V---------<>        relqmc(:) = 0.0_r8
 1689.  VC--------<>        taua(:,:) = 0.0_r8
 1690.  VC--------<>        ssaa(:,:) = 1.0_r8
 1691.  VC--------<>        asma(:,:) = 0.0_r8
 1692.                
 1693.               ! Set flux adjustment for current Earth/Sun distance (two options).
 1694.               ! 1) Use Earth/Sun distance flux adjustment provided by GCM (input as adjes);
 1695.                     adjflx = adjes
 1696.               !
 1697.               ! 2) Calculate Earth/Sun distance from DYOFYR, the cumulative day of the year.
 1698.               !    (Set adjflx to 1. to use constant Earth/Sun distance of 1 AU). 
 1699.                     if (dyofyr .gt. 0) then
 1700.                        adjflx = earth_sun(dyofyr)
 1701.                     endif
 1702.               
 1703.               ! Set incoming solar flux adjustment to include adjustment for
 1704.               ! current Earth/Sun distance (ADJFLX) and scaling of default internal
 1705.               ! solar constant (rrsw_scon = 1368.22 Wm-2) by band (SOLVAR).  SOLVAR can be set 
 1706.               ! to a single scaling factor as needed, or to a different value in each 
 1707.               ! band, which may be necessary for paleoclimate simulations. 
 1708.               ! 
 1709.               
 1710.  V---------<>       adjflux(:) = 0._r8
 1711.  1----------<       do ib = jpb1,jpb2
 1712.  1                     adjflux(ib) = adjflx * solvar(ib)
 1713.  1---------->       enddo
 1714.               
 1715.               !  Set surface temperature.
 1716.                     tbound = tsfc(iplon)
 1717.               
 1718.               !  Install input GCM arrays into RRTMG_SW arrays for pressure, temperature,
 1719.               !  and molecular amounts.  
 1720.               !  Pressures are input in mb, or are converted to mb here.
 1721.               !  Molecular amounts are input in volume mixing ratio, or are converted from 
 1722.               !  mass mixing ratio (or specific humidity for h2o) to volume mixing ratio
 1723.               !  here. These are then converted to molecular amount (molec/cm2) below.  
 1724.               !  The dry air column COLDRY (in molec/cm2) is calculated from the level 
 1725.               !  pressures, pz (in mb), based on the hydrostatic equation and includes a 
 1726.               !  correction to account for h2o in the layer.  The molecular weight of moist 
 1727.               !  air (amm) is calculated for each layer.  
 1728.               !  Note: In RRTMG, layer indexing goes from bottom to top, and coding below
 1729.               !  assumes GCM input fields are also bottom to top. Input layer indexing
 1730.               !  from GCM fields should be reversed here if necessary.
 1731.               
 1732.                     pz(0) = plev(iplon,nlay+1)
 1733.                     tz(0) = tlev(iplon,nlay+1)
 1734.  1----------<       do l = 1, nlay
 1735.  1                     pavel(l) = play(iplon,nlay-l+1)
 1736.  1                     tavel(l) = tlay(iplon,nlay-l+1)
 1737.  1                     pz(l) = plev(iplon,nlay-l+1)
 1738.  1                     tz(l) = tlev(iplon,nlay-l+1)
 1739.  1                     pdp(l) = pz(l-1) - pz(l)
 1740.  1            ! For h2o input in vmr:
 1741.  1                     wkl(1,l) = h2ovmr(iplon,nlay-l+1)
 1742.  1            ! For h2o input in mmr:
 1743.  1            !         wkl(1,l) = h2o(iplon,nlayers-l)*amdw
 1744.  1            ! For h2o input in specific humidity;
 1745.  1            !         wkl(1,l) = (h2o(iplon,nlayers-l)/(1._r8 - h2o(iplon,nlayers-l)))*amdw
 1746.  1                     wkl(2,l) = co2vmr(iplon,nlay-l+1)
 1747.  1                     wkl(3,l) = o3vmr(iplon,nlay-l+1)
 1748.  1                     wkl(4,l) = n2ovmr(iplon,nlay-l+1)
 1749.  1                     wkl(6,l) = ch4vmr(iplon,nlay-l+1)
 1750.  1                     wkl(7,l) = o2vmr(iplon,nlay-l+1) 
 1751.  1                     amm = (1._r8 - wkl(1,l)) * amd + wkl(1,l) * amw            
 1752.  1                     coldry(l) = (pz(l-1)-pz(l)) * 1.e3_r8 * avogad / &
 1753.  1                                 (1.e2_r8 * grav * amm * (1._r8 + wkl(1,l)))
 1754.  1---------->       enddo
 1755.               
 1756.                     coldry(nlay) = (pz(nlay-1)) * 1.e3_r8 * avogad / &
 1757.                                       (1.e2_r8 * grav * amm * (1._r8 + wkl(1,nlay-1)))
 1758.               
 1759.               ! At this point all molecular amounts in wkl are in volume mixing ratio; 
 1760.               ! convert to molec/cm2 based on coldry for use in rrtm.  
 1761.               
 1762.  1----------<       do l = 1, nlay
 1763.  1 2--------<          do imol = 1, nmol
 1764.  1 2                      wkl(imol,l) = coldry(l) * wkl(imol,l)
 1765.  1 2-------->          enddo
 1766.  1---------->       enddo
 1767.               
 1768.               ! Transfer aerosol optical properties to RRTM variables;
 1769.               ! modify to reverse layer indexing here if necessary.
 1770.               
 1771.                     if (iaer .ge. 1) then 
 1772.  i----------<          do l = 1, nlay-1
 1773.  i i--------<             do ib = 1, nbndsw
 1774.  i i                         taua(l,ib) = tauaer(iplon,nlay-l,ib)
 1775.  i i                         ssaa(l,ib) = ssaaer(iplon,nlay-l,ib)
 1776.  i i                         asma(l,ib) = asmaer(iplon,nlay-l,ib)
 1777.  i i-------->             enddo
 1778.  i---------->          enddo
 1779.                     endif
 1780.               
 1781.               ! Transfer cloud fraction and cloud optical properties to RRTM variables;
 1782.               ! modify to reverse layer indexing here if necessary.
 1783.               
 1784.                     if (icld .ge. 1) then 
 1785.                        inflag = inflgsw
 1786.                        iceflag = iceflgsw
 1787.                        liqflag = liqflgsw
 1788.               
 1789.               ! Move incoming GCM cloud arrays to RRTMG cloud arrays.
 1790.               ! For GCM input, incoming reice is in effective radius; for Fu parameterization (iceflag = 3)
 1791.               ! convert effective radius to generalized effective size using method of Mitchell, JAS, 2002:
 1792.               
 1793.  1----------<          do l = 1, nlay-1
 1794.  1 2--------<             do ig = 1, ngptsw
 1795.  1 2                         cldfmc(ig,l) = cldfmcl(ig,iplon,nlay-l)
 1796.  1 2                         taucmc(ig,l) = taucmcl(ig,iplon,nlay-l)
 1797.  1 2                         ssacmc(ig,l) = ssacmcl(ig,iplon,nlay-l)
 1798.  1 2                         asmcmc(ig,l) = asmcmcl(ig,iplon,nlay-l)
 1799.  1 2                         fsfcmc(ig,l) = fsfcmcl(ig,iplon,nlay-l)
 1800.  1 2                         ciwpmc(ig,l) = ciwpmcl(ig,iplon,nlay-l)
 1801.  1 2                         clwpmc(ig,l) = clwpmcl(ig,iplon,nlay-l)
 1802.  1 2-------->             enddo
 1803.  1                        reicmc(l) = reicmcl(iplon,nlay-l)
 1804.  1                        if (iceflag .eq. 3) then
 1805.  1                           dgesmc(l) = 1.5396_r8 * reicmcl(iplon,nlay-l)
 1806.  1                        endif
 1807.  1                        relqmc(l) = relqmcl(iplon,nlay-l)
 1808.  1---------->          enddo
 1809.               
 1810.               ! If an extra layer is being used in RRTMG, set all cloud properties to zero in the extra layer.
 1811.               
 1812.  V---------<>          cldfmc(:,nlay) = 0.0_r8
 1813.  V---------<>          taucmc(:,nlay) = 0.0_r8
 1814.  V---------<>          ssacmc(:,nlay) = 1.0_r8
 1815.  V---------<>          asmcmc(:,nlay) = 0.0_r8
 1816.  V---------<>          fsfcmc(:,nlay) = 0.0_r8
 1817.  V---------<>          ciwpmc(:,nlay) = 0.0_r8
 1818.  V---------<>          clwpmc(:,nlay) = 0.0_r8
 1819.                        reicmc(nlay) = 0.0_r8
 1820.                        dgesmc(nlay) = 0.0_r8
 1821.                        relqmc(nlay) = 0.0_r8
 1822.                        taua(nlay,:) = 0.0_r8
 1823.                        ssaa(nlay,:) = 1.0_r8
 1824.                        asma(nlay,:) = 0.0_r8
 1825.                    
 1826.                     endif
 1827.               
 1828.                     end subroutine inatm_sw
ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Local variable "SUMMOL" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Local variable "ISP" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Local variable "N" is declared but neither defined nor used.

ftn-5002 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Local variable "IX" is declared but neither defined nor used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "SBC" is not used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "AMDM" is not used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "AMDW" is not used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "AMDC" is not used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "AMDO" is not used.

ftn-5008 ftn: NOTE File = rrtmg_sw_rad.f90, Line = 1828 
  Named Constant "AMDN" is not used.

 1829.               !tar begin
 1830.               !  Vertical interpolation of Climate Aerosol (Kinne, 2013) (coarse mode)
 1831.               !   4 subroutines:
 1832.               !  
 1833.                         subroutine zplev(pl,tl,top,n, zlev,dz)
 1834.               !
 1835.               !  written by Tarasova, Pisnitchenko, July 2015
 1836.               !  Calculates heights and depth of the model layers 
 1837.               !  using model level pressure and layer temperature  
 1838.               !  INPUT:
 1839.               !  pl...model level pressure in Pa from surface
 1840.               !  tl...model layer temperature in K from surface
 1841.               !  top...model topography in m 
 1842.               !  n....model number of layers
 1843.               !  OUTPUT:
 1844.               !  zlev...model level heights in m from surface
 1845.               !  dz...model layer depth (m) from surface
 1846.               !
 1847.                     Implicit none
 1848.                 INTEGER, PARAMETER :: r8 = SELECTED_REAL_KIND(15)      
 1849.                 INTEGER         , INTENT(IN   ) :: n
 1850.                 REAL(KIND=r8)   , INTENT(IN   ) :: top
 1851.                 REAL(KIND=r8)   , INTENT(IN   ) :: pl(n+1)  
 1852.                 REAL(KIND=r8)   , INTENT(IN   ) :: tl(n)    
 1853.                 REAL(KIND=r8)   , INTENT(OUT  ) :: zlev(n+1) 
 1854.                 REAL(KIND=r8)   , INTENT(OUT  ) :: dz(n)     
 1855.               ! working  var  
 1856.                 REAL(KIND=r8)   , PARAMETER ::  RG=287.04
 1857.                 REAL(KIND=r8)   , PARAMETER ::  gt=9.80665
 1858.                 INTEGER :: k
 1859.               !
 1860.               !  
 1861.                 zlev(1)=top
 1862.  1----------<   do k=2,n+1
 1863.  1               dz(k-1)= (RG*tl(k-1)/gt)*(log(pl(k-1))-log(pl(k)))
 1864.  1                  zlev(k)=zlev(k-1)+ dz(k-1)
 1865.  1---------->   enddo 
 1866.                   end subroutine zplev      
 1867.               !
 1868.               !
 1869.               !
 1870.                   subroutine zaero(ep,m, f,h)  
 1871.               !
 1872.               ! written by Tarasova, Pisnitchenko, July 2015
 1873.               ! Calculates Climate Aerosol extinction at new levels
 1874.               ! from Climate Aerosol extinction of (Kinne, 2013)
 1875.               ! INPUT:
 1876.               ! ep.....Climate Aerosol extinction in 40 layers from bottom
 1877.               ! m=40... Number of layers in Climate aerosol of Kinne, 2013
 1878.               !
 1879.               !  OUTPUT:
 1880.               !  f......Climate Aerosol extinction at 42 levels from bottom
 1881.               !  h......Climate Aerosol Height of 41 levels from bottom
 1882.               ! 
 1883.                   Implicit none
 1884.                 INTEGER, PARAMETER :: r8 = SELECTED_REAL_KIND(15)  
 1885.                 REAL(KIND=r8)   , INTENT(IN   ) :: ep(m) 
 1886.                 INTEGER         , INTENT(IN   ) :: m
 1887.                 REAL(KIND=r8)   , INTENT(OUT   ) :: f(m+2) 
 1888.                 REAL(KIND=r8)   , INTENT(OUT   ) :: h(m+1)     
 1889.               ! working var  
 1890.                 INTEGER :: i 
 1891.                 REAL(KIND=r8)   , PARAMETER ::  dd=500.0
 1892.               !
 1893.                  f(1)=ep(1)
 1894.  1----------<   do i=1,m
 1895.  1               f(i+1)=ep(i)
 1896.  1---------->   enddo
 1897.               !   f(m+2)=ep(m)
 1898.                   f(m+2)=0.0
 1899.               !   
 1900.                   h(1)=0.0
 1901.  1----------<    do i=1,m
 1902.  1                h(i+1)=h(i)+dd
 1903.  1---------->    enddo 
 1904.                  end subroutine zaero
 1905.               !
 1906.               !
 1907.               !     
 1908.                        subroutine aeros_interp(zlev,h,f,m,n, fp)
 1909.               !
 1910.               !    written by Tarasova, Pisnitchenko, July 2015
 1911.               ! Calculates interpolation of aerosol extinction for the model layers
 1912.               !   INPUT:
 1913.               !   zlev....height (m) of model levels from surface
 1914.               !   h......height (m) of Climate Aerosol at 41 levels from surface
 1915.               !   f......Climate Aerosol extinction at 42 levels from surface
 1916.               !   m......=40 number of Climate Aerosol layers (Kinne, 2013
 1917.               !   n......number of model layers
 1918.               !   OUTPUT:
 1919.               !   fp.....aerosol extinction (1/m) in model layers from surface
 1920.               !
 1921.                      Implicit none      
 1922.               !
 1923.                 INTEGER, PARAMETER :: r8 = SELECTED_REAL_KIND(15)
 1924.                 REAL(KIND=r8)   , INTENT(IN   ) :: zlev(n+1) 
 1925.                 REAL(KIND=r8)   , INTENT(IN   ) :: h(m+1)
 1926.                 REAL(KIND=r8)   , INTENT(IN   ) :: f(m+2) 
 1927.                 INTEGER         , INTENT(IN   ) :: m,n  
 1928.                 REAL(KIND=r8)   , INTENT(OUT  ) :: fp(n) 
 1929.               ! working var                   
 1930.                 REAL(KIND=r8)   , PARAMETER ::  dd=500.0
 1931.                 REAL(KIND=r8) ::dz1,dz2,di,fi1,fi2,fi
 1932.                 INTEGER :: j,i,k,i1,i2,ik
 1933.               !
 1934.                 i=1
 1935.  1----------<  do j=1,n
 1936.  1              If(zlev(j) > h(m+1)) then
 1937.  1              fp(j)=f(m+2)
 1938.  1               else
 1939.  1 2--------<   do while(zlev(j) > h(i))
 1940.  1 2            i=i+1
 1941.  1 2-------->    enddo
 1942.  1                i1=i
 1943.  1            !    
 1944.  1               If(zlev(j+1) > h(m+1)) then
 1945.  1               dz1=(h(i2)-zlev(j))/dd
 1946.  1               dz2=(zlev(j+1)-h(m+1))/dd
 1947.  1               fi1=f(i2)*dz1
 1948.  1               fi=0.0
 1949.  1 2--------<    do k=1,(m+1)-i2
 1950.  1 2              fi=fi+f(i2+k)
 1951.  1 2-------->    enddo
 1952.  1               fi2=f(m+2)*dz2
 1953.  1               fi=fi+fi1+fi2
 1954.  1               di=dz1+dz2+(m+1-i2)*1.0
 1955.  1               fp(j)=fi/di
 1956.  1               else   
 1957.  1            !       
 1958.  1 2--------<   do while(zlev(j+1) > h(i))
 1959.  1 2              i=i+1
 1960.  1 2-------->    enddo
 1961.  1               i2=i
 1962.  1            !   
 1963.  1              dz1=h(i1)-zlev(j)
 1964.  1              dz2=h(i2)-zlev(j+1)
 1965.  1              dz2=dd-dz2
 1966.  1              dz1=dz1/dd
 1967.  1              dz2=dz2/dd
 1968.  1              fi1=f(i1)*dz1
 1969.  1                fi=0.0
 1970.  1                ik=0
 1971.  1 2--------<    do k=1,i2-i1-1
 1972.  1 2              fi=fi+f(i1+k)
 1973.  1 2              ik=ik+1
 1974.  1 2-------->    enddo
 1975.  1               fi2=f(i2)*dz2
 1976.  1               fi=fi+fi1+fi2
 1977.  1               di=dz1+dz2+ik*1.0
 1978.  1               fp(j)=fi/di
 1979.  1            !
 1980.  1                endif
 1981.  1               endif 
 1982.  1---------->   enddo
 1983.                 end subroutine aeros_interp
 1984.               !
 1985.               !  
 1986.                         subroutine  aod_n(fp,dz,n,od_n)
 1987.               !
 1988.               !    written by Tarasova, Pisnitchenko, July 2015
 1989.               ! Calculates total aerosol optical depth in all layers
 1990.               ! and normalized optical depth in each model layer from surface
 1991.               !
 1992.               !   INPUT:
 1993.               !  fp...extinction (1/m) in each model layer from surface
 1994.               !  dz...depth (m) of each model layer from surface
 1995.               !  n...number of model layers 
 1996.               !
 1997.               !   OUTPUT:
 1998.               !  od_n...normalized aerosol optical depth in each layer from surface 
 1999.               !
 2000.                        Implicit none
 2001.               !         
 2002.               !
 2003.                INTEGER, PARAMETER :: r8 = SELECTED_REAL_KIND(15)       
 2004.                REAL(KIND=r8)   , INTENT(IN   ) :: fp(n)  
 2005.                REAL(KIND=r8)   , INTENT(IN   ) :: dz(n) 
 2006.                REAL(KIND=r8)   , INTENT(OUT   ) :: od_n(n) 
 2007.                INTEGER   , INTENT(IN   )  :: n
 2008.               ! working var
 2009.                 REAL(KIND=r8) :: a
 2010.                 Integer :: i
 2011.               !
 2012.               !
 2013.                   a=0.0
 2014.  1----------<   do i=1,n
 2015.  1              a=a+fp(i)*dz(i)
 2016.  1---------->    enddo
 2017.               !      
 2018.  1----------<      do i=1,n
 2019.  1               od_n(i)=(fp(i)*dz(i))/a
 2020.  1---------->    enddo
 2021.                  end subroutine aod_n
 2022.               
 2023.               !tar end
 2024.                     end module rrtmg_sw_rad

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 649 
  A loop nest at line 649 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 649 
  A loop starting at line 649 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 650 
  A loop nest at line 650 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 650 
  A loop starting at line 650 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 651 
  A loop nest at line 651 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 651 
  A loop starting at line 651 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 652 
  A loop nest at line 652 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 652 
  A loop starting at line 652 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 653 
  A loop nest at line 653 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 653 
  A loop starting at line 653 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 655 
  A loop starting at line 655 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 656 
  A loop starting at line 656 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 657 
  A loop starting at line 657 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 658 
  A loop nest at line 658 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 658 
  A loop starting at line 658 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 659 
  A loop nest at line 659 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 659 
  A loop starting at line 659 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 660 
  A loop starting at line 660 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 662 
  A loop starting at line 662 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 665 
  A loop starting at line 665 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 668 
  A loop nest at line 668 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 668 
  A loop starting at line 668 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 669 
  A loop nest at line 669 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 669 
  A loop starting at line 669 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 670 
  A loop nest at line 670 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 670 
  A loop starting at line 670 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 671 
  A loop nest at line 671 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 671 
  A loop starting at line 671 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 673 
  A loop nest at line 673 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 673 
  A loop starting at line 673 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 675 
  A loop nest at line 675 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 675 
  A loop starting at line 675 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 677 
  A loop nest at line 677 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 677 
  A loop starting at line 677 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 678 
  A loop starting at line 678 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 679 
  A loop starting at line 679 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 681 
  A loop starting at line 681 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 682 
  A loop starting at line 682 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 685 
  A loop starting at line 685 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 686 
  A loop starting at line 686 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 691 
   A loop nest at line 691 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 691 
  A loop starting at line 691 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 692 
   A loop nest at line 692 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 692 
  A loop starting at line 692 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 722 
  A loop nest at line 722 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 722 
  A loop starting at line 722 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 725 
  A loop nest at line 725 was partially collapsed.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 727 
  A loop nest at line 727 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 729 
  A loop starting at line 729 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 730 
  A loop nest at line 730 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 730 
  A loop starting at line 730 was vectorized.

ftn-6067 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 732 
  A loop nest at line 732 was partially collapsed.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 732 
  A loop starting at line 732 was vectorized.

ftn-6007 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 785 
  A loop starting at line 785 was interchanged with the loop starting at line 786.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 785 
  A loop starting at line 785 was blocked with block size 8.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 786 
  A loop starting at line 786 was blocked with block size 8.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 787 
  A loop starting at line 787 was blocked with block size 256.

ftn-6007 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 835 
  A loop starting at line 835 was interchanged with the loop starting at line 836.

ftn-6332 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 968 
  A loop starting at line 968 was not vectorized because it does not map well onto the target architecture.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1086 
   A loop nest at line 1086 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1086 
  A loop starting at line 1086 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1087 
   A loop nest at line 1087 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1087 
  A loop starting at line 1087 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1088 
   A loop nest at line 1088 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1088 
  A loop starting at line 1088 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1089 
   A loop nest at line 1089 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1089 
  A loop starting at line 1089 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1090 
   A loop nest at line 1090 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1090 
  A loop starting at line 1090 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1091 
   A loop nest at line 1091 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1091 
  A loop starting at line 1091 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1092 
   A loop nest at line 1092 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1092 
  A loop starting at line 1092 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1093 
   A loop nest at line 1093 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1093 
  A loop starting at line 1093 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1094 
   A loop nest at line 1094 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1094 
  A loop starting at line 1094 was vectorized.

ftn-6007 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1109 
  A loop starting at line 1109 was interchanged with the loop starting at line 1110.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1109 
  A loop starting at line 1109 was blocked with block size 256.

ftn-6075 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1110 
  A loop starting at line 1110 participated in blocking, but was not itself blocked.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1125 
   A loop nest at line 1125 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1125 
  A loop starting at line 1125 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1126 
   A loop nest at line 1126 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1126 
  A loop starting at line 1126 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1127 
   A loop nest at line 1127 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1127 
  A loop starting at line 1127 was vectorized.

ftn-6003 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1135 
  A loop starting at line 1135 was collapsed into the loop starting at line 1134.

ftn-6007 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1140 
  A loop starting at line 1140 was interchanged with the loop starting at line 1141.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1140 
  A loop starting at line 1140 was blocked with block size 512.

ftn-6049 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1141 
  A loop starting at line 1141 was blocked with block size 8.

ftn-6003 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1165 
  A loop starting at line 1165 was collapsed into the loop starting at line 1164.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1195 
  A loop starting at line 1195 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1196 
  A loop starting at line 1196 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1354 
  A loop starting at line 1354 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1355 
  A loop starting at line 1355 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1678 
   A loop nest at line 1678 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1678 
  A loop starting at line 1678 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1679 
   A loop nest at line 1679 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1679 
  A loop starting at line 1679 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1680 
   A loop nest at line 1680 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1680 
  A loop starting at line 1680 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1681 
   A loop nest at line 1681 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1681 
  A loop starting at line 1681 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1682 
   A loop nest at line 1682 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1682 
  A loop starting at line 1682 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1683 
   A loop nest at line 1683 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1683 
  A loop starting at line 1683 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1684 
   A loop nest at line 1684 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1684 
  A loop starting at line 1684 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1685 
   A loop nest at line 1685 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1685 
  A loop starting at line 1685 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1686 
  A loop starting at line 1686 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1687 
  A loop starting at line 1687 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1688 
  A loop starting at line 1688 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1689 
   A loop nest at line 1689 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1689 
  A loop starting at line 1689 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1690 
   A loop nest at line 1690 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1690 
  A loop starting at line 1690 was vectorized.

ftn-6066 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1691 
   A loop nest at line 1691 collapsed to a single loop.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1691 
  A loop starting at line 1691 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1710 
  A loop starting at line 1710 was vectorized.

ftn-6007 ftn: SCALAR File = rrtmg_sw_rad.f90, Line = 1772 
  A loop starting at line 1772 was interchanged with the loop starting at line 1773.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1812 
  A loop starting at line 1812 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1813 
  A loop starting at line 1813 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1814 
  A loop starting at line 1814 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1815 
  A loop starting at line 1815 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1816 
  A loop starting at line 1816 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1817 
  A loop starting at line 1817 was vectorized.

ftn-6204 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1818 
  A loop starting at line 1818 was vectorized.

ftn-6332 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1822 
  A loop starting at line 1822 was not vectorized because it does not map well onto the target architecture.

ftn-6332 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1823 
  A loop starting at line 1823 was not vectorized because it does not map well onto the target architecture.

ftn-6332 ftn: VECTOR File = rrtmg_sw_rad.f90, Line = 1824 
  A loop starting at line 1824 was not vectorized because it does not map well onto the target architecture.

 2025.               
 2026.               


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
               C r o s s   R e f e r e n c e   for   RRTMG_SW_RAD
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name                            Storage                           Attributes
----                            -------                           ----------

A                               Stack                             REAL(KIND=8)
  Decl    2009
  Set     2013    2015
  Used    2019

ADJES                           Dummy Arg                         REAL(KIND=8), INTENT(IN)
  Decl     129     329
  Set 
  Used     916

ADJES                           Dummy Arg                         REAL(KIND=8), INTENT(IN)
  Decl    1471    1562
  Set 
  Used    1695

ADJFLUX                         Stack                             REAL(KIND=8), DIMENSION(29)
  Decl     489
  Set      658
  Used     942    1225    1293

ADJFLUX                         Dummy Arg                         REAL(KIND=8), DIMENSION(29), INTENT(OUT)
  Decl    1497    1613
  Set     1710    1712
  Used

ADJFLX                          Stack                             REAL(KIND=8)
  Decl    1671
  Set     1695    1700
  Used    1712

AEROS_INTERP                                                      Subroutine, Module procedure
  Decl    1908
  Set 
  Used       0     765

ALBDIF                          Stack                             REAL(KIND=8), DIMENSION(14)
  Decl     493
  Set      658    1068    1071    1075    1079
  Used    1212    1280

ALBDIR                          Stack                             REAL(KIND=8), DIMENSION(14)
  Decl     492
  Set      658    1067    1070    1074    1078
  Used    1213    1281

ALDIF                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     127     324
  Set 
  Used    1068    1071    1075

ALDIR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     126     320
  Set 
  Used    1067    1070    1074

AMD                                                               REAL(KIND=8), PARAMETER
  Decl    1651
  Set 
  Used    1751

AMDC                                                              REAL(KIND=8), PARAMETER
  Decl    1662
  Set 
  Used

AMDM                                                              REAL(KIND=8), PARAMETER
  Decl    1664
  Set 
  Used

AMDN                                                              REAL(KIND=8), PARAMETER
  Decl    1665
  Set 
  Used

AMDO                                                              REAL(KIND=8), PARAMETER
  Decl    1663
  Set 
  Used

AMDW                                                              REAL(KIND=8), PARAMETER
  Decl    1661
  Set 
  Used

AMM                             Stack                             REAL(KIND=8)
  Decl    1670
  Set     1751
  Used    1753    1757

AMW                                                               REAL(KIND=8), PARAMETER
  Decl    1652
  Set 
  Used    1751

AODFSOL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     180     386
  Set 
  Used     792

AODSOL                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     175     381
  Set 
  Used     788

AOD_N                                                             Subroutine, Module procedure
  Decl    1986
  Set 
  Used       0     767

AOD_NORM                        Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     640
  Set      730     772
  Used     788

AOD_NORMF                       Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     644
  Set      732     774
  Used     792

ASDIF                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     125     322
  Set 
  Used    1075    1079

ASDIR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     124     318
  Set 
  Used    1074    1078

ASIN                                                              Function, REAL, INTRINSIC
  Decl
  Set 
  Used     708

ASMA                            Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     497
  Set      659
  Used    1167

ASMA                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(OUT)
  Decl    1513    1622
  Set     1691    1776    1824
  Used

ASMAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(INOUT)
  Decl     154     371
  Set 
  Used

ASMAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(IN)
  Decl    1488    1592
  Set 
  Used    1776

ASMCLOUD                        Stack                             REAL(KIND=8), DIMENSION(<exp>, 29)
  Decl     546
  Set      671
  Used    1103

ASMCMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     558
  Set      669
  Used     949    1011    1114

ASMCMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1504    1636
  Set     1682    1798    1815
  Used

ASMCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     138     344
  Set 
  Used

ASMCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1480    1575
  Set 
  Used    1798

ASMC_SW                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(IN)
  Decl     147     358
  Set 
  Used

ASYAL                           Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     622
  Set      722     818     824
  Used

ASYALC                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     627
  Set      727     806
  Used     825

ASYALF                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     625
  Set      725     808
  Used     824

ASYFSOL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     180     387
  Set 
  Used     808

ASYSOL                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     175     382
  Set 
  Used     806

AVOGAD                          Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set 
  Used    1752    1756

CH4VMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     121     312
  Set 
  Used

CH4VMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1468    1553
  Set 
  Used    1749

CICEWP                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     143     354
  Set 
  Used

CIWPMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     550
  Set      668
  Used     951    1003

CIWPMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1506    1639
  Set     1684    1800    1817
  Used

CIWPMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     140     348
  Set 
  Used

CIWPMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1482    1579
  Set 
  Used    1800

CLD                             Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     142     353
  Set 
  Used     968

CLDFMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     549
  Set      668
  Used     946    1002    1111

CLDFMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1501    1630
  Set     1679    1795    1812
  Used

CLDFMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     135     338
  Set 
  Used

CLDFMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1477    1569
  Set 
  Used    1795

CLDFRAC                         Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     522
  Set      671     968     973
  Used     972     981    1100    1214

CLDPRMC_SW                      Use assoc                         Subroutine, From module RRTMG_SW_CLDPRMC, Module procedure
  Decl
  Set 
  Used     997

CLDPRMC_SW                      Use assoc                         Subroutine, From module RRTMG_SW_CLDPRMC, Module procedure
  Decl
  Set 
  Used     997

CLDPROP_SW                      Use assoc                         Subroutine, From module RRTMG_SW_CLDPROP, Module procedure
  Decl
  Set 
  Used     977

CLDPROP_SW                      Use assoc                         Subroutine, From module RRTMG_SW_CLDPROP, Module procedure
  Decl
  Set 
  Used     977

CLIQWP                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     144     355
  Set 
  Used

CLWPMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     551
  Set      668
  Used     952    1004

CLWPMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1507    1641
  Set     1685    1801    1818
  Used

CLWPMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     141     350
  Set 
  Used

CLWPMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1483    1581
  Set 
  Used    1801

CO2MULT                         Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     514
  Set      660
  Used    1035    1232    1300

CO2VMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     120     310
  Set 
  Used

CO2VMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1467    1551
  Set 
  Used    1746

COLCH4                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     511
  Set      660
  Used    1036    1233    1301

COLCO2                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     508
  Set      659
  Used    1037    1234    1302

COLDRY                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     484
  Set      658
  Used     940    1027    1223    1291

COLDRY                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1495    1608
  Set     1752    1756
  Used    1764

COLH2O                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     507
  Set      659
  Used    1038    1235    1303

COLMOL                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     513
  Set      660
  Used    1039    1236    1304

COLN2O                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     510
  Set      659
  Used    1040    1237    1305

COLO2                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     512
  Set      660
  Used    1041    1238    1306

COLO3                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     509
  Set      659
  Used    1042    1239    1307

COS                                                               Function, REAL, INTRINSIC
  Decl
  Set 
  Used       0    1449

COSSZA                          Stack                             REAL(KIND=8)
  Decl     488
  Set     1058    1059
  Used    1059    1222    1290

COSZEN                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     128     330
  Set 
  Used    1058

DD                                                                REAL(KIND=8), PARAMETER
  Decl    1891
  Set 
  Used    1902

DD                                                                REAL(KIND=8), PARAMETER
  Decl    1930
  Set 
  Used    1945    1946    1965    1966    1967

DGESMC                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     554
  Set      668
  Used     954    1006

DGESMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1509    1645
  Set     1687    1805    1820
  Used

DI                              Stack                             REAL(KIND=8)
  Decl    1931
  Set     1954    1977
  Used    1955    1978

DIFDFLUX                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     599
  Set      688    1360
  Used

DIFDNIR                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     164     410
  Set     1401
  Used

DIFDNIRC                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     168     415
  Set     1406
  Used

DIFDNIRC_LOCAL                  Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     446
  Set      652    1370
  Used    1406

DIFDNIR_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     441
  Set      651    1369
  Used    1401

DIFDNUV                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     163     408
  Set     1399
  Used

DIFDNUVC                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     166     413
  Set     1404
  Used

DIFDNUVC_LOCAL                  Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     444
  Set      652    1365
  Used    1404

DIFDNUV_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     439
  Set      650    1364
  Used    1399

DIRDFLUX                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     598
  Set      687    1359
  Used    1360

DIRDNIR                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     162     409
  Set     1400
  Used

DIRDNIRC                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     167     414
  Set     1405
  Used

DIRDNIRC_LOCAL                  Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     445
  Set      652    1367
  Used    1370    1405

DIRDNIR_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     440
  Set      651    1368
  Used    1369    1400

DIRDNUV                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     161     407
  Set     1398
  Used

DIRDNUVC                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     165     412
  Set     1403
  Used

DIRDNUVC_LOCAL                  Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     443
  Set      652    1362
  Used    1365    1403

DIRDNUV_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     438
  Set      650    1363
  Used    1364    1398

DYOFYR                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl     130     327
  Set 
  Used     917

DYOFYR                          Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1472    1560
  Set 
  Used    1699

DZ                              Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     634
  Set      729
  Used     754     760     767

DZ                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1833    1854
  Set     1863
  Used    1864

DZ                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1986    2005
  Set 
  Used    2015    2019

DZ1                             Stack                             REAL(KIND=8)
  Decl    1931
  Set     1945    1963    1966
  Used    1947    1954    1968    1977

DZ2                             Stack                             REAL(KIND=8)
  Decl    1931
  Set     1946    1964    1965    1967
  Used    1952    1954    1975    1977

EARTH_SUN                                                         Function, REAL(KIND=8), RESULT(EARTH_SUN), Module procedure
  Decl    1427
  Set 
  Used

EARTH_SUN                       Register                          REAL(KIND=8), Function result
  Decl
  Set     1448
  Used

ECAER                           Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 6)
  Decl     374
  Set     1136
  Used    1146    1147    1149

EP                              Stack                             REAL(KIND=8), DIMENSION(40)
  Decl     637
  Set      729     748
  Used     756

EP                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1870    1885
  Set 
  Used    1893    1895

EPF                             Stack                             REAL(KIND=8), DIMENSION(40)
  Decl     641
  Set      732     750
  Used     763

F                               Stack                             REAL(KIND=8), DIMENSION(42)
  Decl     637
  Set      730
  Used     756     758

F                               Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1870    1887
  Set     1893    1895    1898
  Used

F                               Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1908    1926
  Set 
  Used    1937    1947    1950    1952    1968    1972    1975

FAC00                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     525
  Set      665
  Used    1043    1240    1308

FAC01                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     525
  Set      665
  Used    1044    1241    1309

FAC10                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     526
  Set      665
  Used    1045    1242    1310

FAC11                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     526
  Set      665
  Used    1046    1243    1311

FF                              Stack                             REAL(KIND=8), DIMENSION(42)
  Decl     641
  Set      732
  Used     763     765

FI                              Stack                             REAL(KIND=8)
  Decl    1931
  Set     1948    1950    1953    1969    1972    1976
  Used    1955    1978

FI1                             Stack                             REAL(KIND=8)
  Decl    1931
  Set     1947    1968
  Used    1953    1976

FI2                             Stack                             REAL(KIND=8)
  Decl    1931
  Set     1952    1975
  Used    1953    1976

FORFAC                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     520
  Set      662
  Used    1050    1247    1315

FORFRAC                         Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     521
  Set      662
  Used    1051    1248    1316

FP                              Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     638
  Set      730
  Used     758     760

FP                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1908    1928
  Set     1937    1955    1978
  Used

FP                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1986    2004
  Set 
  Used    2015    2019

FPF                             Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     642
  Set      732
  Used     765     767

FSFCMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     559
  Set      669
  Used     950    1012

FSFCMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1505    1637
  Set     1683    1799    1816
  Used

FSFCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     139     346
  Set 
  Used

FSFCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1481    1577
  Set 
  Used    1799

FSFC_SW                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(IN)
  Decl     148     359
  Set 
  Used

GAMMA                           Stack                             REAL(KIND=8)
  Decl    1442
  Set     1444
  Used    1448    1449

GRAV                            Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set 
  Used    1753    1757

GT                                                                REAL(KIND=8), PARAMETER
  Decl    1857
  Set 
  Used    1863

H                               Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1870    1888
  Set     1900    1902
  Used

H                               Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1908    1925
  Set 
  Used    1936    1944    1945    1946    1963    1964

H2OVMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     118     306
  Set 
  Used

H2OVMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1465    1547
  Set 
  Used    1741

HA                              Stack                             REAL(KIND=8), DIMENSION(41)
  Decl     637
  Set      730
  Used     756     758

HAF                             Stack                             REAL(KIND=8), DIMENSION(41)
  Decl     641
  Set      732
  Used     763     765

HEATFAC                         Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set 
  Used    1385

I                               Stack                             INTEGER
  Decl     468
  Set 
  Used     738     742     745     748     750     772     774     788     792     794     795     797     800     801     803
           806     808     814     816     817     818     821     822     824     825     826     838     839     972     973
          1100    1101    1102    1103    1104    1111    1112    1113    1114    1115    1136    1142    1143    1144    1146
          1147    1149    1152    1153    1155    1156    1166    1167    1168    1178    1179    1180    1181    1182    1183
          1184    1185    1186    1187    1188    1189    1190    1191    1193    1194    1195    1196    1350    1351    1352
          1353    1354    1355    1356    1357    1359    1360    1362    1363    1364    1365    1367    1368    1369    1370
          1372    1373    1378    1379    1385    1386    1387    1393    1394    1395    1396    1398    1399    1400    1401
          1403    1404    1405    1406    1408    1409    1413    1414    1418    1419

I                               Stack                             INTEGER
  Decl    1890
  Set 
  Used    1895    1902

I                               Stack                             INTEGER
  Decl    1932
  Set     1934    1940    1959
  Used    1942    1961

I                               Stack                             INTEGER
  Decl    2010
  Set 
  Used    2015    2019

I1                              Stack                             INTEGER
  Decl    1932
  Set     1942
  Used    1963    1968    1971    1972

I2                              Stack                             INTEGER
  Decl    1932
  Set     1961
  Used    1945    1947    1949    1950    1954    1964    1971    1975

IA                              Stack                             INTEGER
  Decl     470
  Set 
  Used    1136    1146    1147    1148    1149    1150

IAER                            Stack                             INTEGER
  Decl     461
  Set      874
  Used     904    1123    1132    1162

IAER                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1459    1535
  Set 
  Used    1771

IB                              Stack                             INTEGER
  Decl     469
  Set 
  Used     788     792     794     795     797     800     801     803     806     808     814     816     817     818     821
           822     824     825     826     838     839    1067    1068    1078    1079    1101    1102    1103    1104    1142
          1143    1144    1146    1147    1148    1149    1150    1152    1153    1155    1156    1166    1167    1168

IB                              Stack                             INTEGER
  Decl    1669
  Set 
  Used    1712    1774    1775    1776

ICEFLAG                         Stack                             INTEGER
  Decl     531
  Set 
  Used     944     979    1000

ICEFLAG                         Dummy Arg                         INTEGER, INTENT(OUT)
  Decl    1499    1627
  Set     1786
  Used    1804

ICEFLGSW                        Dummy Arg                         INTEGER, INTENT(IN)
  Decl     133     335
  Set 
  Used     920

ICEFLGSW                        Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1475    1566
  Set 
  Used    1786

ICLD                            Dummy Arg                         INTEGER, INTENT(INOUT)
  Decl     112     291
  Set      865
  Used     865     903    1084    1096

ICLD                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1458    1534
  Set 
  Used    1784

ICPR                            Stack                             INTEGER
  Decl     459
  Set      712     994    1013
  Used    1204    1272

IDELM                           Stack                             INTEGER
  Decl     462
  Set      881
  Used    1205    1273

IDN                             Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1427    1440
  Set 
  Used    1444

IEND                            Stack                             INTEGER
  Decl     458
  Set      711
  Used    1203    1271

IFAEROS                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     175     380
  Set 
  Used     718

IG                              Stack                             INTEGER
  Decl     470
  Set 
  Used    1111    1112    1113    1114    1115

IG                              Stack                             INTEGER
  Decl    1669
  Set 
  Used    1795    1796    1797    1798    1799    1800    1801

IK                              Stack                             INTEGER
  Decl    1932
  Set     1970    1973
  Used    1977

IMCA                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl     108     287
  Set 
  Used     970    1097    1199

IMOL                            Stack                             INTEGER
  Decl    1669
  Set 
  Used    1764

IMS                             Stack                             INTEGER
  Decl     472
  Set      713
  Used

INATM_SW                                                          Subroutine, Module procedure
  Decl    1454
  Set 
  Used     899

INDFOR                          Stack                             INTEGER, DIMENSION(<exp>)
  Decl     517
  Set      656
  Used    1052    1249    1317

INDSELF                         Stack                             INTEGER, DIMENSION(<exp>)
  Decl     516
  Set      655
  Used    1049    1246    1314

INFLAG                          Stack                             INTEGER
  Decl     530
  Set 
  Used     943     978     999

INFLAG                          Dummy Arg                         INTEGER, INTENT(OUT)
  Decl    1498    1626
  Set     1785
  Used

INFLGSW                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl     132     334
  Set 
  Used     919

INFLGSW                         Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1474    1565
  Set 
  Used    1785

IOUT                            Static offset=0                   INTEGER, INITIALIZED, SAVE
  Decl     460
  Set 
  Used    1206    1274

IPLON                           Stack                             INTEGER
  Decl     467
  Set 
  Used     968    1058    1067    1068    1070    1071    1074    1075    1078    1079    1136    1146    1147    1149    1350
          1351    1352    1353    1354    1355    1360    1362    1363    1364    1365    1367    1368    1369    1370    1372
          1373    1378    1379    1386    1387    1389    1390    1393    1394    1395    1396    1398    1399    1400    1401
          1403    1404    1405    1406    1408    1409    1413    1414    1418    1419

IPLON                           Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1455    1531
  Set 
  Used    1716    1732    1733    1735    1736    1737    1738    1741    1746    1747    1748    1749    1750    1774    1775
          1776    1795    1796    1797    1798    1799    1800    1801    1803    1805    1807

ISCCOS                          Stack                             INTEGER
  Decl     466
  Set 
  Used

ISP                             Stack                             INTEGER
  Decl    1669
  Set 
  Used

ISTART                          Stack                             INTEGER
  Decl     457
  Set      710
  Used    1202    1270

IX                              Stack                             INTEGER
  Decl    1669
  Set 
  Used

J                               Stack                             INTEGER
  Decl     636
  Set 
  Used     748     750

J                               Stack                             INTEGER
  Decl    1932
  Set 
  Used    1936    1937    1944    1945    1946    1955    1963    1964    1978

JP                              Stack                             INTEGER, DIMENSION(<exp>)
  Decl     503
  Set 
  Used    1032    1229    1297

JPB1                            Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1563    1711

JPB1                            Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     710    1101    1102    1103    1104

JPB2                            Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1563    1711

JPB2                            Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     711

JPBAND                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     489     543     544     545     546     942     990     991     992     993    1225    1293

JPBAND                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1613

JT                              Stack                             INTEGER, DIMENSION(<exp>)
  Decl     504
  Set 
  Used    1033    1230    1298

JT1                             Stack                             INTEGER, DIMENSION(<exp>)
  Decl     505
  Set 
  Used    1034    1231    1299

K                               Stack                             INTEGER
  Decl     471
  Set 
  Used     738     742     772     774     788     792     795     797     801     803     806     808     814     816     817
           818     821     822     824     825     826     838     839    1413    1414

K                               Stack                             INTEGER
  Decl    1858
  Set 
  Used    1863    1864

K                               Stack                             INTEGER
  Decl    1932
  Set 
  Used    1950    1972

L                               Stack                             INTEGER
  Decl    1669
  Set 
  Used    1735    1736    1737    1738    1739    1741    1746    1747    1748    1749    1750    1751    1752    1753    1764
          1774    1775    1776    1795    1796    1797    1798    1799    1800    1801    1803    1805    1807

LAYLOW                          Stack                             INTEGER
  Decl     502
  Set 
  Used    1031    1228    1296

LAYSWTCH                        Stack                             INTEGER
  Decl     501
  Set 
  Used    1030    1227    1295

LAYTROP                         Stack                             INTEGER
  Decl     500
  Set 
  Used    1029    1226    1294

LIQFLAG                         Stack                             INTEGER
  Decl     532
  Set 
  Used     945     980    1001

LIQFLAG                         Dummy Arg                         INTEGER, INTENT(OUT)
  Decl    1500    1628
  Set     1787
  Used

LIQFLGSW                        Dummy Arg                         INTEGER, INTENT(IN)
  Decl     134     336
  Set 
  Used     921

LIQFLGSW                        Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1476    1567
  Set 
  Used    1787

LOG                                                               Function, REAL, INTRINSIC
  Decl
  Set 
  Used    1863

M                               Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1870    1886
  Set 
  Used    1885    1887    1888    1894    1898    1901

M                               Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1908    1927
  Set 
  Used    1925    1926    1936    1937    1944    1946    1949    1952    1954

MAX                                                               Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used     973

MCICA_SUBCOL_GEN_SW                                               Module
  Decl
  Set 
  Used      67

MIN                                                               Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used     973

MXMOL                           Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     485     941    1028    1224    1292

MXMOL                           Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1610

N                               Stack                             INTEGER
  Decl    1669
  Set 
  Used

N                               Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1833    1849
  Set 
  Used    1851    1852    1853    1854    1862

N                               Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1908    1927
  Set 
  Used    1924    1928    1935

N                               Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1986    2007
  Set 
  Used    2004    2005    2006    2014    2018

N2OVMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     123     316
  Set 
  Used

N2OVMR                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1470    1557
  Set 
  Used    1748

NAEREC                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     374    1135    1145

NBNDSW                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     332     356     357     358     359     365     368     371     420     421     451     452     492     493     495
           496     497     562     563     564     566     567     568     569     602     603     918     931     932     933
           956     957     958     982     983     984    1070    1071    1099    1141    1165    1212    1213    1215    1216
          1217    1218    1219    1220    1221    1280    1281    1287    1288    1289    1334    1335    1412

NBNDSW                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1588    1590    1592    1618    1620    1622    1773

NCBANDS                         Stack                             INTEGER
  Decl     529
  Set 
  Used

NCOL                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl     110     289
  Set 
  Used     374     622     625     627     640     644     735     787     837     894

NGPTSW                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used     338     340     342     344     346     348     350     549     550     551     555     556     557     558     559
           571     572     573     574     575     922     923     924     925     926     927     928     946     947     948
           949     950     951     952    1002    1003    1004    1008    1009    1010    1011    1012    1110    1282    1283
          1284    1285    1286

NGPTSW                          Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1569    1571    1573    1575    1577    1579    1581    1630    1632    1634    1636    1637    1639    1641    1794

NIDFLX                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     601
  Set      690    1357
  Used

NINFLX                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     169     417
  Set     1408
  Used

NINFLXC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     170     418
  Set     1409
  Used

NINFLXC_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     449
  Set      653    1373
  Used    1409

NINFLX_LOCAL                    Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     448
  Set      653    1372
  Used    1408

NLAY                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl     111     290
  Set 
  Used     296     298     300     302     306     308     310     312     314     316     338     340     342     344     346
           348     350     353     354     355     356     357     358     359     361     363     365     368     371     374
           394     396     398     400     402     404     407     408     409     410     412     413     414     415     417
           418     420     421     425     427     429     431     433     435     438     439     440     441     443     444
           445     446     448     449     451     452     478     479     480     481     483     484     485     495     496
           497     503     504     505     507     508     509     510     511     512     513     514     516     517     518
           519     520     521     522     525     526     543     544     545     546     549     550     551     552     553
           554     555     556     557     558     559     562     563     564     566     567     568     569     571     572
           573     574     575     577     578     579     580     581     582     583     584     585     586     587     588
           589     590     592     593     596     597     598     599     600     601     602     603     622     625     627
           630     631     633     634     638     639     640     642     643     644     737     738     741     742     754
           758     760     765     767     771     772     774     785     835     838     839     902     968     971     998
          1021    1098    1109    1134    1140    1164    1177    1201    1269    1349    1377    1384    1389    1390    1392
          1411    1417

NLAY                            Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1457    1533
  Set 
  Used    1537    1539    1541    1543    1547    1549    1551    1553    1555    1557    1569    1571    1573    1575    1577
          1579    1581    1583    1585    1588    1590    1592    1597    1599    1601    1603    1606    1608    1610    1618
          1620    1622    1630    1632    1634    1636    1637    1639    1641    1643    1645    1647    1732    1733    1734
          1735    1736    1737    1738    1741    1746    1747    1748    1749    1750    1756    1757    1762    1772    1774
          1775    1776    1793    1795    1796    1797    1798    1799    1800    1801    1803    1805    1807    1812    1813
          1814    1815    1816    1817    1818    1819    1820    1821    1822    1823    1824

NMOL                            Use assoc                         INTEGER, PARAMETER, From module PARRRSW
  Decl
  Set 
  Used    1763

O2VMR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     122     314
  Set 
  Used

O2VMR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1469    1555
  Set 
  Used    1750

O3VMR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     119     308
  Set 
  Used

O3VMR                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1466    1549
  Set 
  Used    1747

OD_N                            Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     639
  Set      730
  Used     760     772

OD_N                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1986    2006
  Set     2019
  Used

OD_NF                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     643
  Set      732
  Used     767     774

ONEMINUS                        Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set      707
  Used

PARRRSW                                                           Module
  Decl
  Set 
  Used     278

PARRRSW                                                           Module
  Decl
  Set 
  Used    1523

PAVEL                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     478
  Set      657
  Used     934    1022    1207    1275

PAVEL                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1489    1597
  Set     1735
  Used

PCOLS                           Dummy Arg                         INTEGER, INTENT(IN)
  Decl     109     288
  Set 
  Used     296     298     300     302     304     306     308     310     312     314     316     318     320     322     324
           330     338     340     342     344     346     348     350     353     354     355     356     357     358     359
           361     363     365     368     371     381     382     383     384     385     386     387     388     389     394
           396     398     400     402     404     407     408     409     410     412     413     414     415     417     418
           420     421     425     427     429     431     433     435     438     439     440     441     443     444     445
           446     448     449     451     452     901

PCOLS                           Dummy Arg                         INTEGER, INTENT(IN)
  Decl    1456    1532
  Set 
  Used    1537    1539    1541    1543    1545    1547    1549    1551    1553    1555    1557    1569    1571    1573    1575
          1577    1579    1581    1583    1585    1588    1590    1592

PDP                             Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     483
  Set      658
  Used     936    1385

PDP                             Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1491    1606
  Set     1739
  Used

PI                              Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set      708
  Used

PI                              Use assoc                         REAL(KIND=8), From module RRSW_CON, SAVE
  Decl
  Set 
  Used    1444

PL                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1833    1851
  Set 
  Used    1863

PLAY                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     113     296
  Set 
  Used

PLAY                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1460    1537
  Set 
  Used    1735

PLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     114     298
  Set 
  Used     742

PLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1461    1539
  Set 
  Used    1732    1737

PR                              Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     630
  Set      729     742
  Used     754

PZ                              Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     480
  Set      657
  Used     935    1024    1209    1277

PZ                              Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl    1490    1601
  Set     1732    1737
  Used    1739    1752    1756

R8                                                                INTEGER, PARAMETER, Renames SHR_KIND_R8 in SHR_KIND_MOD
  Decl      63
  Set 
  Used     296     298     300     302     304     306     308     310     312     314     316     318     320     322     324
           329     330     332     338     340     342     344     346     348     350     353     354     355     356     357
           358     359     361     363     365     368     371     374     381     382     383     384     385     386     387
           388     389     394     396     398     400     402     404     407     408     409     410     412     413     414
           415     417     418     420     421     425     427     429     431     433     435     438     439     440     441
           443     444     445     446     448     449     451     452     474     475     478     479     480     481     482
           483     484     485     488     489     492     493     495     496     497     507     508     509     510     511
           512     513     514     518     519     520     521     522     524     543     544     545     546     549     550
           551     552     553     554     555     556     557     558     559     562     563     564     566     567     568
           569     571     572     573     574     575     577     578     579     580     581     582     583     584     585
           586     587     588     589     590     592     593     596     597     598     599     600     601     602     603
           622     625     627     630     631     632     633     634     637     638     639     640     641     642     643
           644    1427    1442    1537    1539    1541    1543    1545    1547    1549    1551    1553    1555    1557    1562
          1563    1569    1571    1573    1575    1577    1579    1581    1583    1585    1588    1590    1592    1597    1599
          1601    1603    1605    1606    1608    1610    1613    1618    1620    1622    1630    1632    1634    1636    1637
          1639    1641    1643    1645    1647    1651    1652    1661    1662    1663    1664    1665    1667    1670    1671

R8                                                                INTEGER, PARAMETER
  Decl    1848
  Set 
  Used    1850    1851    1852    1853    1854    1856    1857

R8                                                                INTEGER, PARAMETER
  Decl    1884
  Set 
  Used    1885    1887    1888    1891

R8                                                                INTEGER, PARAMETER
  Decl    1923
  Set 
  Used    1924    1925    1926    1928    1930    1931

R8                                                                INTEGER, PARAMETER
  Decl    2003
  Set 
  Used    2004    2005    2006    2009

REICMC                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     553
  Set      668
  Used     953    1005

REICMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1508    1643
  Set     1686    1803    1819
  Used

REICMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     150     361
  Set 
  Used

REICMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1484    1583
  Set 
  Used    1803    1805

RELQMC                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     552
  Set      668
  Used     955    1007

RELQMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1510    1647
  Set     1688    1807    1821
  Used

RELQMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     151     363
  Set 
  Used

RELQMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1485    1585
  Set 
  Used    1807

RG                                                                REAL(KIND=8), PARAMETER
  Decl    1856
  Set 
  Used    1863

RRSW_AER                                                          Module
  Decl
  Set 
  Used     280

RRSW_CON                                                          Module
  Decl
  Set 
  Used     281

RRSW_CON                                                          Module
  Decl
  Set 
  Used    1438

RRSW_CON                                                          Module
  Decl
  Set 
  Used    1525

RRSW_VSN                                                          Module
  Decl
  Set 
  Used      66

RRSW_WVN                                                          Module
  Decl
  Set 
  Used     282

RRSW_WVN                                                          Module
  Decl
  Set 
  Used    1526

RRTMG_SW                                                          Subroutine, Module procedure
  Decl      83     107
  Set 
  Used

RRTMG_SW_CLDPRMC                                                  Module
  Decl
  Set 
  Used      69

RRTMG_SW_CLDPROP                                                  Module
  Decl
  Set 
  Used      68

RRTMG_SW_RAD                                                      Module
  Decl      13
  Set 
  Used

RRTMG_SW_SETCOEF                                                  Module
  Decl
  Set 
  Used      73

RRTMG_SW_SPCVMC                                                   Module
  Decl
  Set 
  Used      74

RRTMG_SW_SPCVRT                                                   Module
  Decl
  Set 
  Used      75

RSRASYA                         Use assoc                         REAL(KIND=8), From module RRSW_AER, DIMENSION(14, 6), SAVE
  Decl
  Set 
  Used    1150

RSRPIZA                         Use assoc                         REAL(KIND=8), From module RRSW_AER, DIMENSION(14, 6), SAVE
  Decl
  Set 
  Used    1148    1150

RSRTAUA                         Use assoc                         REAL(KIND=8), From module RRSW_AER, DIMENSION(14, 6), SAVE
  Decl
  Set 
  Used    1146    1147    1149

SBC                                                               REAL(KIND=8), PARAMETER
  Decl    1667
  Set 
  Used

SELECTED_REAL_KIND                                                Function, INTEGER, INTRINSIC
  Decl
  Set 
  Used       0    1848    1923    2003

SELFFAC                         Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     518
  Set      662
  Used    1047    1244    1312

SELFFRAC                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     519
  Set      662
  Used    1048    1245    1313

SETCOEF_SW                      Use assoc                         Subroutine, From module RRTMG_SW_SETCOEF, Module procedure
  Decl
  Set 
  Used    1020

SETCOEF_SW                      Use assoc                         Subroutine, From module RRTMG_SW_SETCOEF, Module procedure
  Decl
  Set 
  Used    1020

SHR_KIND_MOD                                                      Module
  Decl
  Set 
  Used      63

SIN                                                               Function, REAL, INTRINSIC
  Decl
  Set 
  Used       0    1449

SOLVAR                          Dummy Arg                         REAL(KIND=8), DIMENSION(14), INTENT(IN)
  Decl     131     332
  Set 
  Used     918

SOLVAR                          Dummy Arg                         REAL(KIND=8), DIMENSION(16:29), INTENT(IN)
  Decl    1473    1563
  Set 
  Used    1712

SPCVMC_SW                       Use assoc                         Subroutine, From module RRTMG_SW_SPCVMC, Module procedure
  Decl
  Set 
  Used    1267

SPCVMC_SW                       Use assoc                         Subroutine, From module RRTMG_SW_SPCVMC, Module procedure
  Decl
  Set 
  Used    1267

SPCVRT_SW                       Use assoc                         Subroutine, From module RRTMG_SW_SPCVRT, Module procedure
  Decl
  Set 
  Used    1200

SPCVRT_SW                       Use assoc                         Subroutine, From module RRTMG_SW_SPCVRT, Module procedure
  Decl
  Set 
  Used    1200

SSAA                            Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     496
  Set      659
  Used    1168

SSAA                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(OUT)
  Decl    1512    1620
  Set     1690    1775    1823
  Used

SSAAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(INOUT)
  Decl     153     368
  Set      839
  Used

SSAAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(IN)
  Decl    1487    1590
  Set 
  Used    1775

SSAAL                           Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     622
  Set      722     817     821
  Used     839

SSAALC                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     627
  Set      727     795     797
  Used     822     825     826

SSAALF                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     625
  Set      725     801     803
  Used     821     824     826

SSACLOUD                        Stack                             REAL(KIND=8), DIMENSION(<exp>, 29)
  Decl     545
  Set      671
  Used    1104

SSACMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     557
  Set      669
  Used     948    1010    1115

SSACMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1503    1634
  Set     1681    1797    1814
  Used

SSACMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     137     342
  Set 
  Used

SSACMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1479    1573
  Set 
  Used    1797

SSAC_SW                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(IN)
  Decl     146     357
  Set 
  Used

SSAFSOL                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     180     388
  Set 
  Used     800     803

SSASOL                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(IN)
  Decl     175     383
  Set 
  Used     794     797

SUMMOL                          Stack                             REAL(KIND=8)
  Decl    1670
  Set 
  Used

SWDFLX                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     156     396
  Set     1394
  Used

SWDFLXC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     159     402
  Set     1396
  Used

SWDFLXC_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     433
  Set      650    1351
  Used    1378    1396

SWDFLXS                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(INOUT)
  Decl     172     421
  Set     1414
  Used

SWDFLXS_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(14, <exp>, <exp>)
  Decl     452
  Set      653    1355
  Used    1414

SWDFLX_LOCAL                    Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     427
  Set      649    1353
  Used    1360    1379    1394

SWHR                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     157     398
  Set     1419
  Used

SWHRC                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     160     404
  Set     1418
  Used

SWHRC_LOCAL                     Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     435
  Set      650    1386    1389
  Used    1418

SWHR_LOCAL                      Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     429
  Set      649    1387    1390
  Used    1419

SWNFLX                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     596
  Set      685    1379
  Used    1387

SWNFLXC                         Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     597
  Set      686    1378
  Used    1386

SWUFLX                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     155     394
  Set     1393
  Used

SWUFLXC                         Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(INOUT)
  Decl     158     400
  Set     1395
  Used

SWUFLXC_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     431
  Set      649    1350
  Used    1378    1395

SWUFLXS                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(INOUT)
  Decl     171     420
  Set     1413
  Used

SWUFLXS_LOCAL                   Stack                             REAL(KIND=8), DIMENSION(14, <exp>, <exp>)
  Decl     451
  Set      653    1354
  Used    1413

SWUFLX_LOCAL                    Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>)
  Decl     425
  Set      649    1352
  Used    1379    1393

TAORMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     556
  Set      669
  Used    1008    1113

TAUA                            Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     495
  Set      659
  Used    1166

TAUA                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 14), INTENT(OUT)
  Decl    1511    1618
  Set     1689    1774    1822
  Used

TAUAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(INOUT)
  Decl     152     365
  Set      838
  Used

TAUAER                          Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>, 14), INTENT(IN)
  Decl    1486    1588
  Set 
  Used    1774

TAUAL                           Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     622
  Set      722     814
  Used     816     822     838

TAUALC                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     627
  Set      727     788
  Used     814     822     825     826

TAUALF                          Stack                             REAL(KIND=8), DIMENSION(<exp>, <exp>, 14)
  Decl     625
  Set      725     792
  Used     814     821     824     826

TAUCLDORIG                      Stack                             REAL(KIND=8), DIMENSION(<exp>, 29)
  Decl     544
  Set      670
  Used    1102

TAUCLOUD                        Stack                             REAL(KIND=8), DIMENSION(<exp>, 29)
  Decl     543
  Set      670
  Used    1101

TAUCMC                          Stack                             REAL(KIND=8), DIMENSION(112, <exp>)
  Decl     555
  Set      668
  Used     947    1009    1112

TAUCMC                          Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>), INTENT(OUT)
  Decl    1502    1632
  Set     1680    1796    1813
  Used

TAUCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl     136     340
  Set 
  Used

TAUCMCL                         Dummy Arg                         REAL(KIND=8), DIMENSION(112, <exp>, <exp>), INTENT(IN)
  Decl    1478    1571
  Set 
  Used    1796

TAUC_SW                         Dummy Arg                         REAL(KIND=8), DIMENSION(14, <exp>, <exp>), INTENT(IN)
  Decl     145     356
  Set 
  Used

TAVEL                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     479
  Set      657
  Used     937    1023    1208    1276

TAVEL                           Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1492    1599
  Set     1736
  Used

TBOUND                          Stack                             REAL(KIND=8)
  Decl     482
  Set 
  Used     939    1026    1211    1279

TBOUND                          Dummy Arg                         REAL(KIND=8), INTENT(OUT)
  Decl    1494    1605
  Set     1716
  Used

TL                              Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1833    1852
  Set 
  Used    1863

TLAY                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     115     300
  Set 
  Used     738

TLAY                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1462    1541
  Set 
  Used    1736

TLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl     116     302
  Set 
  Used

TLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, <exp>), INTENT(IN)
  Decl    1463    1543
  Set 
  Used    1733    1738

TMP                             Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     631
  Set      729     738
  Used     754

TOP                             Dummy Arg                         REAL(KIND=8), INTENT(IN)
  Decl    1833    1850
  Set 
  Used    1861

TOPOGSOL                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     175     385
  Set 
  Used     745

TPG                             Stack                             REAL(KIND=8)
  Decl     632
  Set      729     745
  Used     754

TSFC                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl     117     304
  Set 
  Used     909

TSFC                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1464    1545
  Set 
  Used    1716

TZ                              Stack                             REAL(KIND=8), DIMENSION(0:<exp>)
  Decl     481
  Set      657
  Used     938    1025    1210    1278

TZ                              Dummy Arg                         REAL(KIND=8), DIMENSION(0:<exp>), INTENT(OUT)
  Decl    1493    1603
  Set     1733    1738
  Used

UVDFLX                          Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     600
  Set      689    1356
  Used

WKL                             Stack                             REAL(KIND=8), DIMENSION(38, <exp>)
  Decl     485
  Set      658
  Used     941    1028    1224    1292

WKL                             Dummy Arg                         REAL(KIND=8), DIMENSION(38, <exp>), INTENT(OUT)
  Decl    1496    1610
  Set     1678    1741    1746    1747    1748    1749    1750    1764
  Used    1751    1753    1757

ZAERO                                                             Subroutine, Module procedure
  Decl    1870
  Set 
  Used       0     763

ZASYA                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     568
  Set      675    1126    1143    1149    1153    1167
  Used

ZASYC                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     564
  Set      673    1088    1103
  Used

ZASYCMC                         Stack                             REAL(KIND=8), DIMENSION(<exp>, 112)
  Decl     574
  Set      677    1093    1114
  Used

ZBBCD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     580
  Set      678    1179
  Used    1252    1320    1351

ZBBCDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     582
  Set      678    1182
  Used    1261    1329

ZBBCU                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     579
  Set      678    1178
  Used    1253    1321    1350

ZBBFD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     578
  Set      677    1181
  Used    1250    1318    1353

ZBBFDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     581
  Set      678    1183
  Used    1260    1328    1359

ZBBFSD                          Stack                             REAL(KIND=8), DIMENSION(14, <exp>)
  Decl     603
  Set      692    1196
  Used    1335    1355

ZBBFSU                          Stack                             REAL(KIND=8), DIMENSION(14, <exp>)
  Decl     602
  Set      691    1195
  Used    1334    1354

ZBBFU                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     577
  Set      677    1180
  Used    1251    1319    1352

ZCLDFMC                         Stack                             REAL(KIND=8), DIMENSION(<exp>, 112)
  Decl     571
  Set      677    1090    1111
  Used

ZDPGCP                          Stack                             REAL(KIND=8)
  Decl     475
  Set     1385
  Used    1386    1387

ZEPSEC                          Stack                             REAL(KIND=8)
  Decl     474
  Set      705
  Used     707    1100

ZEPZEN                          Stack                             REAL(KIND=8)
  Decl     474
  Set      706
  Used    1059

ZLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(OUT)
  Decl    1833    1853
  Set     1861    1864
  Used

ZLEV                            Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>), INTENT(IN)
  Decl    1908    1924
  Set 
  Used    1936    1944    1945    1946    1963    1964

ZLV                             Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     633
  Set      729
  Used     754     758     765

ZNICD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     588
  Set      679    1188
  Used    1257    1325    1370    1373

ZNICDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     590
  Set      679    1190
  Used    1265    1333    1367

ZNICU                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     593
  Set      682    1193
  Used    1259    1327    1373

ZNIFD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     587
  Set      679    1189
  Used    1256    1324    1357    1369    1372

ZNIFDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     589
  Set      679    1191
  Used    1264    1332    1368

ZNIFU                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     592
  Set      681    1194
  Used    1258    1326    1372

ZOMGA                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     569
  Set      675    1127    1144    1147    1156    1168
  Used    1152    1153

ZOMGC                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     566
  Set      675    1089    1104
  Used

ZOMGCMC                         Stack                             REAL(KIND=8), DIMENSION(<exp>, 112)
  Decl     575
  Set      677    1094    1115
  Used

ZPLEV                                                             Subroutine, Module procedure
  Decl    1833
  Set 
  Used     754

ZTAORMC                         Stack                             REAL(KIND=8), DIMENSION(<exp>, 112)
  Decl     573
  Set      677    1092    1113
  Used

ZTAUA                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     567
  Set      675    1125    1142    1146    1166
  Used    1155    1156

ZTAUC                           Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     562
  Set      673    1086    1101
  Used

ZTAUCMC                         Stack                             REAL(KIND=8), DIMENSION(<exp>, 112)
  Decl     572
  Set      677    1091    1112
  Used

ZTAUCORIG                       Stack                             REAL(KIND=8), DIMENSION(<exp>, 14)
  Decl     563
  Set      673    1087    1102
  Used

ZUVCD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     584
  Set      678    1184
  Used    1255    1323    1365

ZUVCDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     586
  Set      679    1186
  Used    1263    1331    1362

ZUVFD                           Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     583
  Set      678    1185
  Used    1254    1322    1356    1364

ZUVFDDIR                        Stack                             REAL(KIND=8), DIMENSION(<exp>)
  Decl     585
  Set      679    1187
  Used    1262    1330    1363

Z_AERFSOL                       Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 40), INTENT(IN)
  Decl     180     389
  Set 
  Used     750

Z_AERSOL                        Dummy Arg                         REAL(KIND=8), DIMENSION(<exp>, 40), INTENT(IN)
  Decl     175     384
  Set 
  Used     748


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
AEROS_INTERP in RRTMG_SW_RAD
      Defined as:  Subroutine (line 1908, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   AEROS_INTERP in RRTMG_SW_RAD (Line 758, file rrtmg_sw_rad.f90)
                   AEROS_INTERP in RRTMG_SW_RAD (Line 765, file rrtmg_sw_rad.f90)

      Calls:       AEROS_INTERP in RRTMG_SW_RAD (Line 758, file rrtmg_sw_rad.f90)
                   AEROS_INTERP in RRTMG_SW_RAD (Line 765, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
AOD_N in RRTMG_SW_RAD
      Defined as:  Subroutine (line 1986, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 760, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 767, file rrtmg_sw_rad.f90)

      Calls:       SELECTED_REAL_KIND(Intrinsic) (Line 1848, file rrtmg_sw_rad.f90)
                   SELECTED_REAL_KIND(Intrinsic) (Line 1884, file rrtmg_sw_rad.f90)
                   SELECTED_REAL_KIND(Intrinsic) (Line 1923, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 760, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 767, file rrtmg_sw_rad.f90)
                   SELECTED_REAL_KIND(Intrinsic) (Line 2003, file rrtmg_sw_rad.f90)
                   ASIN(Intrinsic) (Line 708, file rrtmg_sw_rad.f90)
                   MAX(Intrinsic) (Line 973, file rrtmg_sw_rad.f90)
                   MIN(Intrinsic) (Line 973, file rrtmg_sw_rad.f90)
                   COS(Intrinsic) (Line 1448, file rrtmg_sw_rad.f90)
                   COS(Intrinsic) (Line 1449, file rrtmg_sw_rad.f90)
                   SIN(Intrinsic) (Line 1448, file rrtmg_sw_rad.f90)
                   SIN(Intrinsic) (Line 1449, file rrtmg_sw_rad.f90)
                   LOG(Intrinsic) (Line 1863, file rrtmg_sw_rad.f90)
                   LOG(Intrinsic) (Line 1863, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
ASIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 708, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
CLDPRMC_SW in RRTMG_SW_CLDPRMC
      Defined as:  No definitions.

      Interface:   None

      Called By:   RRTMG_SW_RAD (Line 997, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
CLDPROP_SW in RRTMG_SW_CLDPROP
      Defined as:  No definitions.

      Interface:   None

      Called By:   RRTMG_SW_RAD (Line 977, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
COS(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 1448, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 1449, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
EARTH_SUN in RRTMG_SW_RAD
      Defined as:  Function (line 1427, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   EARTH_SUN in RRTMG_SW_RAD (Line 1700, file rrtmg_sw_rad.f90)

      Calls:       EARTH_SUN in RRTMG_SW_RAD (Line 1700, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
INATM_SW in RRTMG_SW_RAD
      Defined as:  Subroutine (line 1454, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   INATM_SW in RRTMG_SW_RAD (Line 899, file rrtmg_sw_rad.f90)

      Calls:       INATM_SW in RRTMG_SW_RAD (Line 899, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
LOG(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 1863, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 1863, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
MAX(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 973, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
MCICA_SUBCOL_GEN_SW
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
MCICA_SUBCOL_SW in MCICA_SUBCOL_GEN_SW
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 973, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
PARRRSW
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD
                   RRTMG_SW_RAD

Name  Messages
----  --------
RRSW_AER
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRSW_CON
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD
                   RRTMG_SW_RAD
                   RRTMG_SW_RAD

Name  Messages
----  --------
RRSW_VSN
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRSW_WVN
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD
                   RRTMG_SW_RAD

Name  Messages
----  --------
RRTMG_SW in RRTMG_SW_RAD
      Defined as:  Subroutine (line 83, file rrtmg_sw_rad.f90)

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
RRTMG_SW_CLDPRMC
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRTMG_SW_CLDPROP
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRTMG_SW_RAD
      Defined as:  Module (line 13, file rrtmg_sw_rad.f90)

      Calls:       CLDPRMC_SW in RRTMG_SW_CLDPRMC (Line 997, file rrtmg_sw_rad.f90)
                   CLDPROP_SW in RRTMG_SW_CLDPROP (Line 977, file rrtmg_sw_rad.f90)
                   SETCOEF_SW in RRTMG_SW_SETCOEF (Line 1020, file rrtmg_sw_rad.f90)
                   SPCVMC_SW in RRTMG_SW_SPCVMC (Line 1267, file rrtmg_sw_rad.f90)
                   SPCVRT_SW in RRTMG_SW_SPCVRT (Line 1200, file rrtmg_sw_rad.f90)

        Uses:      SHR_KIND_MOD
                   RRSW_VSN
                   MCICA_SUBCOL_GEN_SW
                   RRTMG_SW_CLDPROP
                   RRTMG_SW_CLDPRMC
                   RRTMG_SW_SETCOEF
                   RRTMG_SW_SPCVMC
                   RRTMG_SW_SPCVRT
                   PARRRSW
                   RRSW_AER
                   RRSW_CON
                   RRSW_WVN
                   RRSW_CON
                   PARRRSW
                   RRSW_CON
                   RRSW_WVN

Name  Messages
----  --------
RRTMG_SW_SETCOEF
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRTMG_SW_SPCVMC
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
RRTMG_SW_SPCVRT
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
SELECTED_REAL_KIND(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 1848, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 1884, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 1923, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 2003, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
SETCOEF_SW in RRTMG_SW_SETCOEF
      Defined as:  No definitions.

      Interface:   None

      Called By:   RRTMG_SW_RAD (Line 1020, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
SHR_KIND_MOD
      Defined as:  No definitions.

      Used By:     RRTMG_SW_RAD

Name  Messages
----  --------
SIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   AOD_N in RRTMG_SW_RAD (Line 1448, file rrtmg_sw_rad.f90)
                   AOD_N in RRTMG_SW_RAD (Line 1449, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
SPCVMC_SW in RRTMG_SW_SPCVMC
      Defined as:  No definitions.

      Interface:   None

      Called By:   RRTMG_SW_RAD (Line 1267, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
SPCVRT_SW in RRTMG_SW_SPCVRT
      Defined as:  No definitions.

      Interface:   None

      Called By:   RRTMG_SW_RAD (Line 1200, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
ZAERO in RRTMG_SW_RAD
      Defined as:  Subroutine (line 1870, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   ZAERO in RRTMG_SW_RAD (Line 756, file rrtmg_sw_rad.f90)
                   ZAERO in RRTMG_SW_RAD (Line 763, file rrtmg_sw_rad.f90)

      Calls:       ZAERO in RRTMG_SW_RAD (Line 756, file rrtmg_sw_rad.f90)
                   ZAERO in RRTMG_SW_RAD (Line 763, file rrtmg_sw_rad.f90)

Name  Messages
----  --------
ZPLEV in RRTMG_SW_RAD
      Defined as:  Subroutine (line 1833, file rrtmg_sw_rad.f90)

      Interface:   None

      Called By:   ZPLEV in RRTMG_SW_RAD (Line 754, file rrtmg_sw_rad.f90)

      Calls:       ZPLEV in RRTMG_SW_RAD (Line 754, file rrtmg_sw_rad.f90)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
